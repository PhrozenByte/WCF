<<<<<<< HEAD
function wcfEval(expression){return eval(expression)}!function(){var t=jQuery.fn.data;jQuery.fn.data=function(e){if(e)switch(typeof e){case"object":for(var i in e)if(i.match(/ID$/)){var n=e[i];delete e[i],i=i.replace(/ID$/,"-id"),e[i]=n}arguments[0]=e;break;case"string":e.match(/ID$/)&&(arguments[0]=e.replace(/ID$/,"-id"))}var a=t.apply(this,arguments);if(void 0===e)for(var i in a)i.match(/Id$/)&&(a[i.replace(/Id$/,"ID")]=a[i],delete a[i]);return a},window.console||(window.console={});for(var e=["log","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","profile","profileEnd","count","clear","time","timeEnd","timeStamp","table","error"],i=0;i<e.length;i++)"undefined"==typeof console[e[i]]&&(console[e[i]]=function(){});"undefined"==typeof console.debug&&(console.debug=function(t){console.log(t)})}(),function(){var t=!1,e=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(i){function n(){!t&&this.init&&this.init.apply(this,arguments)}var a=this.prototype;t=!0;var s=new this;t=!1;for(var o in i)s[o]="function"==typeof i[o]&&"function"==typeof a[o]&&e.test(i[o])?function(t,e){return function(){var i=this._super;this._super=a[t];var n=e.apply(this,arguments);return this._super=i,n}}(o,i[o]):i[o];return n.prototype=s,n.prototype.constructor=n,n.extend=arguments.callee,n}}(),String.prototype.hashCode=function(){var t,e=0;if(this.length)for(var i=0,n=this.length;n>i;i++)t=this.charCodeAt(i),e=(e<<5)-e+t,e&=e;return e},function(){var t=navigator.userAgent.toLowerCase(),e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],i={browser:e[1]||"",version:e[2]||"0"};browser={},i.browser&&(browser[i.browser]=!0,browser.version=i.version),browser.chrome?browser.webkit=!0:browser.webkit&&(browser.safari=!0),jQuery.browser=browser,jQuery.browser.touch=!!("ontouchstart"in window)||!!("msmaxtouchpoints"in window.navigator)}(),function(t){jQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera);var WCF={};$.extend(!0,{removeArrayValue:function(t,e){return $.grep(t,function(t){return e!==t})},wcfEscapeID:function(t){return t.replace(/(:|\.)/g,"\\$1")},wcfIsset:function(t){return!!$("#"+$.wcfEscapeID(t)).length},getLength:function(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&e++;return e}}),$.fn.extend({getTagName:function(){return this.length?this.get(0).tagName.toLowerCase():""},getDimensions:function(t){var e=css={},i=!1;switch(this.is(":hidden")&&(css=WCF.getInlineCSS(this),i=!0,this.css({display:"block",visibility:"hidden"})),t){case"inner":e={height:this.innerHeight(),width:this.innerWidth()};break;case"outer":e={height:this.outerHeight(),width:this.outerWidth()};break;default:e={height:this.height(),width:this.width()}}return i&&WCF.revertInlineCSS(this,css,["display","visibility"]),e},getOffsets:function(t){var e=css={},i=!1;switch(this.is(":hidden")&&(css=WCF.getInlineCSS(this),i=!0,this.css({display:"block",visibility:"hidden"})),t){case"offset":e=this.offset();break;case"position":default:e=this.position()}return i&&WCF.revertInlineCSS(this,css,["display","visibility"]),e},makePositioned:function(t,e){"absolute"!=t&&"fixed"!=t&&(t="absolute");var i=this.getOffsets("position");return this.css({position:t,left:i.left,margin:0,top:i.top}),e&&this.remove().appentTo("body"),this},disable:function(){return this.attr("disabled","disabled")},enable:function(){return this.removeAttr("disabled")},wcfIdentify:function(){return this.attr("id")||this.attr("id",WCF.getRandomID()),this.attr("id")},getCaret:function(){if(this.is("input")){if("text"!=this.attr("type")&&"password"!=this.attr("type"))return-1}else if(!this.is("textarea"))return-1;var t=0,e=this.get(0);if(document.selection){this.focus();var i=document.selection.createRange();i.moveStart("character",-this.val().length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=parseInt(e.selectionStart));return t},setCaret:function(t){if(this.is("input")){if("text"!=this.attr("type")&&"password"!=this.attr("type"))return!1}else if(!this.is("textarea"))return!1;var e=this.get(0);if(this.focus(),document.selection){var i=document.selection.createRange();i.moveStart("character",t),i.moveEnd("character",0),i.select()}else(e.selectionStart||"0"==e.selectionStart)&&(e.selectionStart=t,e.selectionEnd=t);return!0},wcfDropIn:function(t,e,i){return t||(t="up"),i&&parseInt(i)||(i=200),this.show(WCF.getEffect(this,"drop"),{direction:t},i,e)},wcfDropOut:function(t,e,i){return t||(t="down"),i&&parseInt(i)||(i=200),this.hide(WCF.getEffect(this,"drop"),{direction:t},i,e)},wcfBlindIn:function(t,e,i){return t||(t="vertical"),i&&parseInt(i)||(i=200),this.show(WCF.getEffect(this,"blind"),{direction:t},i,e)},wcfBlindOut:function(t,e,i){return t||(t="vertical"),i&&parseInt(i)||(i=200),this.hide(WCF.getEffect(this,"blind"),{direction:t},i,e)},wcfHighlight:function(t,e){return this.effect("highlight",t,600,e)},wcfFadeIn:function(t,e){return e&&parseInt(e)||(e=200),this.show(WCF.getEffect(this,"fade"),{},e,t)},wcfFadeOut:function(t,e){return e&&parseInt(e)||(e=200),this.hide(WCF.getEffect(this,"fade"),{},e,t)}}),$.extend(WCF,{activeDialogs:0,_idCounter:0,getRandomID:function(){var t="";do t="wcf"+this._idCounter++;while($.wcfIsset(t));return t},inArray:function(t,e){return-1!=$.inArray(t,e)},getEffect:function(t,e){return t.is("tr")?"highlight":e},getInlineCSS:function(t){var e={},i=t.attr("style");if(!i)return{};i=i.split(";");for(var n=0,a=i.length;a>n;n++){var s=$.trim(i[n]);""!=s&&(s=s.split(":"),e[$.trim(s[0])]=$.trim(s[1]))}return e},revertInlineCSS:function(t,e,i){for(var n=0,a=i.length;a>n;n++){var s=i[n];e[s]?t.css(s,e[s]):t.css(s,"")}}}),WCF.Browser={_isChrome:null,isChrome:function(){return null===this._isChrome&&(this._isChrome=!1,/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())&&(this._isChrome=!0)),this._isChrome}},WCF.Dropdown={_callbacks:{},_didInit:!1,_dropdowns:{},_menuContainer:null,_menus:{},init:function(){null===this._menuContainer&&(this._menuContainer=$('<div id="dropdownMenuContainer" />').appendTo(document.body));var t=this;$(".dropdownToggle:not(.jsDropdownEnabled)").each(function(e,i){t.initDropdown($(i),!1)}),this._didInit||(this._didInit=!0,WCF.CloseOverlayHandler.addCallback("WCF.Dropdown",$.proxy(this._closeAll,this)),WCF.DOMNodeInsertedHandler.addCallback("WCF.Dropdown",$.proxy(this.init,this))),$(document).on("scroll",$.proxy(this._scroll,this))},_dialogScroll:function(t){var e=$(t.currentTarget);e.find(".dropdown.dropdownOpen").each(function(t,i){var n=$(i),a=n.wcfIdentify(),s=n.offset(),o=e.offset(),r=$(i).height()/2;s.top+r<=o.top?WCF.Dropdown.toggleDropdown(a):s.top>=o.top+e.height()?WCF.Dropdown.toggleDropdown(a):s.left<=o.left?WCF.Dropdown.toggleDropdown(a):s.left>=o.left+e.width()?WCF.Dropdown.toggleDropdown(a):WCF.Dropdown.setAlignmentByID(n.wcfIdentify())})},_scroll:function(){for(var t in this._dropdowns){var e=this._dropdowns[t];e.data("isOverlayDropdownButton")&&e.hasClass("dropdownOpen")&&this.setAlignmentByID(t)}},initDropdown:function(t,e){if(!t.hasClass("jsDropdownEnabled")&&!t.data("target")){var i=t.parents(".dropdown");if(i.length){var n=t.next(".dropdownMenu");if(n.length){n.detach().appendTo(this._menuContainer);var a=i.wcfIdentify();this._dropdowns[a]||(t.addClass("jsDropdownEnabled").click($.proxy(this._toggle,this)),this._dropdowns[a]=i,this._menus[a]=n),t.data("target",a),e&&t.trigger("click")}}}},removeDropdown:function(t){this._menus[t]&&($(this._menus[t]).remove(),delete this._menus[t],delete this._dropdowns[t])},initDropdownFragment:function(t,e){var i=t.wcfIdentify();return this._dropdowns[i]?(console.debug("[WCF.Dropdown] Cannot register dropdown identified by '"+i+"' as a fragement."),void 0):(this._dropdowns[i]=t,this._menus[i]=e.detach().appendTo(this._menuContainer),void 0)},registerCallback:function(t,e){return $.isFunction(e)?(this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e),void 0):(console.debug("[WCF.Dropdown] Callback for '"+t+"' is invalid"),!1)},_toggle:function(t,e){var i=null===t?e:$(t.currentTarget).data("target"),n=this._dropdowns[i];if(n&&void 0===n.data("isOverlayDropdownButton")){var a=n.parents(".dialogContent");n.data("isOverlayDropdownButton",a.length>0),a.length&&a.on("scroll",this._dialogScroll)}for(var s in this._dropdowns){var o=this._dropdowns[s],r=this._menus[s];o.hasClass("dropdownOpen")?(o.removeClass("dropdownOpen"),r.removeClass("dropdownOpen"),this._notifyCallbacks(s,"close")):s===i&&(o.addClass("dropdownOpen"),r.addClass("dropdownOpen"),this._notifyCallbacks(s,"open"),this.setAlignment(o,r))}return null!==t?(t.stopPropagation(),!1):void 0},toggleDropdown:function(t){this._toggle(null,t)},getDropdown:function(t){return this._dropdowns[t]?this._dropdowns[t]:null},getDropdownMenu:function(t){return this._menus[t]?this._menus[t]:null},setAlignmentByID:function(t){var e=this.getDropdown(t);null===e&&console.debug("[WCF.Dropdown] Unable to find dropdown identified by '"+t+"'");var i=this.getDropdownMenu(t);null===i&&console.debug("[WCF.Dropdown] Unable to find dropdown menu identified by '"+t+"'"),this.setAlignment(e,i)},setAlignment:function(t,e){var i=t.getDimensions("outer"),n=t.getOffsets("offset"),a=e.getDimensions("outer"),s=$(window).width(),o=t.find(".dropdownToggle");o.hasClass("dropdownCaptionTextarea")&&(i=o.getDimensions("outer"));var r="left";n.left+a.width>s&&(r="right");var l="auto",c="auto";"left"===r?(e.removeClass("dropdownArrorRight"),l=n.left+"px"):(e.addClass("dropdownArrowRight"),c=s-(n.left+i.width)+"px"),e.css({left:l,right:c,top:n.top+i.height+7+"px"})},_closeAll:function(){for(var t in this._dropdowns){var e=this._dropdowns[t];e.hasClass("dropdownOpen")&&(e.removeClass("dropdownOpen"),this._menus[t].removeClass("dropdownOpen"),this._notifyCallbacks(t,"close"))}},close:function(t){this._dropdowns[t]&&(this._dropdowns[t].removeClass("dropdownMenu"),this._menus[t].removeClass("dropdownMenu"))},_notifyCallbacks:function(t,e){if(this._callbacks[t])for(var i=0,n=this._callbacks[t].length;n>i;i++)this._callbacks[t][i](t,e)}},WCF.Clipboard={_actionProxy:null,_actionObjects:{},_container:null,_containerData:{},_hasMarkedItems:!1,_markedObjectIDs:{},_page:"",_pageObjectID:0,_proxy:null,_trackedElements:{},init:function(t,e,i,n){this._page=t,this._actionObjects=i||{},this._hasMarkedItems=e>0,this._pageObjectID=parseInt(n)||0,this._actionProxy=new WCF.Action.Proxy({success:$.proxy(this._actionSuccess,this),url:"index.php/ClipboardProxy/?t="+SECURITY_TOKEN+SID_ARG_2ND}),this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this),url:"index.php/Clipboard/?t="+SECURITY_TOKEN+SID_ARG_2ND}),this._containers=$(".jsClipboardContainer").each($.proxy(function(t,e){this._initContainer(e)},this)),this._hasMarkedItems&&this._containers.length&&this._loadMarkedItems();var a=this;WCF.DOMNodeInsertedHandler.addCallback("WCF.Clipboard",function(){a._containers=$(".jsClipboardContainer").each($.proxy(function(t,e){a._initContainer(e)},a))})},_loadMarkedItems:function(){new WCF.Action.Proxy({autoSend:!0,data:{containerData:this._containerData,pageClassName:this._page,pageObjectID:this._pageObjectID},success:$.proxy(this._loadMarkedItemsSuccess,this),url:"index.php/ClipboardLoadMarkedItems/?t="+SECURITY_TOKEN+SID_ARG_2ND})},reload:function(){this._loadMarkedItems()},_loadMarkedItemsSuccess:function(t,e,i){this._resetMarkings();for(var n in t.markedItems){this._markedObjectIDs[n]||(this._markedObjectIDs[n]=[]);var a=t.markedItems[n];for(var s in a)this._markedObjectIDs[n].push(a[s]);this._containers.each($.proxy(function(t,e){var i=$(e);return i.data("type")!=n?!0:(i.find("input.jsClipboardItem").each($.proxy(function(t,e){var i=$(e);WCF.inArray(i.data("objectID"),this._markedObjectIDs[n])&&(i.prop("checked",!0),i.parents(".jsClipboardObject").addClass("jsMarked"))},this)),i.find("input.jsClipboardMarkAll").each(function(t,e){var n=!0;i.find("input.jsClipboardItem").each(function(t,e){var i=$(e);i.prop("checked")||(n=!1)}),n&&$(e).prop("checked",!0)}),void 0)},this))}this._success(t,e,i)},_resetMarkings:function(){this._containers.each($.proxy(function(t,e){var i=$(e);this._markedObjectIDs[i.data("type")]=[],i.find("input.jsClipboardItem, input.jsClipboardMarkAll").prop("checked",!1),i.find(".jsClipboardObject").removeClass("jsMarked")},this))},_initContainer:function(t){var e=$(t),i=e.wcfIdentify();this._trackedElements[i]||(e.find(".jsClipboardMarkAll").data("hasContainer",i).click($.proxy(this._markAll,this)),this._markedObjectIDs[e.data("type")]=[],this._containerData[e.data("type")]={},$.each(e.data(),$.proxy(function(t,i){t.match(/^type(.+)/)&&(this._containerData[e.data("type")][WCF.String.lcfirst(t.replace(/^type/,""))]=i)},this)),this._trackedElements[i]=[]),e.find("input.jsClipboardItem").each($.proxy(function(t,e){var n=$(e),a=n.wcfIdentify();WCF.inArray(a,this._trackedElements[i])||(this._trackedElements[i].push(a),n.data("hasContainer",i).click($.proxy(this._click,this)))},this))},_click:function(t){var e=$(t.target),i=e.data("objectID"),n=e.prop("checked")?!0:!1,a=[i];if(e.data("hasContainer"))var s=$("#"+e.data("hasContainer")),o=s.data("type");else var o=e.data("type");if(n?(this._markedObjectIDs[o].push(i),e.parents(".jsClipboardObject").addClass("jsMarked")):(this._markedObjectIDs[o]=$.removeArrayValue(this._markedObjectIDs[o],i),e.parents(".jsClipboardObject").removeClass("jsMarked")),e.data("hasContainer")){var r=!0;s.find("input.jsClipboardItem").each(function(t,e){var i=$(e);i.prop("checked")||(r=!1)}),s.find(".jsClipboardMarkAll").each(function(t,e){r?$(e).prop("checked",!0):$(e).prop("checked",!1)})}this._saveState(o,a,n)},_markAll:function(t){var e=$(t.target),i=[],n=!0;if(e.is("input")&&(n=e.prop("checked")),e.data("hasContainer"))var a=$("#"+e.data("hasContainer")),s=a.data("type");else var s=e.data("type");e.data("hasContainer")&&(a.find("input.jsClipboardItem").each($.proxy(function(t,e){var a=$(e),o=a.data("objectID");n?a.prop("checked")||(a.prop("checked",!0),this._markedObjectIDs[s].push(o),i.push(o)):a.prop("checked")&&(a.prop("checked",!1),this._markedObjectIDs[s]=$.removeArrayValue(this._markedObjectIDs[s],o),i.push(o))},this)),n?a.find(".jsClipboardObject").addClass("jsMarked"):a.find(".jsClipboardObject").removeClass("jsMarked")),this._saveState(s,i,n)},_saveState:function(t,e,i){this._proxy.setOption("data",{action:i?"mark":"unmark",containerData:this._containerData,objectIDs:e,pageClassName:this._page,pageObjectID:this._pageObjectID,type:t}),this._proxy.sendRequest()},_success:function(data,textStatus,jqXHR){var $containers={};if($(".jsClipboardEditor").each(function(index,container){for(var $container=$(container),$types=eval($container.data("types")),$i=0,$length=$types.length;$length>$i;$i++){var $typeName=$types[$i];$containers[$typeName]=$container}var $containerID=$container.wcfIdentify();WCF.CloseOverlayHandler.removeCallback($containerID),$container.empty()}),data.items)for(var $typeName in data.items)if($containers[$typeName]){var $container=$containers[$typeName],$list=$container.children("ul");0==$list.length&&($list=$("<ul />").appendTo($container));var $editor=data.items[$typeName],$label=$('<li class="dropdown"><span class="dropdownToggle button">'+$editor.label+"</span></li>").appendTo($list),$itemList=$('<ol class="dropdownMenu"></ol>').appendTo($label);for(var $itemIndex in $editor.items){var $item=$editor.items[$itemIndex],$listItem=$("<li><span>"+$item.label+"</span></li>").appendTo($itemList);$listItem.data("container",$container),$listItem.data("objectType",$typeName),$listItem.data("actionName",$item.actionName).data("parameters",$item.parameters),$listItem.data("internalData",$item.internalData).data("url",$item.url).data("type",$typeName),$listItem.click($.proxy(this._executeAction,this))}$('<li class="dropdownDivider" />').appendTo($itemList),$("<li><span>"+WCF.Language.get("wcf.clipboard.item.unmarkAll")+"</span></li>").appendTo($itemList).click($.proxy(function(){this._proxy.setOption("data",{action:"unmarkAll",type:$typeName}),this._proxy.setOption("success",$.proxy(function(t,e,i){for(var n in this._containers){var a=$(this._containers[n]);if(a.data("type")==$typeName){a.find(".jsClipboardMarkAll, .jsClipboardItem").prop("checked",!1),a.find(".jsClipboardObject").removeClass("jsMarked");break}}this._success(t,e,i),this._proxy.setOption("success",$.proxy(this._success,this))},this)),this._proxy.sendRequest()},this)),WCF.Dropdown.initDropdown($label.children(".dropdownToggle"),!1)}},_closeLists:function(){$(".jsClipboardEditor ul").removeClass("dropdownOpen")},_executeAction:function(t){var e=$(t.currentTarget),i=e.data("url");if(i&&(window.location.href=i),e.data("parameters").className&&e.data("parameters").actionName&&("unmarkAll"===e.data("parameters").actionName||e.data("parameters").objectIDs)){var n=e.data("internalData").confirmMessage;if(n){var a=e.data("internalData").template;a&&(a=$(a)),WCF.System.Confirmation.show(n,$.proxy(function(t){if("confirm"===t){var i={};a&&a.length&&$("#wcfSystemConfirmationContent").find("input, select, textarea").each(function(t,e){var n=$(e);i[n.prop("name")]=n.val()}),this._executeAJAXActions(e,i)}},this),"",a)}else this._executeAJAXActions(e,{})}e.data("container").trigger("clipboardAction",[e.data("type"),e.data("actionName"),e.data("parameters")])},_executeAJAXActions:function(t,e){e=e||{};var i=[];"unmarkAll"!==t.data("parameters").actionName&&$.each(t.data("parameters").objectIDs,function(t,e){i.push(parseInt(e))});var n={data:e,containerData:this._containerData[t.data("type")]},a=t.data("internalData").parameters;if(void 0!==a)for(var s in a)n[s]=a[s];new WCF.Action.Proxy({autoSend:!0,data:{actionName:t.data("parameters").actionName,className:t.data("parameters").className,objectIDs:i,parameters:n},success:$.proxy(function(e){"unmarkAll"!==t.data("parameters").actionName&&t.data("container").trigger("clipboardActionResponse",[e,t.data("type"),t.data("actionName"),t.data("parameters")]),this._loadMarkedItems()},this)}),this._actionObjects[t.data("objectType")]&&this._actionObjects[t.data("objectType")][t.data("parameters").actionName]&&this._actionObjects[t.data("objectType")][t.data("parameters").actionName].triggerEffect(i)},sendRequest:function(t){var e=$(t);this._actionProxy.setOption("data",{parameters:e.data("parameters"),typeName:e.data("type")}),this._actionProxy.sendRequest()}},WCF.PeriodicalExecuter=Class.extend({_callback:null,_intervalID:null,_isExecuting:!1,init:function(t,e){return $.isFunction(t)?(this._callback=t,this._intervalID=setInterval($.proxy(this._execute,this),e),void 0):(console.debug("[WCF.PeriodicalExecuter] Given callback is invalid, aborting."),void 0)},_execute:function(){if(!this._isExecuting)try{this._isExecuting=!0,this._callback(this),this._isExecuting=!1}catch(t){throw this._isExecuting=!1,t}},stop:function(){this._intervalID&&clearInterval(this._intervalID)}}),WCF.LoadingOverlayHandler={_activeRequests:0,_loadingOverlay:null,_pending:null,show:function(){if(null===this._loadingOverlay&&(this._loadingOverlay=$('<div class="spinner"><span class="icon icon48 icon-spinner" /> <span>'+WCF.Language.get("wcf.global.loading")+"</span></div>").hide().appendTo($("body"))),this._activeRequests++,1==this._activeRequests&&null===this._pending){var t=this;this._pending=new WCF.PeriodicalExecuter(function(e){t._activeRequests&&t._loadingOverlay.stop(!0,!0).fadeIn(100),e.stop(),t._pending=null},250)}},hide:function(){this._activeRequests--,0==this._activeRequests&&(null!==this._pending&&(this._pending.stop(),this._pending=null),this._loadingOverlay.stop(!0,!0).fadeOut(100))},updateIcon:function(t,e){var i=void 0===e||e?"addClass":"removeClass";t.find(".icon")[i]("icon-spinner"),t.hasClass("icon")&&t[i]("icon-spinner")}},WCF.Action={},WCF.Action.Proxy=Class.extend({_showLoadingOverlayOnce:!1,_suppressErrors:!1,_lastRequest:null,init:function(t){this.options=$.extend(!0,{autoSend:!1,data:{},dataType:"json",after:null,init:null,jsonp:"callback",async:!0,failure:null,showLoadingOverlay:!0,success:null,suppressErrors:!1,type:"POST",url:"index.php/AJAXProxy/?t="+SECURITY_TOKEN+SID_ARG_2ND,aborted:null,autoAbortPrevious:!1},t),this.confirmationDialog=null,this.loading=null,this._showLoadingOverlayOnce=!1,this._suppressErrors=this.options.suppressErrors===!0,this.options.autoSend&&this.sendRequest();var e=this;$(window).on("beforeunload",function(){e._suppressErrors=!0})},sendRequest:function(t){return this._init(),(t||this.options.autoAbortPrevious)&&this.abortPrevious(),this._lastRequest=$.ajax({data:this.options.data,dataType:this.options.dataType,jsonp:this.options.jsonp,async:this.options.async,type:this.options.type,url:this.options.url,success:$.proxy(this._success,this),error:$.proxy(this._failure,this)}),this._lastRequest},abortPrevious:function(){null!==this._lastRequest&&(this._lastRequest.abort(),this._lastRequest=null)},showLoadingOverlayOnce:function(){this._showLoadingOverlayOnce=!0},suppressErrors:function(){this._suppressErrors=!0},_init:function(){$.isFunction(this.options.init)&&this.options.init(this),(this.options.showLoadingOverlay||this._showLoadingOverlayOnce)&&WCF.LoadingOverlayHandler.show()},_failure:function(t,e,i){if("abort"==e)return $.isFunction(this.options.aborted)&&this.options.aborted(t),void 0;try{var n=$.parseJSON(t.responseText),a=!0;if($.isFunction(this.options.failure)&&(a=this.options.failure(n,t,e,i)),!this._suppressErrors&&a!==!1){var s="";n.stacktrace?s="<br /><p>Stacktrace:</p><p>"+n.stacktrace+"</p>":n.exceptionID&&(s="<br /><p>Exception ID: <code>"+n.exceptionID+"</code></p>"),$('<div class="ajaxDebugMessage"><p>'+n.message+"</p>"+s+"</div>").wcfDialog({title:WCF.Language.get("wcf.global.error.title")})}}catch(o){var a=!0;if($.isFunction(this.options.failure)&&(a=this.options.failure(null,t,e,i)),!this._suppressErrors&&a!==!1){var r="timeout"===e?WCF.Language.get("wcf.global.error.timeout"):t.responseText;r&&"undefined"!=r&&$('<div class="ajaxDebugMessage"><p>'+r+"</p></div>").wcfDialog({title:WCF.Language.get("wcf.global.error.title")})}}this._after()},_success:function(t,e,i){$.isFunction(this.options.success)&&(t&&t.returnValues&&void 0!==t.returnValues.template&&(t.returnValues.template=$.trim(t.returnValues.template)),this.options.success(t,e,i)),this._after()},_after:function(){this._lastRequest=null,$.isFunction(this.options.after)&&this.options.after(),(this.options.showLoadingOverlay||this._showLoadingOverlayOnce)&&(WCF.LoadingOverlayHandler.hide(),this._showLoadingOverlayOnce&&(this._showLoadingOverlayOnce=!1)),WCF.DOMNodeInsertedHandler.execute(),$("a[href*=#]").each(function(t,e){var i=$(e);if(-1!=i.prop("href").indexOf("AJAXProxy")){var n=i.prop("href").substr(i.prop("href").indexOf("#")),a=document.location.toString().replace(/#.*/,"");i.prop("href",a+n)}})},setOption:function(t,e){this.options[t]=e}}),WCF.Action.SimpleProxy=Class.extend({init:function(t,e){this.options=$.extend(!0,{action:"",className:"",elements:null,eventName:"click"},t),this.callbacks=$.extend(!0,{after:null,failure:null,init:null,success:null},e),this.options.elements&&(this.proxy=new WCF.Action.Proxy(this.callbacks),this.options.elements.each($.proxy(function(t,e){$(e).bind(this.options.eventName,$.proxy(this._handleEvent,this))},this)))},_handleEvent:function(t){this.proxy.setOption("data",{actionName:this.options.action,className:this.options.className,objectIDs:[$(t.target).data("objectID")]}),this.proxy.sendRequest()}}),WCF.Action.Delete=Class.extend({_buttonSelector:"",_className:"",_containerSelector:"",_containers:[],init:function(t,e,i){this._containerSelector=e,this._className=t,this._buttonSelector=i?i:".jsDeleteButton",this.proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)}),this._initElements(),WCF.DOMNodeInsertedHandler.addCallback("WCF.Action.Delete"+this._className.hashCode(),$.proxy(this._initElements,this))},_initElements:function(){var t=this;$(this._containerSelector).each(function(e,i){var n=$(i),a=n.wcfIdentify();WCF.inArray(a,t._containers)||(t._containers.push(a),n.find(t._buttonSelector).click($.proxy(t._click,t)))})},_click:function(t){var e=$(t.currentTarget);t.preventDefault(),e.data("confirmMessage")?WCF.System.Confirmation.show(e.data("confirmMessage"),$.proxy(this._execute,this),{target:e}):(WCF.LoadingOverlayHandler.updateIcon(e),this._sendRequest(e))},_execute:function(t,e){"cancel"!==t&&(WCF.LoadingOverlayHandler.updateIcon(e.target),this._sendRequest(e.target))},_sendRequest:function(t){this.proxy.setOption("data",{actionName:"delete",className:this._className,interfaceName:"wcf\\data\\IDeleteAction",objectIDs:[$(t).data("objectID")]}),this.proxy.sendRequest()},_success:function(t){this.triggerEffect(t.objectIDs)},triggerEffect:function(t){for(var e in this._containers){var i=$("#"+this._containers[e]);WCF.inArray(i.find(".jsDeleteButton").data("objectID"),t)&&i.wcfBlindOut("up",function(){$(this).remove()})}}}),WCF.Action.NestedDelete=WCF.Action.Delete.extend({triggerEffect:function(t){for(var e in this._containers){var i=$("#"+this._containers[e]);WCF.inArray(i.find(this._buttonSelector).data("objectID"),t)&&(i.has("ol").has("li")?i.is(":only-child")?i.parent().replaceWith(i.find("> ol")):i.replaceWith(i.find("> ol > li")):i.wcfBlindOut("up",function(){$(this).remove()}))}}}),WCF.Action.Toggle=Class.extend({_buttonSelector:".jsToggleButton",_className:"",_containerSelector:"",_containers:[],init:function(t,e,i){this._containerSelector=e,this._className=t,this._buttonSelector=i?i:".jsToggleButton";var n={success:$.proxy(this._success,this)};this.proxy=new WCF.Action.Proxy(n),this._initElements(),WCF.DOMNodeInsertedHandler.addCallback("WCF.Action.Toggle"+this._className.hashCode(),$.proxy(this._initElements,this))},_initElements:function(){$(this._containerSelector).each($.proxy(function(t,e){var i=$(e),n=i.wcfIdentify();WCF.inArray(n,this._containers)||(this._containers.push(n),i.find(this._buttonSelector).click($.proxy(this._click,this)))},this))},_click:function(t){var e=$(t.currentTarget);t.preventDefault(),e.data("confirmMessage")?WCF.System.Confirmation.show(e.data("confirmMessage"),$.proxy(this._execute,this),{target:e}):(WCF.LoadingOverlayHandler.updateIcon(e),this._sendRequest(e))},_execute:function(t,e){"cancel"!==t&&(WCF.LoadingOverlayHandler.updateIcon(e.target),this._sendRequest(e.target))},_sendRequest:function(t){this.proxy.setOption("data",{actionName:"toggle",className:this._className,interfaceName:"wcf\\data\\IToggleAction",objectIDs:[$(t).data("objectID")]}),this.proxy.sendRequest()},_success:function(t){this.triggerEffect(t.objectIDs)},triggerEffect:function(t){for(var e in this._containers){var i=$("#"+this._containers[e]),n=i.find(this._buttonSelector);WCF.inArray(n.data("objectID"),t)&&(i.wcfHighlight(),this._toggleButton(i,n))}},_toggleButton:function(t,e){WCF.LoadingOverlayHandler.updateIcon(e,!1),e.hasClass("icon-check-empty")?(e.removeClass("icon-check-empty").addClass("icon-check"),$newTitle=e.data("disableTitle")?e.data("disableTitle"):WCF.Language.get("wcf.global.button.disable"),e.attr("title",$newTitle)):(e.removeClass("icon-check").addClass("icon-check-empty"),$newTitle=e.data("enableTitle")?e.data("enableTitle"):WCF.Language.get("wcf.global.button.enable"),e.attr("title",$newTitle)),t.toggleClass("disabled")}}),WCF.Action.Scroll=Class.extend({_callback:null,_reference:null,_target:null,_threshold:0,init:function(t,e,i,n){return this._threshold=parseInt(t),0===this._threshold?(console.debug("[WCF.Action.Scroll] Given threshold is invalid, aborting."),void 0):($.isFunction(e)&&(this._callback=e),null===this._callback?(console.debug("[WCF.Action.Scroll] Given callback is invalid, aborting."),void 0):(this._reference=$(i?i:window),this._target=$(n?n:document),this.start(),this._scroll(),void 0))},_scroll:function(){var t=this._target.height(),e=this._reference.scrollTop(),i=this._reference.height();t-(i+e)<this._threshold&&this._callback(this)},start:function(){this._reference.on("scroll",$.proxy(this._scroll,this))},stop:function(){this._reference.off("scroll")}}),WCF.Date={},WCF.Date.Picker={_dateFormat:"yy-mm-dd",_timeFormat:"g:ia",init:function(){var t=$.timepicker.log;$.timepicker.log=function(e){-1==e.indexOf("Error parsing the date/time string: Unexpected literal at position")&&t(e)},this._convertDateFormat(),this._initDatePicker(),WCF.DOMNodeInsertedHandler.addCallback("WCF.Date.Picker",$.proxy(this._initDatePicker,this))},_convertDateFormat:function(){var t={a:" tt",A:" TT",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"l",d:"dd",D:"D",j:"d",l:"DD",z:"o",S:"",F:"MM",m:"mm",M:"M",n:"m",o:"yy",Y:"yy",y:"y",U:"@"};this._dateFormat=WCF.Language.get("wcf.date.dateFormat").replace(/([^dDjlzSFmMnoYyU\\]*(?:\\.[^dDjlzSFmMnoYyU\\]*)*)([dDjlzSFmMnoYyU])/g,function(e,i,n){for(var a in t)n==a&&(n=t[a]);return i+n}),this._timeFormat=WCF.Language.get("wcf.date.timeFormat").replace(/([^aAgGhHisu\\]*(?:\\.[^aAgGhHisu\\]*)*)([aAgGhHisu])/g,function(e,i,n){for(var a in t)n==a&&(n=t[a]);return i+n})},_initDatePicker:function(){$("input[type=date]:not(.jsDatePicker), input[type=datetime]:not(.jsDatePicker), input[type=time]:not(.jsDatePicker)").each($.proxy(function(t,e){var i=$(e),n=i.prop("name"),a=i.val(),s="datetime"==i.attr("type")||"time"==i.attr("type"),o=""!=i.prop("min")?new Date(i.prop("min")):null,r=""!=i.prop("max")?new Date(i.prop("max")):null,l={altField:"#"+i.wcfIdentify()+"DatePicker",altFormat:"yy-mm-dd",beforeShow:function(t,e){setTimeout(function(){e.dpDiv.position({my:"left top",at:"left bottom",collision:"none",of:t})},1)},changeMonth:!0,changeYear:!0,dateFormat:this._dateFormat,dayNames:WCF.Language.get("__days"),dayNamesMin:WCF.Language.get("__daysShort"),dayNamesShort:WCF.Language.get("__daysShort"),firstDay:1,isRTL:"rtl"==WCF.Language.get("wcf.global.pageDirection"),maxDate:r,minDate:o,monthNames:WCF.Language.get("__months"),monthNamesShort:WCF.Language.get("__monthsShort"),showOtherMonths:!0,yearRange:i.hasClass("birthday")?"-100:+0":"1900:2038",onClose:function(t,e){""==t&&$(e.settings.altField).val("")
}};a.replace(/\b([0-9]{2}:[0-9]{2}):[0-9]{2}\b/,function(t,e){return s?e:""}),i.val(a),i.data("placeholder")&&i.attr("placeholder",i.data("placeholder")),i.removeAttr("name"),i.before('<input type="hidden" id="'+i.wcfIdentify()+'DatePicker" name="'+n+'" value="'+a+'" />'),s?i.datetimepicker($.extend({},l,{altFieldTimeOnly:!1,altTimeFormat:"HH:mm",controlType:"select",hourText:WCF.Language.get("wcf.date.hour"),minuteText:WCF.Language.get("wcf.date.minute"),showButtonPanel:!1,showTime:!1,timeFormat:this._timeFormat,timeOnly:"time"==i.attr("type"),timeOnlyTitle:""})):i.datepicker(l),a&&i.datepicker("setDate",new Date(a)),i.prop("type","text").addClass("jsDatePicker").removeClass("hasDatepicker"),i.datepicker("widget").hide()},this))}},WCF.Date.Util={gmdate:function(t){var e=t?t:new Date;return Math.round(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDay(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())/1e3)},getTimezoneDate:function(t,e){var i=new Date(t),n=6e4*i.getTimezoneOffset();return new Date(t+n+e)}},WCF.Date.Time=Class.extend({_date:0,_elements:null,_offset:null,_timestamp:0,init:function(){this._elements=$("time.datetime"),this._offset=null,this._timestamp=0,this._refresh(),new WCF.PeriodicalExecuter($.proxy(this._refresh,this),6e4),WCF.DOMNodeInsertedHandler.addCallback("WCF.Date.Time",$.proxy(this._domNodeInserted,this))},_domNodeInserted:function(){this._elements=$("time.datetime"),this._refresh()},_refresh:function(){this._date=new Date,this._timestamp=(this._date.getTime()-this._date.getMilliseconds())/1e3,null===this._offset&&(this._offset=this._timestamp-TIME_NOW),this._elements.each($.proxy(this._refreshElement,this))},_refreshElement:function(t,e){var i=$(e);i.attr("title")||i.attr("title",i.text());var n=i.data("timestamp")+this._offset,a=i.data("date"),s=i.data("time"),o=i.data("offset");if(!i.data("isFutureDate"))if(n>=this._timestamp||this._timestamp<n+60)i.text(WCF.Language.get("wcf.date.relative.now"));else if(this._timestamp<n+3540){var r=Math.max(Math.round((this._timestamp-n)/60),1);i.text(WCF.Language.get("wcf.date.relative.minutes",{minutes:r}))}else if(this._timestamp<n+86400){var l=Math.round((this._timestamp-n)/3600);i.text(WCF.Language.get("wcf.date.relative.hours",{hours:l}))}else if(this._timestamp<n+518400){var c=new Date(this._date.getFullYear(),this._date.getMonth(),this._date.getDate()),h=Math.ceil((c/1e3-n)/86400),d=WCF.Date.Util.getTimezoneDate(1e3*n,1e3*o),p=d.getDay(),u=WCF.Language.get("__days")[p];i.text(WCF.Language.get("wcf.date.relative.pastDays",{days:h,day:u,time:s}))}else{var _=WCF.Language.get("wcf.date.shortDateTimeFormat");i.text(_.replace(/\%date\%/,a).replace(/\%time\%/,s))}}}),WCF.Dictionary=Class.extend({_variables:{},init:function(){this._variables={}},add:function(t,e){this._variables[t]=e},addObject:function(t){for(var e in t)this.add(e,t[e])},addDictionary:function(t){t.each($.proxy(function(t){this.add(t.key,t.value)},this))},get:function(t){return this.isset(t)?this._variables[t]:null},isset:function(t){return this._variables.hasOwnProperty(t)},remove:function(t){delete this._variables[t]},each:function(t){if($.isFunction(t))for(var e in this._variables){var i=this._variables[e],n={key:e,value:i};t(n)}},count:function(){return $.getLength(this._variables)},isEmpty:function(){return!this.count()}}),WCF.Language={_variables:new WCF.Dictionary,add:function(t,e){this._variables.add(t,e)},addObject:function(t){this._variables.addObject(t)},get:function(t,e){if(null==e)var e={};var i=this._variables.get(t);return null===i?t:"string"==typeof i?(this.add(t,new WCF.Template(i)),this.get(t,e)):("function"==typeof i.fetch&&(i=i.fetch(e)),i)}},WCF.MultipleLanguageInput=Class.extend({_availableLanguages:{},_button:null,_didInit:!1,_element:null,_insertedDataAfterInit:!1,_isEnabled:!1,_forceSelection:!1,_languageID:0,_list:null,_values:null,init:function(t,e,i,n){if(this._button=null,this._element=$("#"+$.wcfEscapeID(t)),this._forceSelection=e,this._values=i,this._availableLanguages=n,$.getLength(this._values))for(var a in this._values)this._values[a]=WCF.String.unescapeHTML(this._values[a]);if(this._languageID=LANGUAGE_ID,0==this._element.length)return console.debug("[WCF.MultipleLanguageInput] element id '"+t+"' is unknown"),void 0;var s=$.getLength(this._values)>0?!0:!1;this._insertedDataAfterInit=s,this._prepareElement(s),this._element.parents("form").submit($.proxy(this._submit,this)),this._didInit=!0},_prepareElement:function(t){this._element.wrap('<div class="dropdown preInput" />');var e=this._element.parent();this._button=$('<p class="button dropdownToggle"><span>'+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></p>").prependTo(e),this._list=$('<ul class="dropdownMenu"></ul>').insertAfter(this._button),this._button.nextAll("textarea").length?this._button.addClass("dropdownCaptionTextarea"):this._button.addClass("dropdownCaption");for(var i in this._availableLanguages)$("<li><span>"+this._availableLanguages[i]+"</span></li>").data("languageID",i).click($.proxy(this._changeLanguage,this)).appendTo(this._list);this._forceSelection||($('<li class="dropdownDivider" />').appendTo(this._list),$("<li><span>"+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></li>").click($.proxy(this._disable,this)).appendTo(this._list)),WCF.Dropdown.initDropdown(this._button,t),(t||this._forceSelection)&&(this._isEnabled=!0,this._list.children("li").each($.proxy(function(t,e){var i=$(e);i.data("languageID")==this._languageID&&i.trigger("click")},this))),WCF.Dropdown.registerCallback(e.wcfIdentify(),$.proxy(this._handleAction,this))},_handleAction:function(t,e){"open"===e?this._enable():this._closeSelection()},_enable:function(){if(!this._isEnabled){var t=this._button.is("p")?this._button.children("span:eq(0)"):this._button;t.addClass("active"),this._isEnabled=!0}this._list.is(":visible")&&this._showSelection()},_showSelection:function(){this._isEnabled&&this._list.children("li").each($.proxy(function(t,e){var i=$(e),n=i.data("languageID");n&&(this._values[n]&&""!=this._values[n]?i.removeClass("missingValue"):i.addClass("missingValue"))},this))},_closeSelection:function(){this._disable()},_changeLanguage:function(t){var e=$(t.currentTarget);this._insertedDataAfterInit=!0,this._didInit&&(this._values[this._languageID]=this._element.val()),this._languageID=e.data("languageID"),this._values[this._languageID]?this._element.val(this._values[this._languageID]):this._element.val(""),this._list.children("li").removeClass("active"),e.addClass("active"),this._button.children("span").addClass("active").text(this._availableLanguages[this._languageID]),this._didInit&&this._element.blur().focus()},_disable:function(t){void 0===t&&this._insertedDataAfterInit&&(t=null),!this._forceSelection&&this._list&&null!==t&&(this._button.children("span").removeClass("active").text(WCF.Language.get("wcf.global.button.disabledI18n")),this._values[LANGUAGE_ID]?this._element.val(this._values[LANGUAGE_ID]):this._element.val(),this._element.blur(),this._insertedDataAfterInit=!1,this._isEnabled=!1,this._values={})},_submit:function(){if(!this._isEnabled)return 3735928559;this._languageID&&(this._values[this._languageID]=this._element.val());var t=$(this._element.parents("form")[0]),e=this._element.attr("name");for(var i in this._availableLanguages)void 0===this._values[i]&&(this._values[i]=""),$('<input type="hidden" name="'+e+"_i18n["+i+']" value="'+WCF.String.escapeHTML(this._values[i])+'" />').appendTo(t);this._element.removeAttr("name")}}),WCF.Number={round:function(t,e){return e=Math.pow(10,e||0),Math.round(t*e)/e}},WCF.String={addThousandsSeparator:function(t){return String(t).replace(/(^-?\d{1,3}|\d{3})(?=(?:\d{3})+(?:$|\.))/g,"$1"+WCF.Language.get("wcf.global.thousandsSeparator"))},escapeHTML:function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},escapeRegExp:function(t){return String(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},formatNumeric:function(t,e){return t=String(WCF.Number.round(t,e||2)),t=t.replace(".",WCF.Language.get("wcf.global.decimalPoint")),t=this.addThousandsSeparator(t),t=t.replace("-","âˆ’")},lcfirst:function(t){return String(t).substring(0,1).toLowerCase()+t.substring(1)},ucfirst:function(t){return String(t).substring(0,1).toUpperCase()+t.substring(1)},unescapeHTML:function(t){return String(t).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}},WCF.TabMenu={_containers:{},_didInit:!1,init:function(){var t=$(".tabMenuContainer"),e=this;t.each(function(t,i){var n=$(i),a=n.wcfIdentify();return e._containers[a]?!0:(n.data("store")&&!$("#"+n.data("store")).length&&$('<input type="hidden" name="'+n.data("store")+'" value="" id="'+n.data("store")+'" />').appendTo(n.parents("form").find(".formSubmit")),e._containers[a]=n,n.wcfTabs({active:!1,activate:function(t,e){for(var i=$(e.newPanel),n=i.closest(".tabMenuContainer"),a=n;;){if(void 0===a.data("isParent"))break;if(a.data("isParent")){a.data("store")&&$("#"+a.data("store")).val(i.attr("id"));break}a=a.data("parent")}WCF.TabMenu._didInit&&(window.history?window.history.pushState(null,document.title,window.location.toString().replace(/#.+$/,"")+"#"+i.attr("id")):location.hash="#"+i.attr("id"))}}),n.data("isParent",n.children(".tabMenuContainer, .tabMenuContent").length>0).data("parent",!1),n.data("isParent")||n.parent().hasClass("tabMenuContainer")&&n.data("parent",n.parent()),void 0)}),this._didInit||(this._selectActiveTab(),$(window).bind("hashchange",$.proxy(this.selectTabs,this)),this._selectErroneousTab()||this.selectTabs()),this._didInit=!0},reload:function(){this._containers={},this.init()},_selectErroneousTab:function(){for(var t in this._containers){var e=this._containers[t];if(!e.data("isParent")&&e.find(".formError").length){for(;;){if(e.data("parent")===!1)break;e=e.data("parent").wcfTabs("selectTab",e.wcfIdentify())}return!0}}return!1},_selectActiveTab:function(){for(var t in this._containers){var e=this._containers[t];if(e.data("active")){var i=e.data("active"),n=null;if(/-/.test(i)){var a=i.split("-");i=a[0],n=a[1]}e.find(".tabMenuContent").each(function(t,a){var s=$(a);return s.wcfIdentify()==i?(e.wcfTabs("select",t),null!==n&&(s.hasClass("tabMenuContainer")?s.wcfTabs("selectTab",e.data("active")):e.wcfTabs("selectTab",e.data("active"))),!1):void 0})}}},selectTabs:function(){if(location.hash){var t=location.hash.substr(1),e=$("#"+$.wcfEscapeID(t));if(1===e.length&&e.hasClass("ui-tabs-panel")&&(e=e.parent(".ui-tabs"),e.length))return e.wcfTabs("selectTab",t),e.hasClass("ui-tabs-panel")&&(t=e.wcfIdentify(),e=e.parent(".ui-tabs"),e.length&&e.wcfTabs("selectTab",t)),!0}return!1}},WCF.Template=Class.extend({init:function(t){var e=new WCF.Dictionary,i=0;t=t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/(\r\n|\n|\r)/g,"\\n"),t=t.replace(/\{literal\}(.*?)\{\/literal\}/g,$.proxy(function(t){var i="@@@@@@@@@@@"+Math.random()+"@@@@@@@@@@@";return e.add(i,t.replace(/\{\/?literal\}/g,"")),i},this)),t=t.replace(/\{\*.*?\*\}/g,"");var n=function(t){for(var e=t.split(""),i={},n=!0,a="",s="",o=!1,r=!1,l=!1,c=0,h=e.length;h>c;c++){var d=e[c];n&&"="!=d&&" "!=d?a+=d:n&&"="==d?(n=!1,r=!1,o=!1,l=!1):n||r||o||" "!=d?n||!r||l||"'"!=d?n||r||o||"'"!=d?n||!o||l||'"'!=d?n||r||o||'"'!=d?n||!o&&!r||l||"\\"!=d?n||(l=!1,s+=d):(l=!0,s+=d):(o=!0,s+=d):(o=!1,s+=d):(r=!0,s+=d):(r=!1,s+=d):(n=!0,i[a]=s,s=a="")}if(i[a]=s,o||r||l)throw new Error('Syntax error in parameterList: "'+t+'"');return i},a=function(t){return t.replace(/\\n/g,"\n").replace(/\\\\/g,"\\").replace(/\\'/g,"'")};t=t.replace(/\{(\$[^\}]+?)\}/g,function(t,e){return e=a(e.replace(/\$([^.\[\s]+)/g,"(v['$1'])")),"' + WCF.String.escapeHTML("+e+") + '"}).replace(/\{#(\$[^\}]+?)\}/g,function(t,e){return e=a(e.replace(/\$([^.\[\s]+)/g,"(v['$1'])")),"' + WCF.String.formatNumeric("+e+") + '"}).replace(/\{@(\$[^\}]+?)\}/g,function(t,e){return e=a(e.replace(/\$([^.\[\s]+)/g,"(v['$1'])")),"' + "+e+" + '"}).replace(/\{if (.+?)\}/g,function(t,e){return e=a(e.replace(/\$([^.\[\s]+)/g,"(v['$1'])")),"';\nif ("+e+") {\n"+"	$output += '"}).replace(/\{else ?if (.+?)\}/g,function(t,e){return e=a(e.replace(/\$([^.\[\s]+)/g,"(v['$1'])")),"';\n}\nelse if ("+e+") {\n"+"	$output += '"}).replace(/\{implode (.+?)\}/g,function(t,e){i++,e=e.replace(/\\\\/g,"\\").replace(/\\'/g,"'");var a=n(e);if("undefined"==typeof a.from)throw new Error("Missing from attribute in implode-tag");if("undefined"==typeof a.item)throw new Error("Missing item attribute in implode-tag");return"undefined"==typeof a.glue&&(a.glue="', '"),a.from=a.from.replace(/\$([^.\[\s]+)/g,"(v.$1)"),"';\nvar $implode_"+i+" = false;\n"+"for ($implodeKey_"+i+" in "+a.from+") {\n"+"	v["+a.item+"] = "+a.from+"[$implodeKey_"+i+"];\n"+("undefined"!=typeof a.key?"		v["+a.key+"] = $implodeKey_"+i+";\n":"")+"	if ($implode_"+i+") $output += "+a.glue+";\n"+"	$implode_"+i+" = true;\n"+"	$output += '"}).replace(/\{foreach (.+?)\}/g,function(t,e){i++,e=e.replace(/\\\\/g,"\\").replace(/\\'/g,"'");var a=n(e);if("undefined"==typeof a.from)throw new Error("Missing from attribute in foreach-tag");if("undefined"==typeof a.item)throw new Error("Missing item attribute in foreach-tag");return a.from=a.from.replace(/\$([^.\[\s]+)/g,"(v.$1)"),"';\n$foreach_"+i+" = false;\n"+"for ($foreachKey_"+i+" in "+a.from+") {\n"+"	$foreach_"+i+" = true;\n"+"	break;\n"+"}\n"+"if ($foreach_"+i+") {\n"+"	for ($foreachKey_"+i+" in "+a.from+") {\n"+"		v["+a.item+"] = "+a.from+"[$foreachKey_"+i+"];\n"+("undefined"!=typeof a.key?"		v["+a.key+"] = $foreachKey_"+i+";\n":"")+"		$output += '"}).replace(/\{foreachelse\}/g,"';\n	}\n}\nelse {\n	{\n		$output += '").replace(/\{\/foreach\}/g,"';\n	}\n}\n$output += '").replace(/\{else\}/g,"';\n}\nelse {\n	$output += '").replace(/\{\/(if|implode)\}/g,"';\n}\n$output += '");for(var s in WCF.Template.callbacks)t=WCF.Template.callbacks[s](t);t=t.replace("{ldelim}","{").replace("{rdelim}","}"),e.each(function(e){t=t.replace(e.key,e.value)}),t="$output += '"+t+"';";try{this.fetch=new Function("v","if (typeof v != 'object') { v = {}; } v.__window = window; v.__wcf = window.WCF; var $output = ''; "+t+" return $output;")}catch(o){throw console.debug("var $output = ''; "+t+" return $output;"),o}},fetch:function(){}}),WCF.Template.callbacks=[],WCF.ToggleOptions=Class.extend({_element:null,_showItems:[],_hideItems:[],_callback:null,init:function(t,e,i,n){this._element=$("#"+t),this._showItems=e,this._hideItems=i,void 0!==n&&(this._callback=n),this._element.click($.proxy(this._toggle,this)),this._toggle()},_toggle:function(){if(this._element.prop("checked")){for(var t=0,e=this._showItems.length;e>t;t++){var i=this._showItems[t];$("#"+i).show()}for(var t=0,e=this._hideItems.length;e>t;t++){var i=this._hideItems[t];$("#"+i).hide()}null!==this._callback&&this._callback()}}}),WCF.Collapsible={},WCF.Collapsible.Simple={init:function(){$(".jsCollapsible").each($.proxy(function(t,e){this._initButton(e)},this))},_initButton:function(t){var e=$(t),i=e.data("isOpen");i||$("#"+e.data("collapsibleContainer")).hide(),e.click($.proxy(this._toggle,this))},_toggle:function(t){var e=$(t.currentTarget),i=e.data("isOpen"),n=$("#"+$.wcfEscapeID(e.data("collapsibleContainer")));return i?(n.stop().wcfBlindOut("vertical",$.proxy(function(){this._toggleImage(e)},this)),i=!1):(n.stop().wcfBlindIn("vertical",$.proxy(function(){this._toggleImage(e)},this)),i=!0),e.data("isOpen",i),t.stopPropagation(),!1},_toggleImage:function(t){var e=t.find("span.icon");t.data("isOpen")?e.removeClass("icon-chevron-right").addClass("icon-chevron-down"):e.removeClass("icon-chevron-down").addClass("icon-chevron-right")}},WCF.Collapsible.Remote=Class.extend({_className:"",_containers:{},_containerData:{},_proxy:null,init:function(t){this._className=t,this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)}),this._init(),WCF.DOMNodeInsertedHandler.addCallback("WCF.Collapsible.Remote",$.proxy(this._init,this))},_init:function(){this._getContainers().each($.proxy(function(t,e){var i=$(e),n=i.wcfIdentify();void 0===this._containers[n]&&(this._containers[n]=i,this._initContainer(n))},this))},_initContainer:function(t){var e=this._getTarget(t),i=this._getButtonContainer(t),n=this._createButton(t,i);this._containerData[t]={button:n,buttonContainer:i,isOpen:this._containers[t].data("isOpen"),target:e},this._containers[t].data("isOpen")||$("#"+t).addClass("jsCollapsed")},_getContainers:function(){},_getTarget:function(){},_getButtonContainer:function(){},_createButton:function(t,e){var i=this._containers[t].data("isOpen"),n=$('<span class="collapsibleButton jsTooltip pointer icon icon16 icon-'+(i?"chevron-down":"chevron-right")+'" title="'+WCF.Language.get("wcf.global.button.collapsible")+'">').prependTo(e);return n.data("containerID",t).click($.proxy(this._toggleContainer,this)),n},_toggleContainer:function(t){var e=$(t.currentTarget),i=e.data("containerID"),n=this._containerData[i].isOpen,a=n?"open":"close",s=n?"close":"open";this._proxy.setOption("data",{actionName:"loadContainer",className:this._className,interfaceName:"wcf\\data\\ILoadableContainerAction",objectIDs:[this._getObjectID(i)],parameters:$.extend(!0,{containerID:i,currentState:a,newState:s},this._getAdditionalParameters(i))}),this._proxy.sendRequest(),$("#"+i).toggleClass("jsCollapsed")},_exchangeIcon:function(t,e){e=e||"spinner",t.removeClass("icon-chevron-down icon-chevron-right icon-spinner").addClass("icon-"+e)},_getObjectID:function(t){return $("#"+t).data("objectID")},_getAdditionalParameters:function(){return{}},_updateContent:function(t,e){this._containerData[t].target.html(e)},_success:function(t){if(t.returnValues.containerID){var e=t.returnValues.containerID;if(this._containers[e]){this._containerData[e].isOpen=t.returnValues.isOpen?!0:!1;var i=t.returnValues.isOpen?"open":"close";this._updateContent(e,$.trim(t.returnValues.content),i),this._exchangeIcon(this._containerData[e].button,t.returnValues.isOpen?"chevron-down":"chevron-right")}}}}),WCF.Collapsible.SimpleRemote=WCF.Collapsible.Remote.extend({init:function(t){this._super(t),this._proxy=new WCF.Action.Proxy({showLoadingOverlay:!1})},_initContainer:function(t){this._super(t),this._containerData[t].isOpen||(this._containerData[t].target.hide(),this._exchangeIcon(this._containerData[t].button,"chevron-right"))},_toggleContainer:function(t){var e=$(t.currentTarget),i=e.data("containerID"),n=this._containerData[i].isOpen,a=n?"open":"close",s=n?"close":"open";this._proxy.setOption("data",{actionName:"toggleContainer",className:this._className,interfaceName:"wcf\\data\\IToggleContainerAction",objectIDs:[this._getObjectID(i)],parameters:$.extend(!0,{containerID:i,currentState:a,newState:s},this._getAdditionalParameters(i))}),this._proxy.sendRequest(),this._exchangeIcon(this._containerData[i].button,"open"===s?"chevron-down":"chevron-right"),"open"===s?this._containerData[i].target.show():this._containerData[i].target.hide(),$("#"+i).toggleClass("jsCollapsed"),this._containerData[i].isOpen="open"===s?!0:!1}}),WCF.Collapsible.Sidebar=Class.extend({_button:null,_buttonHeight:0,_isOpen:!1,_mainContainer:null,_proxy:null,_sidebar:null,_sidebarHeight:0,_sidebarName:"",_sidebarOffset:0,_userPanelHeight:0,init:function(){return this._sidebar=$(".sidebar:eq(0)"),this._sidebar.length?(this._isOpen=this._sidebar.data("isOpen")?!0:!1,this._sidebarName=this._sidebar.data("sidebarName"),this._mainContainer=$("#main"),this._sidebarHeight=this._sidebar.height(),this._sidebarOffset=this._sidebar.getOffsets("offset").top,this._userPanelHeight=$("#topMenu").outerHeight(),this._button=$('<a class="collapsibleButton jsTooltip" title="'+WCF.Language.get("wcf.global.button.collapsible")+'" />').prependTo(this._sidebar),this._button.wrap("<span />"),this._button.click($.proxy(this._click,this)),this._buttonHeight=this._button.outerHeight(),WCF.DOMNodeInsertedHandler.execute(),this._proxy=new WCF.Action.Proxy({showLoadingOverlay:!1,url:"index.php/AJAXInvoke/?t="+SECURITY_TOKEN+SID_ARG_2ND}),$(document).scroll($.proxy(this._scroll,this)).resize($.proxy(this._scroll,this)),this._renderSidebar(),this._scroll(),void 0):(console.debug("[WCF.Collapsible.Sidebar] Could not find sidebar, aborting."),void 0)},_click:function(){this._isOpen=this._isOpen?!1:!0,this._proxy.setOption("data",{actionName:"toggle",className:"wcf\\system\\user\\collapsible\\content\\UserCollapsibleSidebarHandler",isOpen:this._isOpen?1:0,sidebarName:this._sidebarName}),this._proxy.sendRequest(),this._renderSidebar()},_scroll:function(){var t=$(window),e=t.scrollTop(),i=Math.max(e-this._sidebarOffset,0),n=Math.min(this._mainContainer.height(),t.height()+e-this._sidebarOffset),a=0;if(n===i)a=this._sidebarOffset+this._sidebarHeight;else{a=i+(n-i)/2;var s=Math.max(Math.min(i-this._userPanelHeight,this._userPanelHeight),0);s>0&&(a+=s/2)}n-i-this._userPanelHeight<this._buttonHeight?a-=this._buttonHeight:a=Math.max(a-this._buttonHeight/2,0),this._button.css({top:a+"px"})},_renderSidebar:function(){this._isOpen?$(".sidebarOrientationLeft, .sidebarOrientationRight").removeClass("sidebarCollapsed"):$(".sidebarOrientationLeft, .sidebarOrientationRight").addClass("sidebarCollapsed"),this._scroll()}}),WCF.User={userID:0,username:"",init:function(t,e){this.userID=t,this.username=e}},WCF.Effect={},WCF.Effect.Scroll=Class.extend({scrollTo:function(t,e,i){if(!t.length)return!0;var n=t.getOffsets("offset").top,a=$(document).height(),s=$(window).height();return n>a-s&&(n=a-s,0>n&&(n=0)),i===!0?$("html,body").scrollTop(n):$("html,body").animate({scrollTop:n},400,function(t,e,i,n,a){return-n*((e=e/a-1)*e*e*e-1)+i}),!1}}),WCF.Effect.SmoothScroll=WCF.Effect.Scroll.extend({init:function(){var t=this;$(document).on("click","a[href$=#top],a[href$=#bottom]",function(){var e=$(this.hash);return t.scrollTo(e,!0),!1})}}),WCF.Effect.BalloonTooltip=Class.extend({_didInit:!1,_tooltip:null,_viewportDimensions:{},init:function(){jQuery.browser.mobile||(this._didInit||(this._tooltip=$('<div id="balloonTooltip" class="balloonTooltip"><span id="balloonTooltipText"></span><span class="pointer"><span></span></span></div>').appendTo($("body")).hide(),this._updateViewportDimensions(),$(window).resize($.proxy(this._updateViewportDimensions,this)),WCF.DOMNodeInsertedHandler.addCallback("WCF.Effect.BalloonTooltip",$.proxy(this.init,this)),this._didInit=!0),$(".jsTooltip").each($.proxy(this._initTooltip,this)))},_updateViewportDimensions:function(){this._viewportDimensions=$(document).getDimensions()},_initTooltip:function(t,e){var i=$(e);if(i.hasClass("jsTooltip")){i.removeClass("jsTooltip");var n=i.attr("title");""!==n&&(i.data("tooltip",n),i.removeAttr("title"),i.hover($.proxy(this._mouseEnterHandler,this),$.proxy(this._mouseLeaveHandler,this)),i.click($.proxy(this._mouseLeaveHandler,this)))}},_mouseEnterHandler:function(t){var e=$(t.currentTarget),i=e.attr("title");if(i&&""!==i&&(e.data("tooltip",i),e.removeAttr("title")),this._tooltip.css({top:"0px",left:"0px"}),!e.data("tooltip"))return this._tooltip.hide(),void 0;this._tooltip.children("span:eq(0)").text(e.data("tooltip"));var n=this._tooltip.find(".pointer");this._tooltip.show();var a=n.outerWidth();this._tooltip.hide();var s=e.getOffsets("offset"),o=e.getDimensions("outer"),r=this._tooltip.getDimensions("outer"),l=this._tooltip.getDimensions("inner"),c=s.left+Math.ceil(o.width/2),h=Math.ceil(r.width/2),d="center";if(5>c-h?d="left":this._viewportDimensions.width-5<c+h&&(d="right"),s.top+o.height+r.height-$(document).scrollTop()<$(window).height()){var p=s.top+o.height+7;this._tooltip.removeClass("inverse"),n.css("top",-5)}else{var p=s.top-r.height-7;this._tooltip.addClass("inverse"),n.css("top",r.height)}switch(d){case"center":var u=Math.round(s.left-h+o.width/2);n.css({left:l.width/2-a/2+"px"});break;case"left":var u=s.left;n.css({left:"5px"});break;case"right":var u=s.left+o.width-r.width;n.css({left:l.width-a-5+"px"})}this._tooltip.css({top:p+"px",left:u+"px"}),this._tooltip.wcfFadeIn()},_mouseLeaveHandler:function(){this._tooltip.stop().hide().css({opacity:1})}}),WCF.CloseOverlayHandler={_callbacks:new WCF.Dictionary,_isListening:!1,addCallback:function(t,e){return this._bindListener(),this._callbacks.isset(t)?(console.debug("[WCF.CloseOverlayHandler] identifier '"+t+"' is already bound to a callback"),!1):(this._callbacks.add(t,e),void 0)},removeCallback:function(t){this._callbacks.isset(t)&&this._callbacks.remove(t)},_bindListener:function(){this._isListening||($("body").click($.proxy(this._executeCallbacks,this)),this._isListening=!0)},_executeCallbacks:function(){this._callbacks.each(function(t){t.value()})}},WCF.DOMNodeInsertedHandler={_callbacks:[],_isExecuting:!1,addCallback:function(t,e){this._callbacks.push(e)},_executeCallbacks:function(){if(!this._isExecuting){this._isExecuting=!0;for(var t=0,e=this._callbacks.length;e>t;t++)this._callbacks[t]();this._isExecuting=!1}},execute:function(){this._executeCallbacks()}},WCF.DOMNodeRemovedHandler={_callbacks:new WCF.Dictionary,_isExecuting:!1,_isListening:!1,addCallback:function(t,e){return this._bindListener(),this._callbacks.isset(t)?(console.debug("[WCF.DOMNodeRemovedHandler] identifier '"+t+"' is already bound to a callback"),!1):(this._callbacks.add(t,e),void 0)},removeCallback:function(t){this._callbacks.isset(t)&&this._callbacks.remove(t)},_bindListener:function(){this._isListening||($(document).bind("DOMNodeRemoved",$.proxy(this._executeCallbacks,this)),this._isListening=!0)},_executeCallbacks:function(t){this._isExecuting||(this._isExecuting=!0,this._callbacks.each(function(e){e.value(t)}),this._isExecuting=!1)}},WCF.Table={},WCF.Table.EmptyTableHandler=Class.extend({_options:{},_rowClassName:"",init:function(t,e,i){this._rowClassName=e,this._tableContainer=t,this._options=$.extend(!0,{emptyMessage:null,messageType:"info",refreshPage:!1,updatePageNumber:!1},i||{}),WCF.DOMNodeRemovedHandler.addCallback("WCF.Table.EmptyTableHandler."+e,$.proxy(this._remove,this))},_remove:function(t){var e=$(t.target);if(e.hasClass(this._rowClassName)){var i=e.parents("tbody:eq(0)");if(1==i.children("tr").length)if(this._options.emptyMessage)this._tableContainer.replaceWith($("<p />").addClass(this._options.messageType).text(this._options.emptyMessage));else if(this._options.refreshPage)if(this._options.updatePageNumber){var n=window.location.href.match(/(\?|&)pageNo=(\d+)/g);if(n){var a=n[n.length-1].match(/\d+/g);this._options.updatePageNumber>0?a++:a--,window.location=window.location.href.replace(n[n.length-1],n[n.length-1][0]+"pageNo="+a)}}else window.location.reload();else this._tableContainer.remove()}}}),WCF.Search={},WCF.Search.Base=Class.extend({_callback:null,_className:"",_commaSeperated:!1,_excludedSearchValues:[],_itemCount:0,_itemIndex:-1,_list:null,_oldSearchString:[],_proxy:null,_searchInput:null,_triggerLength:3,init:function(t,e,i,n,a){return null===e||void 0===e||$.isFunction(e)?(this._callback=e?e:null,this._excludedSearchValues=[],i&&(this._excludedSearchValues=i),this._searchInput=$(t),this._searchInput.length?(this._searchInput.keydown($.proxy(this._keyDown,this)).keyup($.proxy(this._keyUp,this)).wrap('<span class="dropdown" />'),this._list=$('<ul class="dropdownMenu" />').insertAfter(this._searchInput),this._commaSeperated=n?!0:!1,this._oldSearchString=[],this._itemCount=0,this._itemIndex=-1,this._proxy=new WCF.Action.Proxy({showLoadingOverlay:a!==!0?!1:!0,success:$.proxy(this._success,this),autoAbortPrevious:!0}),this._searchInput.is("input")&&this._searchInput.attr("autocomplete","off"),this._searchInput.blur($.proxy(this._blur,this)),WCF.Dropdown.initDropdownFragment(this._searchInput.parent(),this._list),void 0):(console.debug("[WCF.Search.Base] Selector '"+t+"' for search input is invalid, aborting."),void 0)):(console.debug("[WCF.Search.Base] The given callback is invalid, aborting."),void 0)},_blur:function(){var t=this;new WCF.PeriodicalExecuter(function(e){t._list.is(":visible")&&t._clearList(!1),e.stop()},250)},_keyDown:function(t){if(t.which===$.ui.keyCode.ENTER){var e=this._searchInput.parents(".dropdown");e.data("disableAutoFocus")?-1!==this._itemIndex&&t.preventDefault():(e.data("preventSubmit")||-1!==this._itemIndex)&&t.preventDefault()}},_keyUp:function(t){switch(t.which){case 37:case 39:return;case 38:return this._selectPreviousItem(),void 0;case 40:return this._selectNextItem(),void 0;case 13:return this._selectElement(t)}var e=this._getSearchString(t);if(""===e)this._clearList(!0);else if(e.length>=this._triggerLength){var i={data:{excludedSearchValues:this._excludedSearchValues,searchString:e}};this._searchInput.parents(".searchBar").addClass("loading"),this._proxy.setOption("data",{actionName:"getSearchResultList",className:this._className,interfaceName:"wcf\\data\\ISearchAction",parameters:this._getParameters(i)}),this._proxy.sendRequest()}else this._clearList(!1)},_selectNextItem:function(){0!==this._itemCount&&(this._itemIndex++,this._itemIndex===this._itemCount&&(this._itemIndex=0),this._highlightSelectedElement())},_selectPreviousItem:function(){0!==this._itemCount&&(this._itemIndex--,-1===this._itemIndex&&(this._itemIndex=this._itemCount-1),this._highlightSelectedElement())},_highlightSelectedElement:function(){this._list.find("li").removeClass("dropdownNavigationItem"),this._list.find("li:eq("+this._itemIndex+")").addClass("dropdownNavigationItem")},_selectElement:function(){return 0===this._itemCount?!0:(this._list.find("li.dropdownNavigationItem").trigger("click"),!1)},_getSearchString:function(t){var e=$.trim(this._searchInput.val());if(this._commaSeperated){var i=t.keyCode||t.which;if(188==i)return"";for(var n=e.split(","),a=n.length,s=0;a>s;s++)n[s]=$.trim(n[s]);for(var s=0;a>s;s++){var o=n[s];if(!this._oldSearchString[s]){e=o;break}if(o!=this._oldSearchString[s]){e=o;break}}this._oldSearchString=n}return e},_getParameters:function(t){return t},_success:function(t){if(this._clearList(!1),this._searchInput.parents(".searchBar").removeClass("loading"),$.getLength(t.returnValues))for(var e in t.returnValues){var i=t.returnValues[e];this._createListItem(i)}else if(!this._handleEmptyResult())return;WCF.CloseOverlayHandler.addCallback("WCF.Search.Base",$.proxy(function(){this._clearList()},this));var n=this._searchInput.parents(".dropdown").wcfIdentify();WCF.Dropdown.getDropdownMenu(n).hasClass("dropdownOpen")||WCF.Dropdown.toggleDropdown(n),this._itemIndex=-1,WCF.Dropdown.getDropdown(n).data("disableAutoFocus")||this._selectNextItem()},_handleEmptyResult:function(){return!1},_createListItem:function(t){var e=$("<li><span>"+WCF.String.escapeHTML(t.label)+"</span></li>").appendTo(this._list);return e.data("objectID",t.objectID).data("label",t.label).click($.proxy(this._executeCallback,this)),this._itemCount++,e},_executeCallback:function(t){var e=!1,i=$(t.currentTarget);if(this._commaSeperated)for(var n=i.data("label"),a=0,s=this._oldSearchString.length;s>a;a++){var o=this._oldSearchString[a];if(0===n.toLowerCase().indexOf(o.toLowerCase())){this._oldSearchString[a]=n,this._searchInput.val(this._oldSearchString.join(", ")),$.browser.webkit&&this._searchInput.css({display:"block"});var r=this._searchInput.val().toLowerCase().indexOf(n.toLowerCase())+n.length;this._searchInput.focus().setCaret(r);break}}else null===this._callback?this._searchInput.val(i.data("label")):e=this._callback(i.data())===!0?!0:!1;this._clearList(e)},_clearList:function(t){t&&!this._commaSeperated&&this._searchInput.val(""),WCF.Dropdown.getDropdown(this._searchInput.parents(".dropdown").wcfIdentify()).removeClass("dropdownOpen"),WCF.Dropdown.getDropdownMenu(this._searchInput.parents(".dropdown").wcfIdentify()).removeClass("dropdownOpen"),this._list.end().empty(),WCF.CloseOverlayHandler.removeCallback("WCF.Search.Base"),this._itemCount=0,this._itemIndex=-1},addExcludedSearchValue:function(t){WCF.inArray(t,this._excludedSearchValues)||this._excludedSearchValues.push(t)},removeExcludedSearchValue:function(t){var e=$.inArray(t,this._excludedSearchValues);-1!=e&&this._excludedSearchValues.splice(e,1)}}),WCF.Search.User=WCF.Search.Base.extend({_className:"wcf\\data\\user\\UserAction",_includeUserGroups:!1,init:function(t,e,i,n,a){this._includeUserGroups=i,this._super(t,e,n,a)
},_getParameters:function(t){return t.data.includeUserGroups=this._includeUserGroups?1:0,t},_createListItem:function(t){var e=this._super(t),i=null;if(t.icon?i=$(t.icon):this._includeUserGroups&&"group"===t.type&&(i=$('<span class="icon icon16 icon-group" />')),i){var n=e.find("span").detach(),a=$("<div />").addClass("box16").appendTo(e);a.append(i),a.append($("<div />").append(n))}return e.data("type",t.type),e}}),WCF.System={},WCF.System.MobileNavigation={init:function(){this._convertNavigation(),WCF.DOMNodeInsertedHandler.addCallback("WCF.System.MobileNavigation",function(){WCF.System.MobileNavigation._convertNavigation()})},_convertNavigation:function(){$("nav.jsMobileNavigation").removeClass("jsMobileNavigation").each(function(t,e){var i=$(e);$('<a class="invisible" tabindex="9999999" />').click(function(){}).prependTo(i),$('<a class="invisible" tabindex="9999999"><span class="icon icon16 icon-list" />'+(void 0!==i.data("buttonLabel")?" "+i.data("buttonLabel"):"")+"</a>").click(function(){}).prependTo(i)})}},WCF.System.Notification=Class.extend({_callback:null,_cssClassNames:"",_message:"",_overlay:null,init:function(t,e){this._cssClassNames=e||"success",this._message=t||WCF.Language.get("wcf.global.success"),this._overlay=$("#systemNotification"),this._overlay.length||(this._overlay=$('<div id="systemNotification"><p></p></div>').hide().appendTo(document.body))},show:function(t,e,i,n){e=parseInt(e),e||(e=2e3),t&&$.isFunction(t)&&(this._callback=t),this._overlay.children("p").html(i||this._message),this._overlay.children("p").removeClass().addClass(n||this._cssClassNames),new WCF.PeriodicalExecuter($.proxy(this._hide,this),e),this._overlay.wcfFadeIn(void 0,300)},_hide:function(t){null!==this._callback&&this._callback(),this._overlay.wcfFadeOut(void 0,300),t.stop()}}),WCF.System.Confirmation={_callback:null,_dialog:null,_parameters:null,_visible:!1,_confirmationButton:null,show:function(t,e,i,n){if(this._visible)return console.debug("[WCF.System.Confirmation] Confirmation dialog is already open, refusing action."),void 0;if(!$.isFunction(e))return console.debug("[WCF.System.Confirmation] Given callback is invalid, aborting."),void 0;this._callback=e,this._parameters=i;var a=!0;null===this._dialog&&(this._createDialog(),a=!1),this._dialog.find("#wcfSystemConfirmationContent").empty().hide(),n&&n.length&&n.appendTo(this._dialog.find("#wcfSystemConfirmationContent").show()),this._dialog.find("p").text(t),this._dialog.wcfDialog({onClose:$.proxy(this._close,this),onShow:$.proxy(this._show,this),title:WCF.Language.get("wcf.global.confirmation.title")}),a&&this._dialog.wcfDialog("render"),this._confirmationButton.focus(),this._visible=!0},_createDialog:function(){this._dialog=$('<div id="wcfSystemConfirmation" class="systemConfirmation"><p /><div id="wcfSystemConfirmationContent" /></div>').hide().appendTo(document.body);var t=$('<div class="formSubmit" />').appendTo(this._dialog);this._confirmationButton=$('<button class="buttonPrimary">'+WCF.Language.get("wcf.global.confirmation.confirm")+"</button>").data("action","confirm").click($.proxy(this._click,this)).appendTo(t),$("<button>"+WCF.Language.get("wcf.global.confirmation.cancel")+"</button>").data("action","cancel").click($.proxy(this._click,this)).appendTo(t)},_click:function(t){this._notify($(t.currentTarget).data("action"))},_close:function(){this._visible&&this._notify("cancel")},_notify:function(t){this._visible=!1,this._dialog.wcfDialog("close"),this._callback(t,this._parameters)},_show:function(){this._dialog.find("button.buttonPrimary").blur().focus()}},WCF.System.DisableScrolling={_depth:0,_oldOverflow:null,disable:function(){$.browser.touch||(0===this._depth&&(this._oldOverflow=$(document.body).css("overflow"),$(document.body).css("overflow","hidden")),this._depth++)},enable:function(){0!==this._depth&&(this._depth--,0===this._depth&&$(document.body).css("overflow",this._oldOverflow))}},WCF.System.PageNavigation={_button:null,_description:null,_dialog:null,_elementID:"",_elements:{},_pageNo:null,init:function(t,e){var i=$(t);if(i.length)return e=e||null,null===e||$.isFunction(e)?(this._initElements(i,e),void 0):(console.debug("[WCF.System.PageNavigation] Callback for selector '"+t+"' is invalid, aborting."),void 0)},_initElements:function(t,e){var i=this;t.each(function(t,e){var n=$(e),a=n.wcfIdentify();void 0===i._elements[a]&&(i._elements[a]=n,n.find("li.jumpTo").data("elementID",a).click($.proxy(i._click,i)))}).data("callback",e)},_click:function(t){if(this._elementID=$(t.currentTarget).data("elementID"),null===this._dialog){this._dialog=$('<div id="pageNavigationOverlay" />').hide().appendTo(document.body);var e=$("<fieldset><legend>"+WCF.Language.get("wcf.global.page.jumpTo")+"</legend></fieldset>").appendTo(this._dialog);$('<dl><dt><label for="jsPageNavigationPageNo">'+WCF.Language.get("wcf.global.page.jumpTo")+"</label></dt><dd></dd></dl>").appendTo(e),this._pageNo=$('<input type="number" id="jsPageNavigationPageNo" value="1" min="1" max="1" class="tiny" />').keyup($.proxy(this._keyUp,this)).appendTo(e.find("dd")),this._description=$("<small></small>").insertAfter(this._pageNo);var i=$('<div class="formSubmit" />').appendTo(this._dialog);this._button=$('<button class="buttonPrimary">'+WCF.Language.get("wcf.global.button.submit")+"</button>").click($.proxy(this._submit,this)).appendTo(i)}this._button.enable(),this._description.html(WCF.Language.get("wcf.global.page.jumpTo.description").replace(/#pages#/,this._elements[this._elementID].data("pages"))),this._pageNo.val(this._elements[this._elementID].data("pages")).attr("max",this._elements[this._elementID].data("pages")),this._dialog.wcfDialog({title:WCF.Language.get("wcf.global.page.pageNavigation")})},_keyUp:function(){var t=parseInt(this._pageNo.val())||0;1>t||t>this._pageNo.attr("max")?this._button.disable():this._button.enable()},_submit:function(){var t=this._elements[this._elementID];if(null===t.data("callback")){var e=t.data("link").replace(/pageNo=%d/,"pageNo="+this._pageNo.val());window.location=e}else t.data("callback")(this._pageNo.val()),this._dialog.wcfDialog("close")}},WCF.System.KeepAlive=Class.extend({init:function(t){new WCF.PeriodicalExecuter(function(t){new WCF.Action.Proxy({autoSend:!0,data:{actionName:"keepAlive",className:"wcf\\data\\session\\SessionAction"},failure:function(){t.stop()},showLoadingOverlay:!1,suppressErrors:!0})},1e3*t)}}),WCF.InlineEditor=Class.extend({_callbacks:[],_dropdowns:{},_elements:{},_notification:null,_options:[],_proxy:null,_updateData:[],init:function(t){var e=$(t);if(e.length){this._setOptions();for(var i="",n=0,a=this._options.length;a>n;n++)if(this._options[n].isQuickOption){i=this._options[n].optionName;break}var s=this;e.each(function(t,e){var n=$(e),a=n.wcfIdentify(),o=s._getTriggerElement(n);null!==o&&1===o.length&&(o.click($.proxy(s._show,s)).data("elementID",a),i&&o.disableSelection().data("optionName",i).dblclick($.proxy(s._click,s)),s._elements[a]=n)}),this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)}),WCF.CloseOverlayHandler.addCallback("WCF.InlineEditor",$.proxy(this._closeAll,this)),this._notification=new WCF.System.Notification(WCF.Language.get("wcf.global.success"),"success")}},_closeAll:function(){for(var t in this._elements)this._hide(t)},_setOptions:function(){this._options=[]},registerCallback:function(t){$.isFunction(t)&&this._callbacks.push(t)},_getTriggerElement:function(){return null},_show:function(t){var e=$(t.currentTarget).data("elementID"),i=null;this._dropdowns[e]||(i=this._getTriggerElement(this._elements[e]).addClass("dropdownToggle").wrap('<span class="dropdown" />'),this._dropdowns[e]=$('<ul class="dropdownMenu" />').insertAfter(i)),this._dropdowns[e].empty();for(var n=!1,a="",s=0,o=this._options.length;o>s;s++){var r=this._options[s];if("divider"===r.optionName)""!==a&&"divider"!==a&&($('<li class="dropdownDivider" />').appendTo(this._dropdowns[e]),a=r.optionName);else if(this._validate(e,r.optionName)||this._validateCallbacks(e,r.optionName)){var l=$("<li><span>"+r.label+"</span></li>").appendTo(this._dropdowns[e]);l.data("elementID",e).data("optionName",r.optionName).data("isQuickOption",r.isQuickOption?!0:!1).click($.proxy(this._click,this)),n=!0,a=r.optionName}}if(n){var c=this._dropdowns[e].children().last();c.hasClass("dropdownDivider")&&c.remove();var h=null,d=0;if(this._dropdowns[e].children().each(function(t,e){var i=$(e);i.hasClass("dropdownDivider")||(i.data("isQuickOption")?h=i:d++)}),!d)return h.trigger("click"),null===i&&WCF.Dropdown.close(i.parents(".dropdown").wcfIdentify()),!1}return null!==i&&WCF.Dropdown.initDropdown(i,!0),!1},_validate:function(){return!1},_validateCallbacks:function(t,e){var i=this._callbacks.length;if(i)for(var n=0;i>n;n++)if(this._callbacks[n].validate(this._elements[t],e))return!0;return!1},_success:function(){var t=this._updateData.length;t&&(this._updateState(),this._updateData=[])},_updateState:function(){},_click:function(t){var e=$(t.currentTarget),i=e.data("elementID"),n=e.data("optionName");this._execute(i,n)||this._executeCallback(i,n),this._hide(i)},_execute:function(){return!1},_executeCallback:function(t,e){var i=this._callbacks.length;if(i)for(var n=0;i>n;n++)if(this._callbacks[n].execute(this._elements[t],e))return!0;return!1},_hide:function(t){this._dropdowns[t]&&this._dropdowns[t].empty().removeClass("dropdownOpen")}}),WCF.Upload=Class.extend({_name:"__files[]",_buttonSelector:null,_fileListSelector:null,_fileUpload:null,_className:"",_iframe:null,_options:{},_uploadMatrix:[],_supportsAJAXUpload:!0,_overlay:null,init:function(t,e,i,n){this._buttonSelector=t,this._fileListSelector=e,this._className=i,this._options=$.extend(!0,{action:"upload",multiple:!1,url:"index.php/AJAXUpload/?t="+SECURITY_TOKEN+SID_ARG_2ND},n||{});var a=new XMLHttpRequest;this._supportsAJAXUpload=a&&"upload"in a&&"onprogress"in a.upload,this._createButton()},_createButton:function(){if(this._supportsAJAXUpload){this._fileUpload=$('<input type="file" name="'+this._name+'" '+(this._options.multiple?'multiple="true" ':"")+"/>"),this._fileUpload.change($.proxy(this._upload,this));var t=$('<p class="button uploadButton"><span>'+WCF.Language.get("wcf.global.button.upload")+"</span></p>");t.prepend(this._fileUpload)}else{var t=$('<p class="button uploadFallbackButton"><span>'+WCF.Language.get("wcf.global.button.upload")+"</span></p>");t.click($.proxy(this._showOverlay,this))}this._insertButton(t)},_insertButton:function(t){this._buttonSelector.append(t)},_removeButton:function(){var t=".uploadButton";this._supportsAJAXUpload||(t=".uploadFallbackButton"),this._buttonSelector.find(t).remove()},_upload:function(){var t=this._fileUpload.prop("files");if(t.length){var e=new FormData,i=this._createUploadMatrix(t);if(!this._uploadMatrix[i].length)return;for(var n=[],a=0,s=this._uploadMatrix[i].length;s>a;a++){var o=this._uploadMatrix[i][a];o.hasClass("uploadFailed")||n.push(o.data("filename"))}for(var a=0,s=t.length;s>a;a++)-1!==n.indexOf(t[a].name)&&e.append("__files[]",t[a]);e.append("actionName",this._options.action),e.append("className",this._className);var r=this._getParameters();for(var l in r)e.append("parameters["+l+"]",r[l]);var c=this;$.ajax({type:"POST",url:this._options.url,enctype:"multipart/form-data",data:e,contentType:!1,processData:!1,success:function(t){c._success(i,t)},error:$.proxy(this._error,this),xhr:function(){var t=$.ajaxSettings.xhr();return t&&t.upload.addEventListener("progress",function(t){c._progress(i,t)},!1),t}})}},_createUploadMatrix:function(t){if(t.length){var e=this._uploadMatrix.length;this._uploadMatrix[e]=[];for(var i=0,n=t.length;n>i;i++){var a=t[i],s=this._initFile(a);s.hasClass("uploadFailed")||(s.data("filename",a.name),this._uploadMatrix[e].push(s))}return e}return null},_success:function(){},_error:function(){},_progress:function(t,e){for(var i=Math.round(100*e.loaded/e.total),n=0;n<this._uploadMatrix[t].length;n++)this._uploadMatrix[t][n].find("progress").attr("value",i)},_getParameters:function(){return{}},_initFile:function(t){return $("<li>"+t.name+" ("+t.size+')<progress max="100" /></li>').appendTo(this._fileListSelector)},_showOverlay:function(){if(null===this._iframe&&(this._iframe=$('<iframe name="__fileUploadIFrame" />').hide().appendTo(document.body)),!this._overlay){this._overlay=$('<div><form enctype="multipart/form-data" method="post" action="'+this._options.url+'" target="__fileUploadIFrame" /></div>').hide().appendTo(document.body);var t=this._overlay.find("form");$('<dl class="wide"><dd><input type="file" id="__fileUpload" name="'+this._name+'" '+(this._options.multiple?'multiple="true" ':"")+"/></dd></dl>").appendTo(t),$('<div class="formSubmit"><input type="submit" value="Upload" accesskey="s" /></div></form>').appendTo(t),$('<input type="hidden" name="isFallback" value="1" />').appendTo(t),$('<input type="hidden" name="actionName" value="'+this._options.action+'" />').appendTo(t),$('<input type="hidden" name="className" value="'+this._className+'" />').appendTo(t);var e=this._getParameters();for(var i in e)$('<input type="hidden" name="'+i+'" value="'+e[i]+'" />').appendTo(t);t.submit($.proxy(function(){var t={name:this._getFilename(),size:""},e=this._createUploadMatrix([t]),i=this;this._iframe.data("loading",!0).off("load").load(function(){i._evaluateResponse(e)}),this._overlay.wcfDialog("close")},this))}this._overlay.wcfDialog({title:WCF.Language.get("wcf.global.button.upload")})},_evaluateResponse:function(t){var e=$.parseJSON(this._iframe.contents().find("pre").html());this._success(t,e)},_getFilename:function(){return $("#__fileUpload").val().split("\\").pop()}}),WCF.Sortable={},WCF.Sortable.List=Class.extend({_additionalParameters:{},_className:"",_containerID:"",_container:null,_notification:null,_offset:0,_options:{},_proxy:null,_structure:{},init:function(t,e,i,n,a,s){if(this._additionalParameters=s||{},this._containerID=$.wcfEscapeID(t),this._container=$("#"+this._containerID),this._className=e,this._offset=i?i:0,this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)}),this._structure={},this._options=$.extend(!0,{axis:"y",connectWith:"#"+this._containerID+" .sortableList",disableNesting:"sortableNoNesting",doNotClear:!0,errorClass:"sortableInvalidTarget",forcePlaceholderSize:!0,helper:"clone",items:"li:not(.sortableNoSorting)",opacity:.6,placeholder:"sortablePlaceholder",tolerance:"pointer",toleranceElement:"> span"},n||{}),a?$("#"+this._containerID+" .sortableList").sortable(this._options):$("#"+this._containerID+" > .sortableList").nestedSortable(this._options),this._className){var o=this._container.find(".formSubmit");if(!o.length&&(o=this._container.next(".formSubmit"),!o.length))return console.debug("[WCF.Sortable.Simple] Unable to find form submit for saving, aborting."),void 0;o.children('button[data-type="submit"]').click($.proxy(this._submit,this))}},_submit:function(){this._structure={},this._container.find(".sortableList").each($.proxy(function(t,e){var i=$(e),n=i.data("objectID");void 0!==n&&i.children(this._options.items).each($.proxy(function(t,e){var i=$(e).data("objectID");this._structure[n]||(this._structure[n]=[]),this._structure[n].push(i)},this))},this));var t=$.extend(!0,{data:{offset:this._offset,structure:this._structure}},this._additionalParameters);this._proxy.setOption("data",{actionName:"updatePosition",className:this._className,interfaceName:"wcf\\data\\ISortableAction",parameters:t}),this._proxy.sendRequest()},_success:function(){null===this._notification&&(this._notification=new WCF.System.Notification(WCF.Language.get("wcf.global.success.edit"))),this._notification.show()}}),WCF.Popover=Class.extend({_activeElementID:"",_cancelPopover:!1,_data:{},_defaultDimensions:{height:150,width:450},_defaultOrientation:{x:"right",y:"top"},_delay:{show:800,hide:500},_hoverElement:!1,_hoverElementID:"",_hoverPopover:!1,_margin:20,_peOut:null,_peOverElement:null,_popover:null,_popoverContent:null,_popoverOffset:10,_selector:"",init:function(t){$.browser.mobile||(this._activeElementID="",this._cancelPopover=!1,this._data={},this._defaultDimensions={height:150,width:450},this._defaultOrientation={x:"right",y:"top"},this._delay={show:800,hide:500},this._hoverElement=!1,this._hoverElementID="",this._hoverPopover=!1,this._margin=20,this._peOut=null,this._peOverElement=null,this._popoverOffset=10,this._selector=t,this._popover=$('<div class="popover"><span class="icon icon48 icon-spinner"></span><div class="popoverContent"></div></div>').hide().appendTo(document.body),this._popoverContent=this._popover.children(".popoverContent:eq(0)"),this._popover.hover($.proxy(this._overPopover,this),$.proxy(this._out,this)),this._initContainers(),WCF.DOMNodeInsertedHandler.addCallback("WCF.Popover."+t,$.proxy(this._initContainers,this)))},_initContainers:function(){if(!$.browser.mobile){var t=$(this._selector);t.length&&t.each($.proxy(function(t,e){var i=$(e),n=i.wcfIdentify();this._data[n]||(this._data[n]={content:null,isLoading:!1},i.hover($.proxy(this._overElement,this),$.proxy(this._out,this)),i.is("a")&&i.attr("href")&&i.click($.proxy(this._cancel,this)))},this))}},_cancel:function(){this._cancelPopover=!0,this._hide(!0)},_overElement:function(t){if(!this._cancelPopover){null!==this._peOverElement&&this._peOverElement.stop();var e=$(t.currentTarget).wcfIdentify();this._hoverElementID=e,this._peOverElement=new WCF.PeriodicalExecuter($.proxy(function(t){t.stop(),this._hoverElementID===e&&(this._activeElementID=e,this._prepare())},this),this._delay.show),this._hoverElement=!0,this._hoverPopover=!1}},_prepare:function(){if(!this._cancelPopover){null!==this._peOut&&this._peOut.stop(),this._popover.is(":visible")&&this._hide(!0),!this._data[this._activeElementID].loading&&this._data[this._activeElementID].content?(this._popoverContent.html(this._data[this._activeElementID].content),WCF.DOMNodeInsertedHandler.execute()):this._data[this._activeElementID].loading=!0;var t=this._popover.show().getDimensions();t=this._data[this._activeElementID].loading?{height:Math.max(t.height,this._defaultDimensions.height),width:Math.max(t.width,this._defaultDimensions.width)}:this._fixElementDimensions(this._popover,t),this._popover.hide();var e=this._getOrientation(t.height,t.width);this._popover.css(this._getCSS(e.x,e.y)),this._popover.removeClass("bottom left right top").addClass(e.x).addClass(e.y),this._show()}},_show:function(){this._cancelPopover||(this._popover.stop().show().css({opacity:1}).wcfFadeIn(),this._data[this._activeElementID].loading?(this._popover.children("span").show(),this._loadContent()):(this._popover.children("span").hide(),this._popoverContent.css({opacity:1})))},_loadContent:function(){},_insertContent:function(t,e,i){if(this._data[t]={content:e,loading:!1},this._activeElementID===t)if(i){var n=this._popoverContent.getDimensions();this._popoverContent.css({height:"auto",width:"auto"}),this._popoverContent.html(this._data[t].content);var a=this._popoverContent.getDimensions();this._popoverContent.html("").css({height:n.height+"px",width:n.width+"px"});var s=this;this._popoverContent.animate({height:a.height+"px",width:a.width+"px"},300,function(){s._popover.children("span").hide(),s._popoverContent.html(s._data[t].content).css({opacity:0}).animate({opacity:1},200),WCF.DOMNodeInsertedHandler.execute()})}else this._popover.children("span").hide(),this._popoverContent.html(this._data[t].content),WCF.DOMNodeInsertedHandler.execute()},_hide:function(t){var e=this;this._popoverContent.stop(),this._popover.stop(),t?(e._popover.css({opacity:0}).hide(),e._popoverContent.empty().css({height:"auto",opacity:0,width:"auto"})):this._popover.wcfFadeOut(function(){e._popoverContent.empty().css({height:"auto",opacity:0,width:"auto"}),e._popover.hide()})},_overPopover:function(){null!==this._peOut&&this._peOut.stop(),this._hoverElement=!1,this._hoverPopover=!0},_out:function(){this._cancelPopover||(this._hoverElementID="",this._hoverElement=!1,this._hoverPopover=!1,this._peOut=new WCF.PeriodicalExecuter($.proxy(function(t){t.stop(),this._hoverElement||this._hoverPopover||this._hide(!1)},this),this._delay.hide))},_getOrientation:function(t,e){var i=$("#"+this._activeElementID),n=i.getOffsets("offset"),a=i.getDimensions(),s=$(document).getDimensions(),o="left"===this._defaultOrientation.x?"left":"right",r="bottom"===this._defaultOrientation.y?"bottom":"top",l=this._evaluateOrientation(o,r,n,a,s,t,e);return l.flawed&&(o="left"===o?"right":"left",l=this._evaluateOrientation(o,r,n,a,s,t,e),l.flawed&&(o="right"===o?"left":"right",r="bottom"===r?"top":"bottom",l=this._evaluateOrientation(o,r,n,a,s,t,e),l.flawed&&(o="left"===o?"right":"left",l=this._evaluateOrientation(o,r,n,a,s,t,e),l.flawed&&(o="left"===this._defaultOrientationX?"left":"right",r="bottom"===this._defaultOrientationY?"bottom":"top")))),{x:o,y:r}},_evaluateOrientation:function(t,e,i,n,a,s,o){var r=0,l=0;switch(t){case"left":l=i.left-o;break;case"right":l=a.width-(i.left+o)}switch(e){case"bottom":r=a.height-(i.top+n.height+this._popoverOffset+s);break;case"top":r=i.top-(s-this._popoverOffset)}var c=!1;return(r<this._margin||l<this._margin)&&(c=!0),{flawed:c,x:l,y:r}},_getCSS:function(t,e){var i={bottom:"auto",left:"auto",right:"auto",top:"auto"},n=$("#"+this._activeElementID),a=n.getOffsets("offset"),s=this._fixElementDimensions(n,n.getDimensions()),o=$(window).getDimensions();switch(t){case"left":i.right=o.width-(a.left+s.width);break;case"right":i.left=a.left}switch(e){case"bottom":i.top=a.top+(s.height+this._popoverOffset);break;case"top":i.bottom=o.height-(a.top-this._popoverOffset)}return i},_fixElementDimensions:function(t,e){var i=t.parent().getDimensions();return i.height<e.height&&(e.height=i.height),i.width<e.width&&(e.width=i.width),e}}),WCF.EditableItemList=Class.extend({_allowCustomInput:!1,_className:"",_data:{},_form:null,_itemList:null,_objectID:0,_objectTypeID:0,_search:null,_searchInput:null,init:function(t,e){if(this._itemList=$(t),this._searchInput=$(e),this._data={},!this._itemList.length||!this._searchInput.length)return console.debug("[WCF.EditableItemList] Item list and/or search input do not exist, aborting."),void 0;if(this._objectID=this._getObjectID(),this._objectTypeID=this._getObjectTypeID(),this._itemList.find(".jsEditableItem").click($.proxy(this._click,this)),this._itemList.children("ul").length||$("<ul />").appendTo(this._itemList),this._itemList=this._itemList.children("ul"),this._form=this._itemList.parents("form").submit($.proxy(this._submit,this)),this._allowCustomInput){var i=this;this._searchInput.keydown($.proxy(this._keyDown,this)).on("paste",function(){setTimeout(function(){i._onPaste()},100)})}this._searchInput.parents(".dropdown").data("preventSubmit",!0)},_keyDown:function(t){if(null===t||188===t.which||t.which===$.ui.keyCode.ENTER){if(null!==t&&t.which===$.ui.keyCode.ENTER&&this._search&&-1!==this._search._itemIndex)return!1;var e=$.trim(this._searchInput.val());return t&&188===t.which&&(e=e.substring(0,this._searchInput.getCaret())),""===e?!0:(this.addItem({objectID:0,label:e}),t&&188===t.which?this._searchInput.val($.trim(this._searchInput.val().substr(this._searchInput.getCaret()))):this._searchInput.val(""),null!==t&&t.stopPropagation(),!1)}return!0},_onPaste:function(){var t=$.trim(this._searchInput.val());t=t.split(",");for(var e=0,i=t.length;i>e;e++){var n=$.trim(t[e]);""!==n&&this.addItem({objectID:0,label:n})}this._searchInput.val("")},load:function(){},_click:function(t){var e=$(t.currentTarget),i=e.data("objectID"),n=e.data("label");return this._search&&this._search.removeExcludedSearchValue(n),this._removeItem(i,n),e.remove(),t.stopPropagation(),!1},_getObjectID:function(){return 0},_getObjectTypeID:function(){return 0},addItem:function(t){if(this._data[t.objectID]&&(0!==t.objectID||!this._allowCustomInput))return!0;var e=$('<li class="badge">'+WCF.String.escapeHTML(t.label)+"</li>").data("objectID",t.objectID).data("label",t.label).appendTo(this._itemList);return e.click($.proxy(this._click,this)),this._search&&this._search.addExcludedSearchValue(t.label),this._addItem(t.objectID,t.label),!0},_submit:function(){this._keyDown(null)},_addItem:function(t,e){this._data[t]=e},_removeItem:function(t){delete this._data[t]}}),WCF.Sitemap=Class.extend({_cache:[],_dialog:null,_didInit:!1,_proxy:null,init:function(){$("#sitemap").click($.proxy(this._click,this)),this._cache=[],this._dialog=null,this._didInit=!1,this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)})},_click:function(){null===this._dialog?(this._dialog=$('<div id="sitemapDialog" />').appendTo(document.body),this._proxy.setOption("data",{actionName:"getSitemap",className:"wcf\\data\\sitemap\\SitemapAction"}),this._proxy.sendRequest()):this._dialog.wcfDialog("open")},_success:function(t){this._didInit?(this._cache.push(t.returnValues.sitemapName),this._dialog.find("#sitemap_"+t.returnValues.sitemapName).html(t.returnValues.template),this._dialog.wcfDialog("render")):(this._cache.push(t.returnValues.sitemapName),this._dialog.html(t.returnValues.template),this._dialog.find(".sitemapNavigation").click($.proxy(this._navigate,this)),this._dialog.find(".tabMenuContainer").wcfTabs("select","sitemap_"+t.returnValues.sitemapName),this._dialog.wcfDialog({title:WCF.Language.get("wcf.page.sitemap")}),this._didInit=!0)},_navigate:function(t){var e=$(t.currentTarget).data("sitemapName");WCF.inArray(e,this._cache)?(this._dialog.find(".tabMenuContainer").wcfTabs("select","sitemap_"+e),this._dialog.wcfDialog("render")):(this._proxy.setOption("data",{actionName:"getSitemap",className:"wcf\\data\\sitemap\\SitemapAction",parameters:{sitemapName:e}}),this._proxy.sendRequest())}}),WCF.Language.Chooser=Class.extend({_callback:null,_dropdown:null,_input:null,init:function(t,e,i,n,a,s){var o=$("#"+t);if(1!=o.length)return console.debug("[WCF.Language.Chooser] Invalid container id '"+t+"' given"),void 0;if(this._input=$("#"+e),this._input.length||(this._input=$('<input type="hidden" name="'+e+'" value="'+i+'" />').appendTo(o)),void 0!==a){if(!$.isFunction(a))return console.debug("[WCF.Language.Chooser] Given callback is invalid"),void 0;this._callback=a}this._dropdown=$('<div class="dropdown" id="'+t+'-languageChooser" />').appendTo(o),$('<div class="dropdownToggle boxFlag box24" data-toggle="'+t+'-languageChooser"></div>').appendTo(this._dropdown);var r=$('<ul class="dropdownMenu" />').appendTo(this._dropdown);for(var l in n){var c=n[l],h=$('<li class="boxFlag"><a class="box24"><div class="framed"><img src="'+c.iconPath+'" alt="" class="iconFlag" /></div> <div><h3>'+c.languageName+"</h3></div></a></li>").appendTo(r);if(h.data("languageID",l).click($.proxy(this._click,this)),l==i){var d=$(""+h.html()),p=d.children().detach();this._dropdown.children(".dropdownToggle").empty().append(p)}}if(s){$('<li class="dropdownDivider" />').appendTo(r);var h=$("<li><a>"+WCF.Language.get("wcf.global.language.noSelection")+"</a></li>").data("languageID",0).click($.proxy(this._click,this)).appendTo(r);0===i&&this._dropdown.children(".dropdownToggle").empty().append(h.html())}WCF.Dropdown.init()},_click:function(t){var e=$(t.currentTarget),i=e.data("languageID");this._input.val(i);var n=$(""+e.html()),a=0===i?n:n.children().detach();this._dropdown.children(".dropdownToggle").empty().append(a),null!==this._callback&&this._callback(e)}}),WCF.Style={},WCF.Style.Chooser=Class.extend({_dialog:null,_proxy:null,init:function(){$('<li class="styleChooser"><a>'+WCF.Language.get("wcf.style.changeStyle")+"</a></li>").appendTo($("#footerNavigation > ul.navigationItems")).click($.proxy(this._showDialog,this)),this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)})},_showDialog:function(){null===this._dialog?(this._dialog=$('<div id="styleChooser" />').hide().appendTo(document.body),this._loadDialog()):this._dialog.wcfDialog({title:WCF.Language.get("wcf.style.changeStyle")})},_loadDialog:function(){this._proxy.setOption("data",{actionName:"getStyleChooser",className:"wcf\\data\\style\\StyleAction"}),this._proxy.sendRequest()},_success:function(t){return"changeStyle"===t.actionName?(window.location.reload(),void 0):(this._dialog.html(t.returnValues.template),this._dialog.find("li").addClass("pointer").click($.proxy(this._click,this)),this._showDialog(),void 0)},_click:function(t){this._proxy.setOption("data",{actionName:"changeStyle",className:"wcf\\data\\style\\StyleAction",objectIDs:[$(t.currentTarget).data("styleID")]}),this._proxy.sendRequest()}}),WCF.UserPanel=Class.extend({_container:null,_didLoad:!1,_link:null,_noItems:"",_revertOnEmpty:!0,init:function(t){return this._container=$("#"+t),this._didLoad=!1,this._revertOnEmpty=!0,1!=this._container.length?(console.debug("[WCF.UserPanel] Unable to find container identfied by '"+t+"', aborting."),void 0):(this._convert(),void 0)},_convert:function(){this._container.addClass("dropdown"),this._link=this._container.children("a").remove();var t=$('<a class="dropdownToggle">'+this._link.html()+"</a>").appendTo(this._container).click($.proxy(this._click,this)),e=$('<ul class="dropdownMenu" />').appendTo(this._container);$('<li class="jsDropdownPlaceholder"><span>'+WCF.Language.get("wcf.global.loading")+"</span></li>").appendTo(e),this._addDefaultItems(e),this._container.dblclick($.proxy(function(){return window.location=this._link.attr("href"),!1},this)),WCF.Dropdown.initDropdown(t,!1)},_addDefaultItems:function(){},_addDivider:function(t){$('<li class="dropdownDivider" />').appendTo(t)},_click:function(){this._didLoad||(new WCF.Action.Proxy({autoSend:!0,data:this._getParameters(),success:$.proxy(this._success,this)}),this._didLoad=!0)},_getParameters:function(){return{}},_success:function(t){var e=WCF.Dropdown.getDropdownMenu(this._container.wcfIdentify());if(e.children(".jsDropdownPlaceholder").remove(),t.returnValues&&t.returnValues.template){$(""+t.returnValues.template).prependTo(e);var i=this._container.find(".badge");i.length||(i=$('<span class="badge badgeInverse" />').appendTo(this._container.children(".dropdownToggle")),i.before(" ")),i.html(t.returnValues.totalCount),this._after(e)}else $("<li><span>"+WCF.Language.get(this._noItems)+"</span></li>").prependTo(e),this._container.find(".badge").remove()},_after:function(){}}),$.widget("ui.wcfDialog",{_closeButton:null,_container:null,_content:null,_overlay:null,_title:null,_titlebar:null,_isOpen:!1,options:{autoOpen:!0,closable:!0,closeButtonLabel:null,hideTitle:!1,modal:!0,title:"",zIndex:400,onClose:null,onShow:null},_createWidget:function(t,e){return"script"===$(e).getTagName()?(console.debug("[ui.wcfDialog] Ignored script tag"),this.element=!1,null):($.Widget.prototype._createWidget.apply(this,arguments),void 0)},_init:function(){this.options.autoOpen&&this.open(),$(window).resize($.proxy(this._resize,this))},_create:function(){null===this.options.closeButtonLabel&&(this.options.closeButtonLabel=WCF.Language.get("wcf.global.button.close")),this._container=$('<div class="dialogContainer" />').hide().css({zIndex:this.options.zIndex}).appendTo(document.body),this._titlebar=$('<header class="dialogTitlebar" />').hide().appendTo(this._container),this._title=$('<span class="dialogTitle" />').hide().appendTo(this._titlebar),this._closeButton=$('<a class="dialogCloseButton jsTooltip" title="'+this.options.closeButtonLabel+'"><span /></a>').click($.proxy(this.close,this)).hide().appendTo(this._titlebar),this._content=$('<div class="dialogContent" />').appendTo(this._container),this._setOption("title",this.options.title),this._setOption("closable",this.options.closable);var t=this.element.detach();this._content.html(t),this.options.modal&&(this._overlay=$("#jsWcfDialogOverlay"),this._overlay.length||(this._overlay=$('<div id="jsWcfDialogOverlay" class="dialogOverlay" />').css({height:"100%",zIndex:399}).hide().appendTo(document.body)),this.options.closable&&(this._overlay.click($.proxy(this.close,this)),$(document).keyup($.proxy(function(t){t.keyCode&&t.keyCode===$.ui.keyCode.ESCAPE&&(this.close(),t.preventDefault())},this)))),WCF.DOMNodeInsertedHandler.execute()
},_setOption:function(t,e){return this.options[t]=e,"hideTitle"==t||"title"==t?this.options.hideTitle||""==this.options.title?this._title.html(""):this._title.html(this.options.title).show():("closable"==t||"closeButtonLabel"==t)&&(this.options.closable?(this._closeButton.attr("title",this.options.closeButtonLabel).show().find("span").html(this.options.closeButtonLabel),WCF.DOMNodeInsertedHandler.execute()):this._closeButton.hide()),!this.options.hideTitle&&""!=this.options.title||this.options.closable?this._titlebar.show():this._titlebar.hide(),this},open:function(){this.element!==!1&&(this.isOpen()||(null!==this._overlay&&(WCF.activeDialogs++,1===WCF.activeDialogs&&this._overlay.show()),this.render(),this._isOpen=!0))},isOpen:function(){return this._isOpen},close:function(t){this.isOpen()&&(this._isOpen=!1,this._container.wcfFadeOut(),null!==this._overlay&&(WCF.activeDialogs--,0===WCF.activeDialogs&&this._overlay.hide()),null!==this.options.onClose&&this.options.onClose(),void 0!==t&&t.preventDefault())},_resize:function(){this.isOpen()&&this.render()},render:function(){this._container.is(":visible")||"0px"!==this._container.css("top")||window.scrollTo(0,0),this._container.show(),this._content.children().show(),this._content.css({height:"auto",width:"auto"}),this._container.stop(),this._content.stop(),this._container.show().css("opacity",1);var t=0;this._content.find(".formSubmit").length?(t=this._content.find(".formSubmit").outerHeight(),this._content.addClass("dialogForm").css({marginBottom:t+"px"})):this._content.removeClass("dialogForm").css({marginBottom:"0px"});var e=$(window).getDimensions();.9*e.width>800&&this._container.css("maxWidth","800px");var i=this._container.getDimensions("outer"),n=this._content.getDimensions(),t=i.height-n.height,a=e.height-t-120;this._content.css({maxHeight:a+"px"}),this._determineOverflow(),i=this._container.getDimensions("outer");var s=Math.round((e.width-i.width)/2),o=Math.round((e.height-i.height)/2),r=Math.round(20*(e.height/100));o>r&&(o=r),this._container.css({left:s+"px",top:o+"px"}),this._content.css({height:"auto",width:"auto"}),this.isOpen()||(this._container.hide(),this._container.wcfFadeIn($.proxy(function(){null!==this.options.onShow&&this.options.onShow()},this)))},_determineOverflow:function(){var t=$(window).getDimensions(),e=this._content.css("maxHeight");this._content.css("maxHeight","none");var i=this._container.getDimensions("outer"),n="visible";if((.8*t.height<i.height||.8*t.width<i.width)&&(n="auto"),this._content.css("overflow",n),this._content.css("maxHeight",e),"visible"===n){var a=0;this._content.children().each(function(t,e){a+=$(e).outerHeight()}),this._content.height()<a&&this._content.css("overflow","auto")}},_getContentDimensions:function(t){var e=this._content.getDimensions();return t&&e.height>t&&(e.height=t),e}}),$.widget("ui.wcfTabs",$.ui.tabs,{_sanitizeSelector:function(t){return t.replace(/([:\.])/g,"\\$1")},select:function(t){return $.isNumeric(t)||(this.panels.each(function(e,i){return $(i).wcfIdentify()===t?(t=e,!1):void 0}),$.isNumeric(t))?(this._setOption("active",t),void 0):(console.debug("[ui.wcfTabs] Unable to find panel identified by '"+t+"', aborting."),void 0)},selectTab:function(t){t="#"+t,this.anchors.each(function(e,i){var n=$(i);return n.prop("hash")===t?(n.trigger("click"),!1):void 0})},getCurrentIndex:function(){return this.lis.index(this.lis.filter(".ui-tabs-selected"))},hasAnchor:function(t,e){var i=!1;return this.anchors.each(function(n,a){var s=$(a).attr("href");if(/#.+/.test(s)){var o=s.split("#",2);if(e&&(o=o[1].split("-",2)),o[1]===t)return i=!0,!1}}),i},revertToDefault:function(){var t=this.element.data("active");t&&""!==t||(t=0),this.select(t)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(e,i){var n,a,s=$(i).uniqueId().attr("id"),o=$(i).closest("li"),r=o.attr("aria-controls");n=i.hash,a=t.element.find(t._sanitizeSelector(n)),a.length&&(t.panels=t.panels.add(a)),r&&o.data("ui-tabs-aria-controls",r),o.attr({"aria-controls":n.substring(1),"aria-labelledby":s}),a.attr("aria-labelledby",s)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},load:function(){}}),$.widget("ui.wcfPages",{SHOW_LINKS:11,SHOW_SUB_LINKS:20,options:{activePage:1,maxPage:1,nextPage:null,previousPage:null},_create:function(){null===this.options.nextPage&&(this.options.nextPage=WCF.Language.get("wcf.global.page.next")),null===this.options.previousPage&&(this.options.previousPage=WCF.Language.get("wcf.global.page.previous")),this.element.addClass("pageNavigation"),this._render()},destroy:function(){$.Widget.prototype.destroy.apply(this,arguments),this.element.children().remove()},_render:function(){if(!this.options.disabled&&this.options.maxPage>1){var t=!1;this.element.hasClass("hidden")&&this.element.removeClass("hidden"),this.element.show(),this.element.children().remove();var e=$("<ul />");this.element.append(e);var i=$('<li class="button skip" />');if(e.append(i),this.options.activePage>1){var n=$("<a"+(null!=this.options.previousPage?' title="'+this.options.previousPage+'"':"")+"></a>");i.append(n),this._bindSwitchPage(n,this.options.activePage-1);var a=$('<span class="icon icon16 icon-double-angle-left" />');n.append(a)}else{var a=$('<span class="icon icon16 icon-double-angle-left" />');i.append(a),i.addClass("disabled"),a.addClass("disabled")}e.append(this._renderLink(1));var s=this.SHOW_LINKS-4,o=this.options.activePage-2;0>o&&(o=0);var r=this.options.maxPage-(this.options.activePage+1);0>r&&(r=0),this.options.activePage>1&&this.options.activePage<this.options.maxPage&&s--;var l=s/2,c=this.options.activePage,h=this.options.activePage;1>c&&(c=1),1>h&&(h=1),h>this.options.maxPage-1&&(h=this.options.maxPage-1),o>=l?c-=l:(c-=o,h+=l-o),r>=l?h+=l:(h+=r,c-=l-r),h=Math.ceil(h),c=Math.ceil(c),1>c&&(c=1),h>this.options.maxPage&&(h=this.options.maxPage),c>1&&(2>c-1?e.append(this._renderLink(2)):($('<li class="button jumpTo"><a title="'+WCF.Language.get("wcf.global.page.jumpTo")+'" class="jsTooltip">...</a></li>').appendTo(e),t=!0));for(var d=c+1;h>d;d++)e.append(this._renderLink(d));h<this.options.maxPage&&(this.options.maxPage-h<2?e.append(this._renderLink(this.options.maxPage-1)):($('<li class="button jumpTo"><a title="'+WCF.Language.get("wcf.global.page.jumpTo")+'" class="jsTooltip">...</a></li>').appendTo(e),t=!0)),e.append(this._renderLink(this.options.maxPage));var p=$('<li class="button skip" />');if(e.append(p),this.options.activePage<this.options.maxPage){var u=$("<a"+(null!=this.options.nextPage?' title="'+this.options.nextPage+'"':"")+"></a>");p.append(u),this._bindSwitchPage(u,this.options.activePage+1);var _=$('<span class="icon icon16 icon-double-angle-right" />');u.append(_)}else{var _=$('<span class="icon icon16 icon-double-angle-right" />');p.append(_),p.addClass("disabled"),_.addClass("disabled")}t&&(e.data("pages",this.options.maxPage),WCF.System.PageNavigation.init("#"+e.wcfIdentify(),$.proxy(function(t){this.switchPage(t)},this)))}else this.element.hide()},_renderLink:function(t,e){var i=$('<li class="button"></li>');if(void 0!=e&&e&&i.addClass("break"),t!=this.options.activePage){var n=$("<a>"+WCF.String.addThousandsSeparator(t)+"</a>");i.append(n),this._bindSwitchPage(n,t)}else{i.addClass("active");var a=$("<span>"+WCF.String.addThousandsSeparator(t)+"</span>");i.append(a)}return i},_bindSwitchPage:function(t,e){var i=this;t.click(function(){i.switchPage(e)})},switchPage:function(t){this._setOption("activePage",t)},_setOption:function(t,e){if("activePage"==t){if(e!=this.options[t]&&e>0&&e<=this.options.maxPage){var i=this._trigger("shouldSwitch",void 0,{nextPage:e});i||void 0!==i?(this.options[t]=e,this._render(),this._trigger("switched",void 0,{activePage:e})):this._trigger("notSwitched",void 0,{activePage:e})}}else this.options[t]=e,"disabled"==t?e?this.element.children().remove():this._render():"maxPage"==t&&this._render();return this},_startInput:function(t){var e=$(t.currentTarget);e.is("a")||(e=e.parent("a")),e.hide();var i=e.parent("li").children("input").css("display","block").val("");i.focus()},_stopInput:function(t){var e=$(t.currentTarget);e.css("display","none");var i=e.parent("li");void 0!=i&&null!=i&&i.children("a").show()},_handleInput:function(t){var e=$.browser.msie&&"7.0"==$.browser.version;("keyup"!=t.type||e)&&(e&&(13!=t.which&&27!=t.which||"keyup"!=t.type)||(13==t.which&&this.switchPage(parseInt($(t.currentTarget).val())),(13==t.which||27==t.which)&&(this._stopInput(t),t.stopPropagation())))}}),WCF.Category={},WCF.Category.NestedList=Class.extend({_categories:{},init:function(){var t=this;$(".jsCategory").each(function(e,i){var n=$(i).data("parentCategoryID",null).change($.proxy(t._updateSelection,t));t._categories[n.val()]=n;var a=[];n.parents("li").find(".jsChildCategory").each(function(e,i){var s=$(i).data("parentCategoryID",n.val()).change($.proxy(t._updateSelection,t));t._categories[s.val()]=s,a.push(s.val()),s.is(":checked")&&n.prop("checked","checked")}),n.data("childCategoryIDs",a)})},_updateSelection:function(t){var e=$(t.currentTarget),i=e.data("parentCategoryID");if(e.is(":checked"))null!==i&&this._categories[i].prop("checked","checked");else if(null===i)for(var n=e.data("childCategoryIDs"),a=0,s=n.length;s>a;a++)this._categories[n[a]].prop("checked",!1)}});
=======
(function(){var c=jQuery.fn.data;jQuery.fn.data=function(f,h){if(f){switch(typeof f){case"object":for(var g in f){if(g.match(/ID$/)){var e=f[g];delete f[g];g=g.replace(/ID$/,"-id");f[g]=e}}arguments[0]=f;break;case"string":if(f.match(/ID$/)){arguments[0]=f.replace(/ID$/,"-id")}break}}var d=c.apply(this,arguments);if(f===undefined){for(var g in d){if(g.match(/Id$/)){d[g.replace(/Id$/,"ID")]=d[g];delete d[g]}}}return d};if(!window.console){window.console={}}var b=["log","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","profile","profileEnd","count","clear","time","timeEnd","timeStamp","table","error"];for(var a=0;a<b.length;a++){if(typeof(console[b[a]])==="undefined"){console[b[a]]=function(){}}}if(typeof(console.debug)==="undefined"){console.debug=function(d){console.log(d)}}})();(function(){var d=false,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(j){function a(){if(!d&&this.init){this.init.apply(this,arguments)}}var i=this.prototype;d=true;var h=new this;d=false;for(var b in j){h[b]=typeof j[b]=="function"&&typeof i[b]=="function"&&c.test(j[b])?function(f,e){return function(){var k=this._super;this._super=i[f];var g=e.apply(this,arguments);this._super=k;return g}}(b,j[b]):j[b]}a.prototype=h;a.prototype.constructor=a;a.extend=arguments.callee;return a}})();String.prototype.hashCode=function(){var a;var b=0;if(this.length){for(var d=0,c=this.length;d<c;d++){a=this.charCodeAt(d);b=((b<<5)-b)+a;b=b&b}}return b};(function(){var c=navigator.userAgent.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||c.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(c)||[];var a={browser:b[1]||"",version:b[2]||"0"};browser={};if(a.browser){browser[a.browser]=true;browser.version=a.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}jQuery.browser=browser;jQuery.browser.touch=(!!("ontouchstart" in window)||!!("msmaxtouchpoints" in window.navigator))})();(function(b){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);var WCF={};$.extend(true,{removeArrayValue:function(b,a){return $.grep(b,function(d,c){return a!==d})},wcfEscapeID:function(a){return a.replace(/(:|\.)/g,"\\$1")},wcfIsset:function(a){return !!$("#"+$.wcfEscapeID(a)).length},getLength:function(a){var c=0;for(var b in a){if(a.hasOwnProperty(b)){c++}}return c}});$.fn.extend({getTagName:function(){return(this.length)?this.get(0).tagName.toLowerCase():""},getDimensions:function(b){var c=css={};var a=false;if(this.is(":hidden")){css=WCF.getInlineCSS(this);a=true;this.css({display:"block",visibility:"hidden"})}switch(b){case"inner":c={height:this.innerHeight(),width:this.innerWidth()};break;case"outer":c={height:this.outerHeight(),width:this.outerWidth()};break;default:c={height:this.height(),width:this.width()};break}if(a){WCF.revertInlineCSS(this,css,["display","visibility"])}return c},getOffsets:function(b){var c=css={};var a=false;if(this.is(":hidden")){css=WCF.getInlineCSS(this);a=true;this.css({display:"block",visibility:"hidden"})}switch(b){case"offset":c=this.offset();break;case"position":default:c=this.position();break}if(a){WCF.revertInlineCSS(this,css,["display","visibility"])}return c},makePositioned:function(a,b){if(a!="absolute"&&a!="fixed"){a="absolute"}var c=this.getOffsets("position");this.css({position:a,left:c.left,margin:0,top:c.top});if(b){this.remove().appentTo("body")}return this},disable:function(){return this.attr("disabled","disabled")},enable:function(){return this.removeAttr("disabled")},wcfIdentify:function(){if(!this.attr("id")){this.attr("id",WCF.getRandomID())}return this.attr("id")},getCaret:function(){if(this.is("input")){if(this.attr("type")!="text"&&this.attr("type")!="password"){return -1}}else{if(!this.is("textarea")){return -1}}var c=0;var b=this.get(0);if(document.selection){this.focus();var a=document.selection.createRange();a.moveStart("character",-this.val().length);c=a.text.length}else{if(b.selectionStart||b.selectionStart=="0"){c=parseInt(b.selectionStart)}}return c},setCaret:function(b){if(this.is("input")){if(this.attr("type")!="text"&&this.attr("type")!="password"){return false}}else{if(!this.is("textarea")){return false}}var c=this.get(0);this.focus();if(document.selection){var a=document.selection.createRange();a.moveStart("character",b);a.moveEnd("character",0);a.select()}else{if(c.selectionStart||c.selectionStart=="0"){c.selectionStart=b;c.selectionEnd=b}}return true},wcfDropIn:function(b,c,a){if(!b){b="up"}if(!a||!parseInt(a)){a=200}return this.show(WCF.getEffect(this,"drop"),{direction:b},a,c)},wcfDropOut:function(b,c,a){if(!b){b="down"}if(!a||!parseInt(a)){a=200}return this.hide(WCF.getEffect(this,"drop"),{direction:b},a,c)},wcfBlindIn:function(b,c,a){if(!b){b="vertical"}if(!a||!parseInt(a)){a=200}return this.show(WCF.getEffect(this,"blind"),{direction:b},a,c)},wcfBlindOut:function(b,c,a){if(!b){b="vertical"}if(!a||!parseInt(a)){a=200}return this.hide(WCF.getEffect(this,"blind"),{direction:b},a,c)},wcfHighlight:function(a,b){return this.effect("highlight",a,600,b)},wcfFadeIn:function(b,a){if(!a||!parseInt(a)){a=200}return this.show(WCF.getEffect(this,"fade"),{},a,b)},wcfFadeOut:function(b,a){if(!a||!parseInt(a)){a=200}return this.hide(WCF.getEffect(this,"fade"),{},a,b)}});$.extend(WCF,{activeDialogs:0,_idCounter:0,getRandomID:function(){var a="";do{a="wcf"+this._idCounter++}while($.wcfIsset(a));return a},inArray:function(b,a){return($.inArray(b,a)!=-1)},getEffect:function(a,b){if(a.is("tr")){return"highlight"}return b},getInlineCSS:function(b){var c={};var a=b.attr("style");if(!a){return{}}a=a.split(";");for(var f=0,d=a.length;f<d;f++){var e=$.trim(a[f]);if(e==""){continue}e=e.split(":");c[$.trim(e[0])]=$.trim(e[1])}return c},revertInlineCSS:function(a,c,e){for(var f=0,d=e.length;f<d;f++){var b=e[f];if(c[b]){a.css(b,c[b])}else{a.css(b,"")}}}});WCF.Browser={_isChrome:null,isChrome:function(){if(this._isChrome===null){this._isChrome=false;if(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())){this._isChrome=true}}return this._isChrome}};WCF.Dropdown={_callbacks:{},_didInit:false,_dropdowns:{},_menuContainer:null,_menus:{},init:function(){if(this._menuContainer===null){this._menuContainer=$('<div id="dropdownMenuContainer" />').appendTo(document.body)}var a=this;$(".dropdownToggle:not(.jsDropdownEnabled)").each(function(b,c){a.initDropdown($(c),false)});if(!this._didInit){this._didInit=true;WCF.CloseOverlayHandler.addCallback("WCF.Dropdown",$.proxy(this._closeAll,this));WCF.DOMNodeInsertedHandler.addCallback("WCF.Dropdown",$.proxy(this.init,this))}$(document).on("scroll",$.proxy(this._scroll,this))},_dialogScroll:function(b){var a=$(b.currentTarget);a.find(".dropdown.dropdownOpen").each(function(d,f){var i=$(f);var e=i.wcfIdentify();var g=i.offset();var c=a.offset();var h=$(f).height()/2;if(g.top+h<=c.top){WCF.Dropdown.toggleDropdown(e)}else{if(g.top>=c.top+a.height()){WCF.Dropdown.toggleDropdown(e)}else{if(g.left<=c.left){WCF.Dropdown.toggleDropdown(e)}else{if(g.left>=c.left+a.width()){WCF.Dropdown.toggleDropdown(e)}else{WCF.Dropdown.setAlignmentByID(i.wcfIdentify())}}}}})},_scroll:function(b){for(var a in this._dropdowns){var c=this._dropdowns[a];if(c.data("isOverlayDropdownButton")&&c.hasClass("dropdownOpen")){this.setAlignmentByID(a)}}},initDropdown:function(b,d){if(b.hasClass("jsDropdownEnabled")||b.data("target")){return}var e=b.parents(".dropdown");if(!e.length){return}var a=b.next(".dropdownMenu");if(!a.length){return}a.detach().appendTo(this._menuContainer);var c=e.wcfIdentify();if(!this._dropdowns[c]){b.addClass("jsDropdownEnabled").click($.proxy(this._toggle,this));this._dropdowns[c]=e;this._menus[c]=a}b.data("target",c);if(d){b.trigger("click")}},removeDropdown:function(a){if(this._menus[a]){$(this._menus[a]).remove();delete this._menus[a];delete this._dropdowns[a]}},initDropdownFragment:function(c,a){var b=c.wcfIdentify();if(this._dropdowns[b]){console.debug("[WCF.Dropdown] Cannot register dropdown identified by '"+b+"' as a fragement.");return}this._dropdowns[b]=c;this._menus[b]=a.detach().appendTo(this._menuContainer)},registerCallback:function(a,b){if(!$.isFunction(b)){console.debug("[WCF.Dropdown] Callback for '"+a+"' is invalid");return false}if(!this._callbacks[a]){this._callbacks[a]=[]}this._callbacks[a].push(b)},_toggle:function(g,e){var b=(g===null)?e:$(g.currentTarget).data("target");var a=this._dropdowns[b];if(a&&a.data("isOverlayDropdownButton")===undefined){var d=a.parents(".dialogContent");a.data("isOverlayDropdownButton",d.length>0);if(d.length){d.on("scroll",this._dialogScroll)}}for(var f in this._dropdowns){var h=this._dropdowns[f];var c=this._menus[f];if(h.hasClass("dropdownOpen")){h.removeClass("dropdownOpen");c.removeClass("dropdownOpen");this._notifyCallbacks(f,"close")}else{if(f===b){h.addClass("dropdownOpen");c.addClass("dropdownOpen");this._notifyCallbacks(f,"open");this.setAlignment(h,c)}}}if(g!==null){g.stopPropagation();return false}},toggleDropdown:function(a){this._toggle(null,a)},getDropdown:function(a){if(this._dropdowns[a]){return this._dropdowns[a]}return null},getDropdownMenu:function(a){if(this._menus[a]){return this._menus[a]}return null},setAlignmentByID:function(a){var c=this.getDropdown(a);if(c===null){console.debug("[WCF.Dropdown] Unable to find dropdown identified by '"+a+"'")}var b=this.getDropdownMenu(a);if(b===null){console.debug("[WCF.Dropdown] Unable to find dropdown menu identified by '"+a+"'")}this.setAlignment(c,b)},setAlignment:function(j,e){var c=j.getDimensions("outer");var g=j.getOffsets("offset");var h=e.getDimensions("outer");var d=$(window).width();var a=j.find(".dropdownToggle");if(a.hasClass("dropdownCaptionTextarea")){c=a.getDimensions("outer")}var f="left";if((g.left+h.width)>d){f="right"}var b="auto";var i="auto";if(f==="left"){e.removeClass("dropdownArrorRight");b=g.left+"px"}else{e.addClass("dropdownArrowRight");i=(d-(g.left+c.width))+"px"}e.css({left:b,right:i,top:g.top+c.height+7+"px"})},_closeAll:function(){for(var a in this._dropdowns){var b=this._dropdowns[a];if(b.hasClass("dropdownOpen")){b.removeClass("dropdownOpen");this._menus[a].removeClass("dropdownOpen");this._notifyCallbacks(a,"close")}}},close:function(a){if(!this._dropdowns[a]){return}this._dropdowns[a].removeClass("dropdownMenu");this._menus[a].removeClass("dropdownMenu")},_notifyCallbacks:function(a,b){if(!this._callbacks[a]){return}for(var d=0,c=this._callbacks[a].length;d<c;d++){this._callbacks[a][d](a,b)}}};WCF.Clipboard={_actionProxy:null,_actionObjects:{},_containers:null,_containerData:{},_hasMarkedItems:false,_markedObjectIDs:{},_page:"",_pageObjectID:0,_proxy:null,_trackedElements:{},init:function(d,b,e,c){this._page=d;this._actionObjects=e||{};this._hasMarkedItems=(b>0);this._pageObjectID=parseInt(c)||0;this._actionProxy=new WCF.Action.Proxy({success:$.proxy(this._actionSuccess,this),url:"index.php/ClipboardProxy/?t="+SECURITY_TOKEN+SID_ARG_2ND});this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this),url:"index.php/Clipboard/?t="+SECURITY_TOKEN+SID_ARG_2ND});this._containers=$(".jsClipboardContainer").each($.proxy(function(g,f){this._initContainer(f)},this));if(this._hasMarkedItems&&this._containers.length){this._loadMarkedItems()}var a=this;WCF.DOMNodeInsertedHandler.addCallback("WCF.Clipboard",function(){a._containers=$(".jsClipboardContainer").each($.proxy(function(g,f){a._initContainer(f)},a))})},_loadMarkedItems:function(){new WCF.Action.Proxy({autoSend:true,data:{containerData:this._containerData,pageClassName:this._page,pageObjectID:this._pageObjectID},success:$.proxy(this._loadMarkedItemsSuccess,this),url:"index.php/ClipboardLoadMarkedItems/?t="+SECURITY_TOKEN+SID_ARG_2ND})},reload:function(){if(this._containers===null){return}this._loadMarkedItems()},_loadMarkedItemsSuccess:function(d,f,c){this._resetMarkings();for(var a in d.markedItems){if(!this._markedObjectIDs[a]){this._markedObjectIDs[a]=[]}var b=d.markedItems[a];for(var e in b){this._markedObjectIDs[a].push(b[e])}this._containers.each($.proxy(function(h,g){var i=$(g);if(i.data("type")!=a){return true}i.find("input.jsClipboardItem").each($.proxy(function(l,k){var j=$(k);if(WCF.inArray(j.data("objectID"),this._markedObjectIDs[a])){j.prop("checked",true);j.parents(".jsClipboardObject").addClass("jsMarked")}},this));i.find("input.jsClipboardMarkAll").each(function(l,k){var j=true;i.find("input.jsClipboardItem").each(function(n,o){var m=$(o);if(!m.prop("checked")){j=false}});if(j){$(k).prop("checked",true)}})},this))}this._success(d,f,c)},_resetMarkings:function(){this._containers.each($.proxy(function(b,a){var c=$(a);this._markedObjectIDs[c.data("type")]=[];c.find("input.jsClipboardItem, input.jsClipboardMarkAll").prop("checked",false);c.find(".jsClipboardObject").removeClass("jsMarked")},this))},_initContainer:function(a){var c=$(a);var b=c.wcfIdentify();if(!this._trackedElements[b]){c.find(".jsClipboardMarkAll").data("hasContainer",b).click($.proxy(this._markAll,this));this._markedObjectIDs[c.data("type")]=[];this._containerData[c.data("type")]={};$.each(c.data(),$.proxy(function(d,e){if(d.match(/^type(.+)/)){this._containerData[c.data("type")][WCF.String.lcfirst(d.replace(/^type/,""))]=e}},this));this._trackedElements[b]=[]}c.find("input.jsClipboardItem").each($.proxy(function(f,e){var g=$(e);var d=g.wcfIdentify();if(!WCF.inArray(d,this._trackedElements[b])){this._trackedElements[b].push(d);g.data("hasContainer",b).click($.proxy(this._click,this))}},this))},_click:function(f){var b=$(f.target);var e=b.data("objectID");var h=(b.prop("checked"))?true:false;var d=[e];if(b.data("hasContainer")){var g=$("#"+b.data("hasContainer"));var a=g.data("type")}else{var a=b.data("type")}if(h){this._markedObjectIDs[a].push(e);b.parents(".jsClipboardObject").addClass("jsMarked")}else{this._markedObjectIDs[a]=$.removeArrayValue(this._markedObjectIDs[a],e);b.parents(".jsClipboardObject").removeClass("jsMarked")}if(b.data("hasContainer")){var c=true;g.find("input.jsClipboardItem").each(function(j,i){var k=$(i);if(!k.prop("checked")){c=false}});g.find(".jsClipboardMarkAll").each(function(i,j){if(c){$(j).prop("checked",true)}else{$(j).prop("checked",false)}})}this._saveState(a,d,h)},_markAll:function(d){var b=$(d.target);var c=[];var f=true;if(b.is("input")){f=b.prop("checked")}if(b.data("hasContainer")){var e=$("#"+b.data("hasContainer"));var a=e.data("type")}else{var a=b.data("type")}if(b.data("hasContainer")){e.find("input.jsClipboardItem").each($.proxy(function(h,g){var j=$(g);var i=j.data("objectID");if(f){if(!j.prop("checked")){j.prop("checked",true);this._markedObjectIDs[a].push(i);c.push(i)}}else{if(j.prop("checked")){j.prop("checked",false);this._markedObjectIDs[a]=$.removeArrayValue(this._markedObjectIDs[a],i);c.push(i)}}},this));if(f){e.find(".jsClipboardObject").addClass("jsMarked")}else{e.find(".jsClipboardObject").removeClass("jsMarked")}}this._saveState(a,c,f)},_saveState:function(b,c,a){this._proxy.setOption("data",{action:(a)?"mark":"unmark",containerData:this._containerData,objectIDs:c,pageClassName:this._page,pageObjectID:this._pageObjectID,type:b});this._proxy.sendRequest()},_success:function(data,textStatus,jqXHR){var $containers={};$(".jsClipboardEditor").each(function(index,container){var $container=$(container);var $types=eval($container.data("types"));for(var $i=0,$length=$types.length;$i<$length;$i++){var $typeName=$types[$i];$containers[$typeName]=$container}var $containerID=$container.wcfIdentify();WCF.CloseOverlayHandler.removeCallback($containerID);$container.empty()});if(!data.items){return}for(var $typeName in data.items){if(!$containers[$typeName]){continue}var $container=$containers[$typeName];var $list=$container.children("ul");if($list.length==0){$list=$("<ul />").appendTo($container)}var $editor=data.items[$typeName];var $label=$('<li class="dropdown"><span class="dropdownToggle button">'+$editor.label+"</span></li>").appendTo($list);var $itemList=$('<ol class="dropdownMenu"></ol>').appendTo($label);for(var $itemIndex in $editor.items){var $item=$editor.items[$itemIndex];var $listItem=$("<li><span>"+$item.label+"</span></li>").appendTo($itemList);$listItem.data("container",$container);$listItem.data("objectType",$typeName);$listItem.data("actionName",$item.actionName).data("parameters",$item.parameters);$listItem.data("internalData",$item.internalData).data("url",$item.url).data("type",$typeName);$listItem.click($.proxy(this._executeAction,this))}$('<li class="dropdownDivider" />').appendTo($itemList);$("<li><span>"+WCF.Language.get("wcf.clipboard.item.unmarkAll")+"</span></li>").appendTo($itemList).click($.proxy(function(){this._proxy.setOption("data",{action:"unmarkAll",type:$typeName});this._proxy.setOption("success",$.proxy(function(data,textStatus,jqXHR){for(var $__containerID in this._containers){var $__container=$(this._containers[$__containerID]);if($__container.data("type")==$typeName){$__container.find(".jsClipboardMarkAll, .jsClipboardItem").prop("checked",false);$__container.find(".jsClipboardObject").removeClass("jsMarked");break}}this._success(data,textStatus,jqXHR);this._proxy.setOption("success",$.proxy(this._success,this))},this));this._proxy.sendRequest()},this));WCF.Dropdown.initDropdown($label.children(".dropdownToggle"),false)}},_closeLists:function(){$(".jsClipboardEditor ul").removeClass("dropdownOpen")},_executeAction:function(e){var c=$(e.currentTarget);var d=c.data("url");if(d){window.location.href=d}if(c.data("parameters").className&&c.data("parameters").actionName){if(c.data("parameters").actionName==="unmarkAll"||c.data("parameters").objectIDs){var b=c.data("internalData")["confirmMessage"];if(b){var a=c.data("internalData")["template"];if(a){a=$(a)}WCF.System.Confirmation.show(b,$.proxy(function(g){if(g==="confirm"){var f={};if(a&&a.length){$("#wcfSystemConfirmationContent").find("input, select, textarea").each(function(i,j){var h=$(j);f[h.prop("name")]=h.val()})}this._executeAJAXActions(c,f)}},this),"",a)}else{this._executeAJAXActions(c,{})}}}c.data("container").trigger("clipboardAction",[c.data("type"),c.data("actionName"),c.data("parameters")])},_executeAJAXActions:function(d,e){e=e||{};var a=[];if(d.data("parameters").actionName!=="unmarkAll"){$.each(d.data("parameters").objectIDs,function(g,h){a.push(parseInt(h))})}var b={data:e,containerData:this._containerData[d.data("type")]};var f=d.data("internalData")["parameters"];if(f!==undefined){for(var c in f){b[c]=f[c]}}new WCF.Action.Proxy({autoSend:true,data:{actionName:d.data("parameters").actionName,className:d.data("parameters").className,objectIDs:a,parameters:b},success:$.proxy(function(g){if(d.data("parameters").actionName!=="unmarkAll"){d.data("container").trigger("clipboardActionResponse",[g,d.data("type"),d.data("actionName"),d.data("parameters")])}this._loadMarkedItems()},this)});if(this._actionObjects[d.data("objectType")]&&this._actionObjects[d.data("objectType")][d.data("parameters").actionName]){this._actionObjects[d.data("objectType")][d.data("parameters").actionName].triggerEffect(a)}},sendRequest:function(b){var a=$(b);this._actionProxy.setOption("data",{parameters:a.data("parameters"),typeName:a.data("type")});this._actionProxy.sendRequest()}};WCF.PeriodicalExecuter=Class.extend({_callback:null,_intervalID:null,_isExecuting:false,init:function(b,a){if(!$.isFunction(b)){console.debug("[WCF.PeriodicalExecuter] Given callback is invalid, aborting.");return}this._callback=b;this._intervalID=setInterval($.proxy(this._execute,this),a)},_execute:function(){if(!this._isExecuting){try{this._isExecuting=true;this._callback(this);this._isExecuting=false}catch(a){this._isExecuting=false;throw a}}},stop:function(){if(!this._intervalID){return}clearInterval(this._intervalID)}});WCF.LoadingOverlayHandler={_activeRequests:0,_loadingOverlay:null,_pending:null,show:function(){if(this._loadingOverlay===null){this._loadingOverlay=$('<div class="spinner"><span class="icon icon48 icon-spinner" /> <span>'+WCF.Language.get("wcf.global.loading")+"</span></div>").hide().appendTo($("body"))}this._activeRequests++;if(this._activeRequests==1){if(this._pending===null){var a=this;this._pending=new WCF.PeriodicalExecuter(function(b){if(a._activeRequests){a._loadingOverlay.stop(true,true).fadeIn(100)}b.stop();a._pending=null},250)}}},hide:function(){this._activeRequests--;if(this._activeRequests==0){if(this._pending!==null){this._pending.stop();this._pending=null}this._loadingOverlay.stop(true,true).fadeOut(100)}},updateIcon:function(b,c){var a=(c===undefined||c?"addClass":"removeClass");b.find(".icon")[a]("icon-spinner");if(b.hasClass("icon")){b[a]("icon-spinner")}}};WCF.Action={};WCF.Action.Proxy=Class.extend({_showLoadingOverlayOnce:false,_suppressErrors:false,_lastRequest:null,init:function(b){this.options=$.extend(true,{autoSend:false,data:{},dataType:"json",after:null,init:null,jsonp:"callback",async:true,failure:null,showLoadingOverlay:true,success:null,suppressErrors:false,type:"POST",url:"index.php/AJAXProxy/?t="+SECURITY_TOKEN+SID_ARG_2ND,aborted:null,autoAbortPrevious:false},b);this.confirmationDialog=null;this.loading=null;this._showLoadingOverlayOnce=false;this._suppressErrors=(this.options.suppressErrors===true);if(this.options.autoSend){this.sendRequest()}var a=this;$(window).on("beforeunload",function(){a._suppressErrors=true})},sendRequest:function(a){this._init();if(a||this.options.autoAbortPrevious){this.abortPrevious()}this._lastRequest=$.ajax({data:this.options.data,dataType:this.options.dataType,jsonp:this.options.jsonp,async:this.options.async,type:this.options.type,url:this.options.url,success:$.proxy(this._success,this),error:$.proxy(this._failure,this)});return this._lastRequest},abortPrevious:function(){if(this._lastRequest!==null){this._lastRequest.abort();this._lastRequest=null}},showLoadingOverlayOnce:function(){this._showLoadingOverlayOnce=true},suppressErrors:function(){this._suppressErrors=true},_init:function(){if($.isFunction(this.options.init)){this.options.init(this)}if(this.options.showLoadingOverlay||this._showLoadingOverlayOnce){WCF.LoadingOverlayHandler.show()}},_failure:function(d,i,h){if(i=="abort"){if($.isFunction(this.options.aborted)){this.options.aborted(d)}return}try{var c=$.parseJSON(d.responseText);var f=true;if($.isFunction(this.options.failure)){f=this.options.failure(c,d,i,h)}if(!this._suppressErrors&&f!==false){var a="";if(c.stacktrace){a="<br /><p>Stacktrace:</p><p>"+c.stacktrace+"</p>"}else{if(c.exceptionID){a="<br /><p>Exception ID: <code>"+c.exceptionID+"</code></p>"}}$('<div class="ajaxDebugMessage"><p>'+c.message+"</p>"+a+"</div>").wcfDialog({title:WCF.Language.get("wcf.global.error.title")})}}catch(g){var f=true;if($.isFunction(this.options.failure)){f=this.options.failure(null,d,i,h)}if(!this._suppressErrors&&f!==false){var b=(i==="timeout")?WCF.Language.get("wcf.global.error.timeout"):d.responseText;if(b&&b!="undefined"){$('<div class="ajaxDebugMessage"><p>'+b+"</p></div>").wcfDialog({title:WCF.Language.get("wcf.global.error.title")})}}}this._after()},_success:function(b,c,a){if($.isFunction(this.options.success)){if(b&&b.returnValues&&b.returnValues.template!==undefined){b.returnValues.template=$.trim(b.returnValues.template)}this.options.success(b,c,a)}this._after()},_after:function(){this._lastRequest=null;if($.isFunction(this.options.after)){this.options.after()}if(this.options.showLoadingOverlay||this._showLoadingOverlayOnce){WCF.LoadingOverlayHandler.hide();if(this._showLoadingOverlayOnce){this._showLoadingOverlayOnce=false}}WCF.DOMNodeInsertedHandler.execute();$("a[href*=#]").each(function(c,e){var b=$(e);if(b.prop("href").indexOf("AJAXProxy")!=-1){var d=b.prop("href").substr(b.prop("href").indexOf("#"));var a=document.location.toString().replace(/#.*/,"");b.prop("href",a+d)}})},setOption:function(a,b){this.options[a]=b}});WCF.Action.SimpleProxy=Class.extend({init:function(a,b){this.options=$.extend(true,{action:"",className:"",elements:null,eventName:"click"},a);this.callbacks=$.extend(true,{after:null,failure:null,init:null,success:null},b);if(!this.options.elements){return}this.proxy=new WCF.Action.Proxy(this.callbacks);this.options.elements.each($.proxy(function(c,d){$(d).bind(this.options.eventName,$.proxy(this._handleEvent,this))},this))},_handleEvent:function(a){this.proxy.setOption("data",{actionName:this.options.action,className:this.options.className,objectIDs:[$(a.target).data("objectID")]});this.proxy.sendRequest()}});WCF.Action.Delete=Class.extend({_buttonSelector:"",_className:"",_containerSelector:"",_containers:[],init:function(c,a,b){this._containerSelector=a;this._className=c;this._buttonSelector=(b)?b:".jsDeleteButton";this.proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._initElements();WCF.DOMNodeInsertedHandler.addCallback("WCF.Action.Delete"+this._className.hashCode(),$.proxy(this._initElements,this))},_initElements:function(){var a=this;$(this._containerSelector).each(function(c,b){var e=$(b);var d=e.wcfIdentify();if(!WCF.inArray(d,a._containers)){a._containers.push(d);e.find(a._buttonSelector).click($.proxy(a._click,a))}})},_click:function(b){var a=$(b.currentTarget);b.preventDefault();if(a.data("confirmMessage")){WCF.System.Confirmation.show(a.data("confirmMessage"),$.proxy(this._execute,this),{target:a})}else{WCF.LoadingOverlayHandler.updateIcon(a);this._sendRequest(a)}},_didTriggerEffect:function(a){},_execute:function(b,a){if(b==="cancel"){return}WCF.LoadingOverlayHandler.updateIcon(a.target);this._sendRequest(a.target)},_sendRequest:function(a){this.proxy.setOption("data",{actionName:"delete",className:this._className,interfaceName:"wcf\\data\\IDeleteAction",objectIDs:[$(a).data("objectID")]});this.proxy.sendRequest()},_success:function(b,c,a){this.triggerEffect(b.objectIDs)},triggerEffect:function(c){for(var a in this._containers){var d=$("#"+this._containers[a]);if(WCF.inArray(d.find(this._buttonSelector).data("objectID"),c)){var b=this;d.wcfBlindOut("up",function(){$(this).remove();b._containers.splice(b._containers.indexOf($(this).wcfIdentify()),1);b._didTriggerEffect($(this))})}}}});WCF.Action.NestedDelete=WCF.Action.Delete.extend({triggerEffect:function(c){for(var a in this._containers){var d=$("#"+this._containers[a]);if(WCF.inArray(d.find(this._buttonSelector).data("objectID"),c)){if(d.has("ol").has("li").length){if(d.is(":only-child")){d.parent().replaceWith(d.find("> ol"))}else{d.replaceWith(d.find("> ol > li"))}this._containers.splice(this._containers.indexOf(d.wcfIdentify()),1);this._didTriggerEffect(d)}else{var b=this;d.wcfBlindOut("up",function(){$(this).remove();b._containers.splice(b._containers.indexOf($(this).wcfIdentify()),1);b._didTriggerEffect($(this))})}}}}});WCF.Action.Toggle=Class.extend({_buttonSelector:".jsToggleButton",_className:"",_containerSelector:"",_containers:[],init:function(d,a,c){this._containerSelector=a;this._className=d;this._buttonSelector=(c)?c:".jsToggleButton";var b={success:$.proxy(this._success,this)};this.proxy=new WCF.Action.Proxy(b);this._initElements();WCF.DOMNodeInsertedHandler.addCallback("WCF.Action.Toggle"+this._className.hashCode(),$.proxy(this._initElements,this))},_initElements:function(){$(this._containerSelector).each($.proxy(function(b,a){var d=$(a);var c=d.wcfIdentify();if(!WCF.inArray(c,this._containers)){this._containers.push(c);d.find(this._buttonSelector).click($.proxy(this._click,this))}},this))},_click:function(b){var a=$(b.currentTarget);b.preventDefault();if(a.data("confirmMessage")){WCF.System.Confirmation.show(a.data("confirmMessage"),$.proxy(this._execute,this),{target:a})}else{WCF.LoadingOverlayHandler.updateIcon(a);this._sendRequest(a)}},_execute:function(b,a){if(b==="cancel"){return}WCF.LoadingOverlayHandler.updateIcon(a.target);this._sendRequest(a.target)},_sendRequest:function(a){this.proxy.setOption("data",{actionName:"toggle",className:this._className,interfaceName:"wcf\\data\\IToggleAction",objectIDs:[$(a).data("objectID")]});this.proxy.sendRequest()},_success:function(b,c,a){this.triggerEffect(b.objectIDs)},triggerEffect:function(b){for(var a in this._containers){var d=$("#"+this._containers[a]);var c=d.find(this._buttonSelector);if(WCF.inArray(c.data("objectID"),b)){d.wcfHighlight();this._toggleButton(d,c)}}},_toggleButton:function(b,a){WCF.LoadingOverlayHandler.updateIcon(a,false);if(a.hasClass("icon-check-empty")){a.removeClass("icon-check-empty").addClass("icon-check");$newTitle=(a.data("disableTitle")?a.data("disableTitle"):WCF.Language.get("wcf.global.button.disable"));a.attr("title",$newTitle)}else{a.removeClass("icon-check").addClass("icon-check-empty");$newTitle=(a.data("enableTitle")?a.data("enableTitle"):WCF.Language.get("wcf.global.button.enable"));a.attr("title",$newTitle)}b.toggleClass("disabled")}});WCF.Action.Scroll=Class.extend({_callback:null,_reference:null,_target:null,_threshold:0,init:function(b,d,a,c){this._threshold=parseInt(b);if(this._threshold===0){console.debug("[WCF.Action.Scroll] Given threshold is invalid, aborting.");return}if($.isFunction(d)){this._callback=d}if(this._callback===null){console.debug("[WCF.Action.Scroll] Given callback is invalid, aborting.");return}this._reference=$((a)?a:window);this._target=$((c)?c:document);this.start();this._scroll()},_scroll:function(){var a=this._target.height();var b=this._reference.scrollTop();var c=this._reference.height();if((a-(c+b))<this._threshold){this._callback(this)}},start:function(){this._reference.on("scroll",$.proxy(this._scroll,this))},stop:function(){this._reference.off("scroll")}});WCF.Date={};WCF.Date.Picker={_dateFormat:"yy-mm-dd",_timeFormat:"g:ia",init:function(){var a=$.timepicker.log;$.timepicker.log=function(b){if(b.indexOf("Error parsing the date/time string: Unexpected literal at position")==-1){a(b)}};this._convertDateFormat();this._initDatePicker();WCF.DOMNodeInsertedHandler.addCallback("WCF.Date.Picker",$.proxy(this._initDatePicker,this))},_convertDateFormat:function(){var a={a:" tt",A:" TT",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"l",d:"dd",D:"D",j:"d",l:"DD",z:"o",S:"",F:"MM",m:"mm",M:"M",n:"m",o:"yy",Y:"yy",y:"y",U:"@"};this._dateFormat=WCF.Language.get("wcf.date.dateFormat").replace(/([^dDjlzSFmMnoYyU\\]*(?:\\.[^dDjlzSFmMnoYyU\\]*)*)([dDjlzSFmMnoYyU])/g,function(c,f,e,g,b){for(var d in a){if(e==d){e=a[d]}}return f+e});this._timeFormat=WCF.Language.get("wcf.date.timeFormat").replace(/([^aAgGhHisu\\]*(?:\\.[^aAgGhHisu\\]*)*)([aAgGhHisu])/g,function(c,f,e,g,b){for(var d in a){if(e==d){e=a[d]}}return f+e})},_initDatePicker:function(){$("input[type=date]:not(.jsDatePicker)").each($.proxy(function(c,b){var e=$(b);var a=e.prop("name");var d=e.val();e.prop("type","text").addClass("jsDatePicker");if(e.data("placeholder")){e.attr("placeholder",e.data("placeholder"))}e.removeAttr("name");e.before('<input type="hidden" id="'+e.wcfIdentify()+'DatePicker" name="'+a+'" value="'+d+'" />');e.datepicker({altField:"#"+e.wcfIdentify()+"DatePicker",altFormat:"yy-mm-dd",beforeShow:function(g,f){setTimeout(function(){f.dpDiv.position({my:"left top",at:"left bottom",collision:"none",of:g})},1)},changeMonth:true,changeYear:true,dateFormat:this._dateFormat,dayNames:WCF.Language.get("__days"),dayNamesMin:WCF.Language.get("__daysShort"),dayNamesShort:WCF.Language.get("__daysShort"),monthNames:WCF.Language.get("__months"),monthNamesShort:WCF.Language.get("__monthsShort"),showOtherMonths:true,yearRange:(e.hasClass("birthday")?"-100:+0":"1900:2038"),onClose:function(g,f){if(g==""){$(f.settings.altField).val(g)}}});if(d){e.datepicker("setDate",new Date(d))}e.datepicker("widget").hide()},this));$("input[type=datetime]:not(.jsDatePicker)").each($.proxy(function(c,b){var e=$(b);var a=e.prop("name");var d=e.val();if(/[0-9]{2}:[0-9]{2}:[0-9]{2}$/.test(d)){d=d.replace(/:[0-9]{2}$/,"");e.val(d)}e.prop("type","text").addClass("jsDatePicker");e.removeAttr("name");e.before('<input type="hidden" id="'+e.wcfIdentify()+'DatePicker" name="'+a+'" value="'+d+'" />');e.datetimepicker({altField:"#"+e.wcfIdentify()+"DatePicker",altFieldTimeOnly:false,altFormat:"yy-mm-dd",altTimeFormat:"HH:mm",beforeShow:function(g,f){setTimeout(function(){f.dpDiv.position({my:"left top",at:"left bottom",collision:"none",of:g})},1)},changeMonth:true,changeYear:true,controlType:"select",dateFormat:this._dateFormat,dayNames:WCF.Language.get("__days"),dayNamesMin:WCF.Language.get("__daysShort"),dayNamesShort:WCF.Language.get("__daysShort"),hourText:WCF.Language.get("wcf.date.hour"),minuteText:WCF.Language.get("wcf.date.minute"),monthNames:WCF.Language.get("__months"),monthNamesShort:WCF.Language.get("__monthsShort"),showButtonPanel:false,showTime:false,showOtherMonths:true,timeFormat:this._timeFormat,yearRange:(e.hasClass("birthday")?"-100:+0":"1900:2038"),onClose:function(g,f){if(g==""){$(f.settings.altField).val("")}}});if(d){e.removeClass("hasDatepicker").datetimepicker("setDate",new Date(d))}e.datepicker("widget").hide()},this))}};WCF.Date.Util={gmdate:function(a){var b=(a)?a:new Date();return Math.round(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDay(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds())/1000)},getTimezoneDate:function(b,c){var d=new Date(b);var a=d.getTimezoneOffset()*60000;return new Date((b+a+c))}};WCF.Date.Time=Class.extend({_date:0,_elements:null,_offset:null,_timestamp:0,init:function(){this._elements=$("time.datetime");this._offset=null;this._timestamp=0;this._refresh();new WCF.PeriodicalExecuter($.proxy(this._refresh,this),60000);WCF.DOMNodeInsertedHandler.addCallback("WCF.Date.Time",$.proxy(this._domNodeInserted,this))},_domNodeInserted:function(){this._elements=$("time.datetime");this._refresh()},_refresh:function(){this._date=new Date();this._timestamp=(this._date.getTime()-this._date.getMilliseconds())/1000;if(this._offset===null){this._offset=this._timestamp-TIME_NOW}this._elements.each($.proxy(this._refreshElement,this))},_refreshElement:function(i,f){var n=$(f);if(!n.attr("title")){n.attr("title",n.text())}var d=n.data("timestamp")+this._offset;var b=n.data("date");var c=n.data("time");var o=n.data("offset");if(n.data("isFutureDate")){return}if(d>=this._timestamp||this._timestamp<(d+60)){n.text(WCF.Language.get("wcf.date.relative.now"))}else{if(this._timestamp<(d+3540)){var m=Math.max(Math.round((this._timestamp-d)/60),1);n.text(WCF.Language.get("wcf.date.relative.minutes",{minutes:m}))}else{if(this._timestamp<(d+86400)){var k=Math.round((this._timestamp-d)/3600);n.text(WCF.Language.get("wcf.date.relative.hours",{hours:k}))}else{if(this._timestamp<(d+518400)){var j=new Date(this._date.getFullYear(),this._date.getMonth(),this._date.getDate());var l=Math.ceil((j/1000-d)/86400);var g=WCF.Date.Util.getTimezoneDate((d*1000),o*1000);var h=g.getDay();var e=WCF.Language.get("__days")[h];n.text(WCF.Language.get("wcf.date.relative.pastDays",{days:l,day:e,time:c}))}else{var a=WCF.Language.get("wcf.date.shortDateTimeFormat");n.text(a.replace(/\%date\%/,b).replace(/\%time\%/,c))}}}}}});WCF.Dictionary=Class.extend({_variables:{},init:function(){this._variables={}},add:function(a,b){this._variables[a]=b},addObject:function(a){for(var b in a){this.add(b,a[b])}},addDictionary:function(a){a.each($.proxy(function(b){this.add(b.key,b.value)},this))},get:function(a){if(this.isset(a)){return this._variables[a]}return null},isset:function(a){return this._variables.hasOwnProperty(a)},remove:function(a){delete this._variables[a]},each:function(d){if(!$.isFunction(d)){return}for(var c in this._variables){var a=this._variables[c];var b={key:c,value:a};d(b)}},count:function(){return $.getLength(this._variables)},isEmpty:function(){return !this.count()}});WCF.Language={_variables:new WCF.Dictionary(),add:function(a,b){this._variables.add(a,b)},addObject:function(a){this._variables.addObject(a)},get:function(a,b){if(b==null){var b={}}var c=this._variables.get(a);if(c===null){return a}else{if(typeof c==="string"){this.add(a,new WCF.Template(c));return this.get(a,b)}else{if(typeof c.fetch==="function"){c=c.fetch(b)}}}return c}};WCF.MultipleLanguageInput=Class.extend({_availableLanguages:{},_button:null,_didInit:false,_element:null,_insertedDataAfterInit:false,_isEnabled:false,_forceSelection:false,_languageID:0,_list:null,_values:null,init:function(c,b,d,f){this._button=null;this._element=$("#"+$.wcfEscapeID(c));this._forceSelection=b;this._values=d;this._availableLanguages=f;if($.getLength(this._values)){for(var e in this._values){this._values[e]=WCF.String.unescapeHTML(this._values[e])}}this._languageID=LANGUAGE_ID;if(this._element.length==0){console.debug("[WCF.MultipleLanguageInput] element id '"+c+"' is unknown");return}var a=($.getLength(this._values)>0)?true:false;this._insertedDataAfterInit=a;this._prepareElement(a);this._element.parents("form").submit($.proxy(this._submit,this));this._didInit=true},_prepareElement:function(a){this._element.wrap('<div class="dropdown preInput" />');var c=this._element.parent();this._button=$('<p class="button dropdownToggle"><span>'+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></p>").prependTo(c);this._list=$('<ul class="dropdownMenu"></ul>').insertAfter(this._button);if(this._button.nextAll("textarea").length){this._button.addClass("dropdownCaptionTextarea")}else{this._button.addClass("dropdownCaption")}for(var b in this._availableLanguages){$("<li><span>"+this._availableLanguages[b]+"</span></li>").data("languageID",b).click($.proxy(this._changeLanguage,this)).appendTo(this._list)}if(!this._forceSelection){$('<li class="dropdownDivider" />').appendTo(this._list);$("<li><span>"+WCF.Language.get("wcf.global.button.disabledI18n")+"</span></li>").click($.proxy(this._disable,this)).appendTo(this._list)}WCF.Dropdown.initDropdown(this._button,a);if(a||this._forceSelection){this._isEnabled=true;this._list.children("li").each($.proxy(function(d,f){var e=$(f);if(e.data("languageID")==this._languageID){e.trigger("click")}},this))}WCF.Dropdown.registerCallback(c.wcfIdentify(),$.proxy(this._handleAction,this))},_handleAction:function(a,b){if(b==="open"){this._enable()}else{this._closeSelection()}},_enable:function(a){if(!this._isEnabled){var b=(this._button.is("p"))?this._button.children("span:eq(0)"):this._button;b.addClass("active");this._isEnabled=true}if(this._list.is(":visible")){this._showSelection()}},_showSelection:function(){if(this._isEnabled){this._list.children("li").each($.proxy(function(b,d){var c=$(d);var a=c.data("languageID");if(a){if(this._values[a]&&this._values[a]!=""){c.removeClass("missingValue")}else{c.addClass("missingValue")}}},this))}},_closeSelection:function(){this._disable()},_changeLanguage:function(a){var b=$(a.currentTarget);this._insertedDataAfterInit=true;if(this._didInit){this._values[this._languageID]=this._element.val()}this._languageID=b.data("languageID");if(this._values[this._languageID]){this._element.val(this._values[this._languageID])}else{this._element.val("")}this._list.children("li").removeClass("active");b.addClass("active");this._button.children("span").addClass("active").text(this._availableLanguages[this._languageID]);if(this._didInit){this._element.blur().focus()}},_disable:function(a){if(a===undefined&&this._insertedDataAfterInit){a=null}if(this._forceSelection||!this._list||a===null){return}this._button.children("span").removeClass("active").text(WCF.Language.get("wcf.global.button.disabledI18n"));if(this._values[LANGUAGE_ID]){this._element.val(this._values[LANGUAGE_ID])}else{this._element.val()}this._element.blur();this._insertedDataAfterInit=false;this._isEnabled=false;this._values={}},_submit:function(){if(!this._isEnabled){return 3735928559}if(this._languageID){this._values[this._languageID]=this._element.val()}var b=$(this._element.parents("form")[0]);var c=this._element.wcfIdentify();for(var a in this._availableLanguages){if(this._values[a]===undefined){this._values[a]=""}$('<input type="hidden" name="'+c+"_i18n["+a+']" value="'+WCF.String.escapeHTML(this._values[a])+'" />').appendTo(b)}this._element.removeAttr("name")}});WCF.Number={round:function(b,a){a=Math.pow(10,(a||0));return Math.round(b*a)/a}};WCF.String={addThousandsSeparator:function(a){return String(a).replace(/(^-?\d{1,3}|\d{3})(?=(?:\d{3})+(?:$|\.))/g,"$1"+WCF.Language.get("wcf.global.thousandsSeparator"))},escapeHTML:function(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},escapeRegExp:function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},formatNumeric:function(b,a){b=String(WCF.Number.round(b,a||2));b=b.replace(".",WCF.Language.get("wcf.global.decimalPoint"));b=this.addThousandsSeparator(b);b=b.replace("-","\u2212");return b},lcfirst:function(a){return String(a).substring(0,1).toLowerCase()+a.substring(1)},ucfirst:function(a){return String(a).substring(0,1).toUpperCase()+a.substring(1)},unescapeHTML:function(a){return String(a).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}};WCF.TabMenu={_containers:{},_didInit:false,init:function(){var b=$(".tabMenuContainer");var a=this;b.each(function(d,c){var f=$(c);var e=f.wcfIdentify();if(a._containers[e]){return true}if(f.data("store")&&!$("#"+f.data("store")).length){$('<input type="hidden" name="'+f.data("store")+'" value="" id="'+f.data("store")+'" />').appendTo(f.parents("form").find(".formSubmit"))}a._containers[e]=f;f.wcfTabs({active:false,activate:function(h,g){var j=$(g.newPanel);var i=j.closest(".tabMenuContainer");var k=i;while(true){if(k.data("isParent")===undefined){break}if(k.data("isParent")){if(k.data("store")){$("#"+k.data("store")).val(j.attr("id"))}break}else{k=k.data("parent")}}if(WCF.TabMenu._didInit){if(window.history){window.history.pushState(null,document.title,window.location.toString().replace(/#.+$/,"")+"#"+j.attr("id"))}else{location.hash="#"+j.attr("id")}}}});f.data("isParent",(f.children(".tabMenuContainer, .tabMenuContent").length>0)).data("parent",false);if(!f.data("isParent")){if(f.parent().hasClass("tabMenuContainer")){f.data("parent",f.parent())}}});if(!this._didInit){this._selectActiveTab();$(window).bind("hashchange",$.proxy(this.selectTabs,this));if(!this._selectErroneousTab()){this.selectTabs()}}this._didInit=true},reload:function(){this._containers={};this.init()},_selectErroneousTab:function(){for(var a in this._containers){var b=this._containers[a];if(!b.data("isParent")&&b.find(".formError").length){while(true){if(b.data("parent")===false){break}b=b.data("parent").wcfTabs("selectTab",b.wcfIdentify())}return true}}return false},_selectActiveTab:function(){for(var b in this._containers){var e=this._containers[b];if(e.data("active")){var a=e.data("active");var d=null;if(/-/.test(a)){var c=a.split("-");a=c[0];d=c[1]}e.find(".tabMenuContent").each(function(h,g){var f=$(g);if(f.wcfIdentify()==a){e.wcfTabs("select",h);if(d!==null){if(f.hasClass("tabMenuContainer")){f.wcfTabs("selectTab",e.data("active"))}else{e.wcfTabs("selectTab",e.data("active"))}}return false}})}}},selectTabs:function(){if(location.hash){var a=location.hash.substr(1);var b=$("#"+$.wcfEscapeID(a));if(b.length===1&&b.hasClass("ui-tabs-panel")){b=b.parent(".ui-tabs");if(b.length){b.wcfTabs("selectTab",a);if(b.hasClass("ui-tabs-panel")){a=b.wcfIdentify();b=b.parent(".ui-tabs");if(b.length){b.wcfTabs("selectTab",a)}}return true}}}return false}};WCF.Template=Class.extend({init:function(d){var f=new WCF.Dictionary();var a=0;d=d.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/(\r\n|\n|\r)/g,"\\n");d=d.replace(/\{literal\}(.*?)\{\/literal\}/g,$.proxy(function(e){var i="@@@@@@@@@@@"+Math.random()+"@@@@@@@@@@@";f.add(i,e.replace(/\{\/?literal\}/g,""));return i},this));d=d.replace(/\{\*.*?\*\}/g,"");var c=function(q){var l=q.split("");var i={};var k=true;var s="";var o="";var m=false;var n=false;var j=false;for(var p=0,e=l.length;p<e;p++){var r=l[p];if(k&&r!="="&&r!=" "){s+=r}else{if(k&&r=="="){k=false;n=false;m=false;j=false}else{if(!k&&!n&&!m&&r==" "){k=true;i[s]=o;o=s=""}else{if(!k&&n&&!j&&r=="'"){n=false;o+=r}else{if(!k&&!n&&!m&&r=="'"){n=true;o+=r}else{if(!k&&m&&!j&&r=='"'){m=false;o+=r}else{if(!k&&!n&&!m&&r=='"'){m=true;o+=r}else{if(!k&&(m||n)&&!j&&r=="\\"){j=true;o+=r}else{if(!k){j=false;o+=r}}}}}}}}}}i[s]=o;if(m||n||j){throw new Error('Syntax error in parameterList: "'+q+'"')}return i};var h=function(e){return e.replace(/\\n/g,"\n").replace(/\\\\/g,"\\").replace(/\\'/g,"'")};d=d.replace(/\{(\$[^\}]+?)\}/g,function(e,i){i=h(i.replace(/\$([^.\[\s]+)/g,"(v['$1'])"));return"' + WCF.String.escapeHTML("+i+") + '"}).replace(/\{#(\$[^\}]+?)\}/g,function(e,i){i=h(i.replace(/\$([^.\[\s]+)/g,"(v['$1'])"));return"' + WCF.String.formatNumeric("+i+") + '"}).replace(/\{@(\$[^\}]+?)\}/g,function(e,i){i=h(i.replace(/\$([^.\[\s]+)/g,"(v['$1'])"));return"' + "+i+" + '"}).replace(/\{if (.+?)\}/g,function(e,i){i=h(i.replace(/\$([^.\[\s]+)/g,"(v['$1'])"));return"';\nif ("+i+") {\n	$output += '"}).replace(/\{else ?if (.+?)\}/g,function(e,i){i=h(i.replace(/\$([^.\[\s]+)/g,"(v['$1'])"));return"';\n}\nelse if ("+i+") {\n	$output += '"}).replace(/\{implode (.+?)\}/g,function(e,j){a++;j=j.replace(/\\\\/g,"\\").replace(/\\'/g,"'");var i=c(j);if(typeof i.from==="undefined"){throw new Error("Missing from attribute in implode-tag")}if(typeof i.item==="undefined"){throw new Error("Missing item attribute in implode-tag")}if(typeof i.glue==="undefined"){i.glue="', '"}i.from=i.from.replace(/\$([^.\[\s]+)/g,"(v.$1)");return"';\nvar $implode_"+a+" = false;\nfor ($implodeKey_"+a+" in "+i.from+") {\n	v["+i.item+"] = "+i.from+"[$implodeKey_"+a+"];\n"+(typeof i.key!=="undefined"?"		v["+i.key+"] = $implodeKey_"+a+";\n":"")+"	if ($implode_"+a+") $output += "+i.glue+";\n	$implode_"+a+" = true;\n	$output += '"}).replace(/\{foreach (.+?)\}/g,function(e,j){a++;j=j.replace(/\\\\/g,"\\").replace(/\\'/g,"'");var i=c(j);if(typeof i.from==="undefined"){throw new Error("Missing from attribute in foreach-tag")}if(typeof i.item==="undefined"){throw new Error("Missing item attribute in foreach-tag")}i.from=i.from.replace(/\$([^.\[\s]+)/g,"(v.$1)");return"';\n$foreach_"+a+" = false;\nfor ($foreachKey_"+a+" in "+i.from+") {\n	$foreach_"+a+" = true;\n	break;\n}\nif ($foreach_"+a+") {\n	for ($foreachKey_"+a+" in "+i.from+") {\n		v["+i.item+"] = "+i.from+"[$foreachKey_"+a+"];\n"+(typeof i.key!=="undefined"?"		v["+i.key+"] = $foreachKey_"+a+";\n":"")+"		$output += '"}).replace(/\{foreachelse\}/g,"';\n	}\n}\nelse {\n	{\n		$output += '").replace(/\{\/foreach\}/g,"';\n	}\n}\n$output += '").replace(/\{else\}/g,"';\n}\nelse {\n	$output += '").replace(/\{\/(if|implode)\}/g,"';\n}\n$output += '");for(var b in WCF.Template.callbacks){d=WCF.Template.callbacks[b](d)}d=d.replace("{ldelim}","{").replace("{rdelim}","}");f.each(function(e){d=d.replace(e.key,e.value)});d="$output += '"+d+"';";try{this.fetch=new Function("v","if (typeof v != 'object') { v = {}; } v.__window = window; v.__wcf = window.WCF; var $output = ''; "+d+" return $output;")}catch(g){console.debug("var $output = ''; "+d+" return $output;");throw g}},fetch:function(a){}});WCF.Template.callbacks=[];WCF.ToggleOptions=Class.extend({_element:null,_showItems:[],_hideItems:[],_callback:null,init:function(c,a,b,d){this._element=$("#"+c);this._showItems=a;this._hideItems=b;if(d!==undefined){this._callback=d}this._element.click($.proxy(this._toggle,this));this._toggle()},_toggle:function(){if(!this._element.prop("checked")){return}for(var c=0,b=this._showItems.length;c<b;c++){var a=this._showItems[c];$("#"+a).show()}for(var c=0,b=this._hideItems.length;c<b;c++){var a=this._hideItems[c];$("#"+a).hide()}if(this._callback!==null){this._callback()}}});WCF.Collapsible={};WCF.Collapsible.Simple={init:function(){$(".jsCollapsible").each($.proxy(function(a,b){this._initButton(b)},this))},_initButton:function(a){var c=$(a);var b=c.data("isOpen");if(!b){$("#"+c.data("collapsibleContainer")).hide()}c.click($.proxy(this._toggle,this))},_toggle:function(b){var d=$(b.currentTarget);var c=d.data("isOpen");var a=$("#"+$.wcfEscapeID(d.data("collapsibleContainer")));if(c){a.stop().wcfBlindOut("vertical",$.proxy(function(){this._toggleImage(d)},this));c=false}else{a.stop().wcfBlindIn("vertical",$.proxy(function(){this._toggleImage(d)},this));c=true}d.data("isOpen",c);b.stopPropagation();return false},_toggleImage:function(b){var a=b.find("span.icon");if(b.data("isOpen")){a.removeClass("icon-chevron-right").addClass("icon-chevron-down")}else{a.removeClass("icon-chevron-down").addClass("icon-chevron-right")}}};WCF.Collapsible.Remote=Class.extend({_className:"",_containers:{},_containerData:{},_proxy:null,init:function(a){this._className=a;this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._init();WCF.DOMNodeInsertedHandler.addCallback("WCF.Collapsible.Remote",$.proxy(this._init,this))},_init:function(a){this._getContainers().each($.proxy(function(c,b){var e=$(b);var d=e.wcfIdentify();if(this._containers[d]===undefined){this._containers[d]=e;this._initContainer(d)}},this))},_initContainer:function(b){var a=this._getTarget(b);var c=this._getButtonContainer(b);var d=this._createButton(b,c);this._containerData[b]={button:d,buttonContainer:c,isOpen:this._containers[b].data("isOpen"),target:a};if(!this._containers[b].data("isOpen")){$("#"+b).addClass("jsCollapsed")}},_getContainers:function(){},_getTarget:function(a){},_getButtonContainer:function(a){},_createButton:function(a,b){var d=this._containers[a].data("isOpen");var c=$('<span class="collapsibleButton jsTooltip pointer icon icon16 icon-'+(d?"chevron-down":"chevron-right")+'" title="'+WCF.Language.get("wcf.global.button.collapsible")+'">').prependTo(b);c.data("containerID",a).click($.proxy(this._toggleContainer,this));return c},_toggleContainer:function(d){var f=$(d.currentTarget);var b=f.data("containerID");var e=this._containerData[b].isOpen;var a=(e)?"open":"close";var c=(e)?"close":"open";this._proxy.setOption("data",{actionName:"loadContainer",className:this._className,interfaceName:"wcf\\data\\ILoadableContainerAction",objectIDs:[this._getObjectID(b)],parameters:$.extend(true,{containerID:b,currentState:a,newState:c},this._getAdditionalParameters(b))});this._proxy.sendRequest();$("#"+b).toggleClass("jsCollapsed")},_exchangeIcon:function(b,a){a=a||"spinner";b.removeClass("icon-chevron-down icon-chevron-right icon-spinner").addClass("icon-"+a)},_getObjectID:function(a){return $("#"+a).data("objectID")},_getAdditionalParameters:function(a){return{}},_updateContent:function(a,b,c){this._containerData[a].target.html(b)},_success:function(d,e,c){if(!d.returnValues.containerID){return}var a=d.returnValues.containerID;if(!this._containers[a]){return}this._containerData[a].isOpen=(d.returnValues.isOpen)?true:false;var b=(d.returnValues.isOpen)?"open":"close";this._updateContent(a,$.trim(d.returnValues.content),b);this._exchangeIcon(this._containerData[a].button,(d.returnValues.isOpen?"chevron-down":"chevron-right"))}});WCF.Collapsible.SimpleRemote=WCF.Collapsible.Remote.extend({init:function(a){this._super(a);this._proxy=new WCF.Action.Proxy({showLoadingOverlay:false})},_initContainer:function(a){this._super(a);if(!this._containerData[a].isOpen){this._containerData[a].target.hide();this._exchangeIcon(this._containerData[a].button,"chevron-right")}},_toggleContainer:function(d){var f=$(d.currentTarget);var b=f.data("containerID");var e=this._containerData[b].isOpen;var a=(e)?"open":"close";var c=(e)?"close":"open";this._proxy.setOption("data",{actionName:"toggleContainer",className:this._className,interfaceName:"wcf\\data\\IToggleContainerAction",objectIDs:[this._getObjectID(b)],parameters:$.extend(true,{containerID:b,currentState:a,newState:c},this._getAdditionalParameters(b))});this._proxy.sendRequest();this._exchangeIcon(this._containerData[b].button,(c==="open"?"chevron-down":"chevron-right"));if(c==="open"){this._containerData[b].target.show()}else{this._containerData[b].target.hide()}$("#"+b).toggleClass("jsCollapsed");this._containerData[b].isOpen=(c==="open"?true:false)}});WCF.Collapsible.Sidebar=Class.extend({_button:null,_buttonHeight:0,_isOpen:false,_mainContainer:null,_proxy:null,_sidebar:null,_sidebarHeight:0,_sidebarName:"",_sidebarOffset:0,_userPanelHeight:0,init:function(){this._sidebar=$(".sidebar:eq(0)");if(!this._sidebar.length){console.debug("[WCF.Collapsible.Sidebar] Could not find sidebar, aborting.");return}this._isOpen=(this._sidebar.data("isOpen"))?true:false;this._sidebarName=this._sidebar.data("sidebarName");this._mainContainer=$("#main");this._sidebarHeight=this._sidebar.height();this._sidebarOffset=this._sidebar.getOffsets("offset").top;this._userPanelHeight=$("#topMenu").outerHeight();this._button=$('<a class="collapsibleButton jsTooltip" title="'+WCF.Language.get("wcf.global.button.collapsible")+'" />').prependTo(this._sidebar);this._button.wrap("<span />");this._button.click($.proxy(this._click,this));this._buttonHeight=this._button.outerHeight();WCF.DOMNodeInsertedHandler.execute();this._proxy=new WCF.Action.Proxy({showLoadingOverlay:false,url:"index.php/AJAXInvoke/?t="+SECURITY_TOKEN+SID_ARG_2ND});$(document).scroll($.proxy(this._scroll,this)).resize($.proxy(this._scroll,this));this._renderSidebar();this._scroll()},_click:function(){this._isOpen=(this._isOpen)?false:true;this._proxy.setOption("data",{actionName:"toggle",className:"wcf\\system\\user\\collapsible\\content\\UserCollapsibleSidebarHandler",isOpen:(this._isOpen?1:0),sidebarName:this._sidebarName});this._proxy.sendRequest();this._renderSidebar()},_scroll:function(){var e=$(window);var b=e.scrollTop();var a=Math.max(b-this._sidebarOffset,0);var c=Math.min(this._mainContainer.height(),(e.height()+b)-this._sidebarOffset);var f=0;if(c===a){f=this._sidebarOffset+this._sidebarHeight}else{f=a+((c-a)/2);var d=Math.max(Math.min(a-this._userPanelHeight,this._userPanelHeight),0);if(d>0){f+=(d/2)}}if((c-a-this._userPanelHeight)<this._buttonHeight){f=f-this._buttonHeight}else{f=Math.max(f-(this._buttonHeight/2),0)}this._button.css({top:f+"px"})},_renderSidebar:function(){if(this._isOpen){$(".sidebarOrientationLeft, .sidebarOrientationRight").removeClass("sidebarCollapsed")}else{$(".sidebarOrientationLeft, .sidebarOrientationRight").addClass("sidebarCollapsed")}this._scroll()}});WCF.User={userID:0,username:"",init:function(a,b){this.userID=a;this.username=b}};WCF.Effect={};WCF.Effect.Scroll=Class.extend({scrollTo:function(c,a,b){if(!c.length){return true}var d=c.getOffsets("offset").top;var f=$(document).height();var e=$(window).height();if(d>f-e){d=f-e;if(d<0){d=0}}if(b===true){$("html,body").scrollTop(d)}else{$("html,body").animate({scrollTop:d},400,function(h,i,g,k,j){return -k*((i=i/j-1)*i*i*i-1)+g})}return false}});WCF.Effect.SmoothScroll=WCF.Effect.Scroll.extend({init:function(){var a=this;$(document).on("click","a[href$=#top],a[href$=#bottom]",function(){var b=$(this.hash);a.scrollTo(b,true);return false})}});WCF.Effect.BalloonTooltip=Class.extend({_didInit:false,_tooltip:null,_viewportDimensions:{},init:function(){if(jQuery.browser.mobile){return}if(!this._didInit){this._tooltip=$('<div id="balloonTooltip" class="balloonTooltip"><span id="balloonTooltipText"></span><span class="pointer"><span></span></span></div>').appendTo($("body")).hide();this._updateViewportDimensions();$(window).resize($.proxy(this._updateViewportDimensions,this));WCF.DOMNodeInsertedHandler.addCallback("WCF.Effect.BalloonTooltip",$.proxy(this.init,this));this._didInit=true}$(".jsTooltip").each($.proxy(this._initTooltip,this))},_updateViewportDimensions:function(){this._viewportDimensions=$(document).getDimensions()},_initTooltip:function(b,c){var a=$(c);if(a.hasClass("jsTooltip")){a.removeClass("jsTooltip");var d=a.attr("title");if(d!==""){a.data("tooltip",d);a.removeAttr("title");a.hover($.proxy(this._mouseEnterHandler,this),$.proxy(this._mouseLeaveHandler,this));a.click($.proxy(this._mouseLeaveHandler,this))}}},_mouseEnterHandler:function(c){var n=$(c.currentTarget);var j=n.attr("title");if(j&&j!==""){n.data("tooltip",j);n.removeAttr("title")}this._tooltip.css({top:"0px",left:"0px"});if(!n.data("tooltip")){this._tooltip.hide();return}this._tooltip.children("span:eq(0)").text(n.data("tooltip"));var l=this._tooltip.find(".pointer");this._tooltip.show();var b=l.outerWidth();this._tooltip.hide();var f=n.getOffsets("offset");var k=n.getDimensions("outer");var m=this._tooltip.getDimensions("outer");var a=this._tooltip.getDimensions("inner");var h=f.left+Math.ceil(k.width/2);var i=Math.ceil(m.width/2);var g="center";if((h-i)<5){g="left"}else{if((this._viewportDimensions.width-5)<(h+i)){g="right"}}if(f.top+k.height+m.height-$(document).scrollTop()<$(window).height()){var e=f.top+k.height+7;this._tooltip.removeClass("inverse");l.css("top",-5)}else{var e=f.top-m.height-7;this._tooltip.addClass("inverse");l.css("top",m.height)}switch(g){case"center":var d=Math.round(f.left-i+(k.width/2));l.css({left:(a.width/2-b/2)+"px"});break;case"left":var d=f.left;l.css({left:"5px"});break;case"right":var d=f.left+k.width-m.width;l.css({left:(a.width-b-5)+"px"});break}this._tooltip.css({top:e+"px",left:d+"px"});this._tooltip.wcfFadeIn()},_mouseLeaveHandler:function(a){this._tooltip.stop().hide().css({opacity:1})}});WCF.CloseOverlayHandler={_callbacks:new WCF.Dictionary(),_isListening:false,addCallback:function(a,b){this._bindListener();if(this._callbacks.isset(a)){console.debug("[WCF.CloseOverlayHandler] identifier '"+a+"' is already bound to a callback");return false}this._callbacks.add(a,b)},removeCallback:function(a){if(this._callbacks.isset(a)){this._callbacks.remove(a)}},_bindListener:function(){if(this._isListening){return}$("body").click($.proxy(this._executeCallbacks,this));this._isListening=true},_executeCallbacks:function(a){this._callbacks.each(function(b){b.value()})}};WCF.DOMNodeInsertedHandler={_callbacks:[],_isExecuting:false,addCallback:function(a,b){this._callbacks.push(b)},_executeCallbacks:function(){if(this._isExecuting){return}this._isExecuting=true;for(var b=0,a=this._callbacks.length;b<a;b++){this._callbacks[b]()}this._isExecuting=false},execute:function(){this._executeCallbacks()}};WCF.DOMNodeRemovedHandler={_callbacks:new WCF.Dictionary(),_isExecuting:false,_isListening:false,addCallback:function(a,b){this._bindListener();if(this._callbacks.isset(a)){console.debug("[WCF.DOMNodeRemovedHandler] identifier '"+a+"' is already bound to a callback");return false}this._callbacks.add(a,b)},removeCallback:function(a){if(this._callbacks.isset(a)){this._callbacks.remove(a)}},_bindListener:function(){if(this._isListening){return}$(document).bind("DOMNodeRemoved",$.proxy(this._executeCallbacks,this));this._isListening=true},_executeCallbacks:function(a){if(this._isExecuting){return}this._isExecuting=true;this._callbacks.each(function(b){b.value(a)});this._isExecuting=false}};WCF.Table={};WCF.Table.EmptyTableHandler=Class.extend({_options:{},_rowClassName:"",init:function(b,c,a){this._rowClassName=c;this._tableContainer=b;this._options=$.extend(true,{emptyMessage:null,messageType:"info",refreshPage:false,updatePageNumber:false},a||{});WCF.DOMNodeRemovedHandler.addCallback("WCF.Table.EmptyTableHandler."+c,$.proxy(this._remove,this))},_remove:function(e){var d=$(e.target);if(d.hasClass(this._rowClassName)){var c=d.parents("tbody:eq(0)");if(c.children("tr").length==1){if(this._options.emptyMessage){this._tableContainer.replaceWith($("<p />").addClass(this._options.messageType).text(this._options.emptyMessage))}else{if(this._options.refreshPage){if(this._options.updatePageNumber){var a=window.location.href.match(/(\?|&)pageNo=(\d+)/g);if(a){var b=a[a.length-1].match(/\d+/g);if(this._options.updatePageNumber>0){b++}else{b--}window.location=window.location.href.replace(a[a.length-1],a[a.length-1][0]+"pageNo="+b)}}else{window.location.reload()}}else{this._tableContainer.remove()}}}}}});WCF.Search={};WCF.Search.Base=Class.extend({_callback:null,_className:"",_commaSeperated:false,_excludedSearchValues:[],_itemCount:0,_itemIndex:-1,_list:null,_oldSearchString:[],_proxy:null,_searchInput:null,_triggerLength:3,init:function(b,e,a,c,d){if(e!==null&&e!==undefined&&!$.isFunction(e)){console.debug("[WCF.Search.Base] The given callback is invalid, aborting.");return}this._callback=(e)?e:null;this._excludedSearchValues=[];if(a){this._excludedSearchValues=a}this._searchInput=$(b);if(!this._searchInput.length){console.debug("[WCF.Search.Base] Selector '"+b+"' for search input is invalid, aborting.");return}this._searchInput.keydown($.proxy(this._keyDown,this)).keyup($.proxy(this._keyUp,this)).wrap('<span class="dropdown" />');this._list=$('<ul class="dropdownMenu" />').insertAfter(this._searchInput);this._commaSeperated=(c)?true:false;this._oldSearchString=[];this._itemCount=0;this._itemIndex=-1;this._proxy=new WCF.Action.Proxy({showLoadingOverlay:(d!==true?false:true),success:$.proxy(this._success,this),autoAbortPrevious:true});if(this._searchInput.is("input")){this._searchInput.attr("autocomplete","off")}this._searchInput.blur($.proxy(this._blur,this));WCF.Dropdown.initDropdownFragment(this._searchInput.parent(),this._list)},_blur:function(){var a=this;new WCF.PeriodicalExecuter(function(b){if(a._list.is(":visible")){a._clearList(false)}b.stop()},250)},_keyDown:function(a){if(a.which===$.ui.keyCode.ENTER){var b=this._searchInput.parents(".dropdown");if(b.data("disableAutoFocus")){if(this._itemIndex!==-1){a.preventDefault()}}else{if(b.data("preventSubmit")||this._itemIndex!==-1){a.preventDefault()}}}},_keyUp:function(c){switch(c.which){case 37:case 39:return;break;case 38:this._selectPreviousItem();return;break;case 40:this._selectNextItem();return;break;case 13:return this._selectElement(c);break}var a=this._getSearchString(c);if(a===""){this._clearList(true)}else{if(a.length>=this._triggerLength){var b={data:{excludedSearchValues:this._excludedSearchValues,searchString:a}};this._searchInput.parents(".searchBar").addClass("loading");this._proxy.setOption("data",{actionName:"getSearchResultList",className:this._className,interfaceName:"wcf\\data\\ISearchAction",parameters:this._getParameters(b)});this._proxy.sendRequest()}else{this._clearList(false)}}},_selectNextItem:function(){if(this._itemCount===0){return}this._itemIndex++;if(this._itemIndex===this._itemCount){this._itemIndex=0}this._highlightSelectedElement()},_selectPreviousItem:function(){if(this._itemCount===0){return}this._itemIndex--;if(this._itemIndex===-1){this._itemIndex=this._itemCount-1}this._highlightSelectedElement()},_highlightSelectedElement:function(){this._list.find("li").removeClass("dropdownNavigationItem");this._list.find("li:eq("+this._itemIndex+")").addClass("dropdownNavigationItem")},_selectElement:function(a){if(this._itemCount===0){return true}this._list.find("li.dropdownNavigationItem").trigger("click");return false},_getSearchString:function(d){var a=$.trim(this._searchInput.val());if(this._commaSeperated){var c=d.keyCode||d.which;if(c==188){return""}var b=a.split(",");var e=b.length;for(var g=0;g<e;g++){b[g]=$.trim(b[g])}for(var g=0;g<e;g++){var f=b[g];if(this._oldSearchString[g]){if(f!=this._oldSearchString[g]){a=f;break}}else{a=f;break}}this._oldSearchString=b}return a},_getParameters:function(a){return a},_success:function(d,f,c){this._clearList(false);this._searchInput.parents(".searchBar").removeClass("loading");if($.getLength(d.returnValues)){for(var e in d.returnValues){var a=d.returnValues[e];this._createListItem(a)}}else{if(!this._handleEmptyResult()){return}}WCF.CloseOverlayHandler.addCallback("WCF.Search.Base",$.proxy(function(){this._clearList()},this));var b=this._searchInput.parents(".dropdown").wcfIdentify();if(!WCF.Dropdown.getDropdownMenu(b).hasClass("dropdownOpen")){WCF.Dropdown.toggleDropdown(b)}this._itemIndex=-1;if(!WCF.Dropdown.getDropdown(b).data("disableAutoFocus")){this._selectNextItem()}},_handleEmptyResult:function(){return false},_createListItem:function(b){var a=$("<li><span>"+WCF.String.escapeHTML(b.label)+"</span></li>").appendTo(this._list);a.data("objectID",b.objectID).data("label",b.label).click($.proxy(this._executeCallback,this));this._itemCount++;return a},_executeCallback:function(d){var a=false;var c=$(d.currentTarget);if(this._commaSeperated){var b=c.data("label");for(var h=0,f=this._oldSearchString.length;h<f;h++){var g=this._oldSearchString[h];if(b.toLowerCase().indexOf(g.toLowerCase())===0){this._oldSearchString[h]=b;this._searchInput.val(this._oldSearchString.join(", "));if($.browser.webkit){this._searchInput.css({display:"block"})}var e=this._searchInput.val().toLowerCase().indexOf(b.toLowerCase())+b.length;this._searchInput.focus().setCaret(e);break}}}else{if(this._callback===null){this._searchInput.val(c.data("label"))}else{a=(this._callback(c.data())===true)?true:false}}this._clearList(a)},_clearList:function(a){if(a&&!this._commaSeperated){this._searchInput.val("")}WCF.Dropdown.getDropdown(this._searchInput.parents(".dropdown").wcfIdentify()).removeClass("dropdownOpen");WCF.Dropdown.getDropdownMenu(this._searchInput.parents(".dropdown").wcfIdentify()).removeClass("dropdownOpen");this._list.end().empty();WCF.CloseOverlayHandler.removeCallback("WCF.Search.Base");this._itemCount=0;this._itemIndex=-1},addExcludedSearchValue:function(a){if(!WCF.inArray(a,this._excludedSearchValues)){this._excludedSearchValues.push(a)}},removeExcludedSearchValue:function(b){var a=$.inArray(b,this._excludedSearchValues);if(a!=-1){this._excludedSearchValues.splice(a,1)}}});WCF.Search.User=WCF.Search.Base.extend({_className:"wcf\\data\\user\\UserAction",_includeUserGroups:false,init:function(c,e,a,b,d){this._includeUserGroups=a;this._super(c,e,b,d)},_getParameters:function(a){a.data.includeUserGroups=this._includeUserGroups?1:0;return a},_createListItem:function(e){var d=this._super(e);var b=null;if(e.icon){b=$(e.icon)}else{if(this._includeUserGroups&&e.type==="group"){b=$('<span class="icon icon16 icon-group" />')}}if(b){var a=d.find("span").detach();var c=$("<div />").addClass("box16").appendTo(d);c.append(b);c.append($("<div />").append(a))}d.data("type",e.type);return d}});WCF.System={};WCF.System.MobileNavigation={init:function(){this._convertNavigation();WCF.DOMNodeInsertedHandler.addCallback("WCF.System.MobileNavigation",function(){WCF.System.MobileNavigation._convertNavigation()})},_convertNavigation:function(){$("nav.jsMobileNavigation").removeClass("jsMobileNavigation").each(function(b,a){var c=$(a);$('<a class="invisible" tabindex="9999999" />').click(function(){}).prependTo(c);$('<a class="invisible" tabindex="9999999"><span class="icon icon16 icon-list" />'+(c.data("buttonLabel")!==undefined?(" "+c.data("buttonLabel")):"")+"</a>").click(function(){}).prependTo(c)})}};WCF.System.Notification=Class.extend({_callback:null,_cssClassNames:"",_message:"",_overlay:null,init:function(a,b){this._cssClassNames=b||"success";this._message=a||WCF.Language.get("wcf.global.success");this._overlay=$("#systemNotification");if(!this._overlay.length){this._overlay=$('<div id="systemNotification"><p></p></div>').hide().appendTo(document.body)}},show:function(d,b,a,c){b=parseInt(b);if(!b){b=2000}if(d&&$.isFunction(d)){this._callback=d}this._overlay.children("p").html((a||this._message));this._overlay.children("p").removeClass().addClass((c||this._cssClassNames));new WCF.PeriodicalExecuter($.proxy(this._hide,this),b);this._overlay.wcfFadeIn(undefined,300)},_hide:function(a){if(this._callback!==null){this._callback()}this._overlay.wcfFadeOut(undefined,300);a.stop()}});WCF.System.Confirmation={_callback:null,_dialog:null,_parameters:null,_visible:false,_confirmationButton:null,show:function(c,e,b,a){if(this._visible){console.debug("[WCF.System.Confirmation] Confirmation dialog is already open, refusing action.");return}if(!$.isFunction(e)){console.debug("[WCF.System.Confirmation] Given callback is invalid, aborting.");return}this._callback=e;this._parameters=b;var d=true;if(this._dialog===null){this._createDialog();d=false}this._dialog.find("#wcfSystemConfirmationContent").empty().hide();if(a&&a.length){a.appendTo(this._dialog.find("#wcfSystemConfirmationContent").show())}this._dialog.find("p").text(c);this._dialog.wcfDialog({onClose:$.proxy(this._close,this),onShow:$.proxy(this._show,this),title:WCF.Language.get("wcf.global.confirmation.title")});if(d){this._dialog.wcfDialog("render")}this._confirmationButton.focus();this._visible=true},_createDialog:function(){this._dialog=$('<div id="wcfSystemConfirmation" class="systemConfirmation"><p /><div id="wcfSystemConfirmationContent" /></div>').hide().appendTo(document.body);var a=$('<div class="formSubmit" />').appendTo(this._dialog);this._confirmationButton=$('<button class="buttonPrimary">'+WCF.Language.get("wcf.global.confirmation.confirm")+"</button>").data("action","confirm").click($.proxy(this._click,this)).appendTo(a);$("<button>"+WCF.Language.get("wcf.global.confirmation.cancel")+"</button>").data("action","cancel").click($.proxy(this._click,this)).appendTo(a)},_click:function(a){this._notify($(a.currentTarget).data("action"))},_close:function(){if(this._visible){this._notify("cancel")}},_notify:function(a){this._visible=false;this._dialog.wcfDialog("close");this._callback(a,this._parameters)},_show:function(){this._dialog.find("button.buttonPrimary").blur().focus()}};WCF.System.DisableScrolling={_depth:0,_oldOverflow:null,disable:function(){if($.browser.touch){return}if(this._depth===0){this._oldOverflow=$(document.body).css("overflow");$(document.body).css("overflow","hidden")}this._depth++},enable:function(){if(this._depth===0){return}this._depth--;if(this._depth===0){$(document.body).css("overflow",this._oldOverflow)}}};WCF.System.PageNavigation={_button:null,_description:null,_dialog:null,_elementID:"",_elements:{},_pageNo:null,init:function(a,c){var b=$(a);if(!b.length){return}c=c||null;if(c!==null&&!$.isFunction(c)){console.debug("[WCF.System.PageNavigation] Callback for selector '"+a+"' is invalid, aborting.");return}this._initElements(b,c)},_initElements:function(b,c){var a=this;b.each(function(e,f){var d=$(f);var g=d.wcfIdentify();if(a._elements[g]===undefined){a._elements[g]=d;d.find("li.jumpTo").data("elementID",g).click($.proxy(a._click,a))}}).data("callback",c)},_click:function(b){this._elementID=$(b.currentTarget).data("elementID");if(this._dialog===null){this._dialog=$('<div id="pageNavigationOverlay" />').hide().appendTo(document.body);var c=$("<fieldset><legend>"+WCF.Language.get("wcf.global.page.jumpTo")+"</legend></fieldset>").appendTo(this._dialog);$('<dl><dt><label for="jsPageNavigationPageNo">'+WCF.Language.get("wcf.global.page.jumpTo")+"</label></dt><dd></dd></dl>").appendTo(c);this._pageNo=$('<input type="number" id="jsPageNavigationPageNo" value="1" min="1" max="1" class="tiny" />').keyup($.proxy(this._keyUp,this)).appendTo(c.find("dd"));this._description=$("<small></small>").insertAfter(this._pageNo);var a=$('<div class="formSubmit" />').appendTo(this._dialog);this._button=$('<button class="buttonPrimary">'+WCF.Language.get("wcf.global.button.submit")+"</button>").click($.proxy(this._submit,this)).appendTo(a)}this._button.enable();this._description.html(WCF.Language.get("wcf.global.page.jumpTo.description").replace(/#pages#/,this._elements[this._elementID].data("pages")));this._pageNo.val(this._elements[this._elementID].data("pages")).attr("max",this._elements[this._elementID].data("pages"));this._dialog.wcfDialog({title:WCF.Language.get("wcf.global.page.pageNavigation")})},_keyUp:function(){var a=parseInt(this._pageNo.val())||0;if(a<1||a>this._pageNo.attr("max")){this._button.disable()}else{this._button.enable()}},_submit:function(){var b=this._elements[this._elementID];if(b.data("callback")===null){var a=b.data("link").replace(/pageNo=%d/,"pageNo="+this._pageNo.val());window.location=a}else{b.data("callback")(this._pageNo.val());this._dialog.wcfDialog("close")}}};WCF.System.KeepAlive=Class.extend({init:function(a){new WCF.PeriodicalExecuter(function(b){new WCF.Action.Proxy({autoSend:true,data:{actionName:"keepAlive",className:"wcf\\data\\session\\SessionAction"},failure:function(){b.stop()},showLoadingOverlay:false,suppressErrors:true})},(a*1000))}});WCF.InlineEditor=Class.extend({_callbacks:[],_dropdowns:{},_elements:{},_notification:null,_options:[],_proxy:null,_updateData:[],init:function(d){var c=$(d);if(!c.length){return}this._setOptions();var b="";for(var f=0,e=this._options.length;f<e;f++){if(this._options[f].isQuickOption){b=this._options[f].optionName;break}}var a=this;c.each(function(i,j){var h=$(j);var k=h.wcfIdentify();var g=a._getTriggerElement(h);if(g===null||g.length!==1){return}g.click($.proxy(a._show,a)).data("elementID",k);if(b){g.disableSelection().data("optionName",b).dblclick($.proxy(a._click,a))}a._elements[k]=h});this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});WCF.CloseOverlayHandler.addCallback("WCF.InlineEditor",$.proxy(this._closeAll,this));this._notification=new WCF.System.Notification(WCF.Language.get("wcf.global.success"),"success")},_closeAll:function(){for(var a in this._elements){this._hide(a)}},_setOptions:function(){this._options=[]},registerCallback:function(a){if($.isFunction(a)){this._callbacks.push(a)}},_getTriggerElement:function(a){return null},_show:function(b){var g=$(b.currentTarget).data("elementID");var h=null;if(!this._dropdowns[g]){h=this._getTriggerElement(this._elements[g]).addClass("dropdownToggle").wrap('<span class="dropdown" />');this._dropdowns[g]=$('<ul class="dropdownMenu" />').insertAfter(h)}this._dropdowns[g].empty();var c=false;var d="";for(var k=0,i=this._options.length;k<i;k++){var a=this._options[k];if(a.optionName==="divider"){if(d!==""&&d!=="divider"){$('<li class="dropdownDivider" />').appendTo(this._dropdowns[g]);d=a.optionName}}else{if(this._validate(g,a.optionName)||this._validateCallbacks(g,a.optionName)){var f=$("<li><span>"+a.label+"</span></li>").appendTo(this._dropdowns[g]);f.data("elementID",g).data("optionName",a.optionName).data("isQuickOption",(a.isQuickOption?true:false)).click($.proxy(this._click,this));c=true;d=a.optionName}}}if(c){var l=this._dropdowns[g].children().last();if(l.hasClass("dropdownDivider")){l.remove()}var j=null;var e=0;this._dropdowns[g].children().each(function(m,o){var n=$(o);if(!n.hasClass("dropdownDivider")){if(n.data("isQuickOption")){j=n}else{e++}}});if(!e){j.trigger("click");if(h===null){WCF.Dropdown.close(h.parents(".dropdown").wcfIdentify())}return false}}if(h!==null){WCF.Dropdown.initDropdown(h,true)}return false},_validate:function(a,b){return false},_validateCallbacks:function(a,b){var c=this._callbacks.length;if(c){for(var d=0;d<c;d++){if(this._callbacks[d].validate(this._elements[a],b)){return true}}}return false},_success:function(b,d,a){var c=this._updateData.length;if(!c){return}this._updateState(b);this._updateData=[]},_updateState:function(a){},_click:function(c){var b=$(c.currentTarget);var d=b.data("elementID");var a=b.data("optionName");if(!this._execute(d,a)){this._executeCallback(d,a)}this._hide(d)},_execute:function(a,b){return false},_executeCallback:function(a,b){var c=this._callbacks.length;if(c){for(var d=0;d<c;d++){if(this._callbacks[d].execute(this._elements[a],b)){return true}}}return false},_hide:function(a){if(this._dropdowns[a]){this._dropdowns[a].empty().removeClass("dropdownOpen")}}});WCF.Upload=Class.extend({_name:"__files[]",_buttonSelector:null,_fileListSelector:null,_fileUpload:null,_className:"",_iframe:null,_options:{},_uploadMatrix:[],_supportsAJAXUpload:true,_overlay:null,init:function(c,e,d,b){this._buttonSelector=c;this._fileListSelector=e;this._className=d;this._options=$.extend(true,{action:"upload",multiple:false,url:"index.php/AJAXUpload/?t="+SECURITY_TOKEN+SID_ARG_2ND},b||{});var a=new XMLHttpRequest();this._supportsAJAXUpload=(a&&("upload" in a)&&("onprogress" in a.upload));this._createButton()},_createButton:function(){if(this._supportsAJAXUpload){this._fileUpload=$('<input type="file" name="'+this._name+'" '+(this._options.multiple?'multiple="true" ':"")+"/>");this._fileUpload.change($.proxy(this._upload,this));var a=$('<p class="button uploadButton"><span>'+WCF.Language.get("wcf.global.button.upload")+"</span></p>");a.prepend(this._fileUpload)}else{var a=$('<p class="button uploadFallbackButton"><span>'+WCF.Language.get("wcf.global.button.upload")+"</span></p>");a.click($.proxy(this._showOverlay,this))}this._insertButton(a)},_insertButton:function(a){this._buttonSelector.append(a)},_removeButton:function(){var a=".uploadButton";if(!this._supportsAJAXUpload){a=".uploadFallbackButton"}this._buttonSelector.find(a).remove()},_upload:function(){var a=this._fileUpload.prop("files");if(a.length){var j=new FormData();var g=this._createUploadMatrix(a);if(!this._uploadMatrix[g].length){return}var f=[];for(var e=0,d=this._uploadMatrix[g].length;e<d;e++){var c=this._uploadMatrix[g][e];if(!c.hasClass("uploadFailed")){f.push(c.data("filename"))}}for(var e=0,d=a.length;e<d;e++){if(f.indexOf(a[e].name)!==-1){j.append("__files[]",a[e])}}j.append("actionName",this._options.action);j.append("className",this._className);var b=this._getParameters();for(var i in b){j.append("parameters["+i+"]",b[i])}var h=this;$.ajax({type:"POST",url:this._options.url,enctype:"multipart/form-data",data:j,contentType:false,processData:false,success:function(l,m,k){h._success(g,l)},error:$.proxy(this._error,this),xhr:function(){var k=$.ajaxSettings.xhr();if(k){k.upload.addEventListener("progress",function(l){h._progress(g,l)},false)}return k}})}},_createUploadMatrix:function(b){if(b.length){var c=this._uploadMatrix.length;this._uploadMatrix[c]=[];for(var f=0,d=b.length;f<d;f++){var a=b[f];var e=this._initFile(a);if(!e.hasClass("uploadFailed")){e.data("filename",a.name);this._uploadMatrix[c].push(e)}}return c}return null},_success:function(b,a){},_error:function(a,c,b){},_progress:function(c,a){var b=Math.round(a.loaded*100/a.total);for(var d=0;d<this._uploadMatrix[c].length;d++){this._uploadMatrix[c][d].find("progress").attr("value",b)}},_getParameters:function(){return{}},_initFile:function(a){return $("<li>"+a.name+" ("+a.size+')<progress max="100" /></li>').appendTo(this._fileListSelector)},_showOverlay:function(){if(this._iframe===null){this._iframe=$('<iframe name="__fileUploadIFrame" />').hide().appendTo(document.body)}if(!this._overlay){this._overlay=$('<div><form enctype="multipart/form-data" method="post" action="'+this._options.url+'" target="__fileUploadIFrame" /></div>').hide().appendTo(document.body);var a=this._overlay.find("form");$('<dl class="wide"><dd><input type="file" id="__fileUpload" name="'+this._name+'" '+(this._options.multiple?'multiple="true" ':"")+"/></dd></dl>").appendTo(a);$('<div class="formSubmit"><input type="submit" value="Upload" accesskey="s" /></div></form>').appendTo(a);$('<input type="hidden" name="isFallback" value="1" />').appendTo(a);$('<input type="hidden" name="actionName" value="'+this._options.action+'" />').appendTo(a);$('<input type="hidden" name="className" value="'+this._className+'" />').appendTo(a);var b=this._getParameters();for(var c in b){$('<input type="hidden" name="'+c+'" value="'+b[c]+'" />').appendTo(a)}a.submit($.proxy(function(){var d={name:this._getFilename(),size:""};var f=this._createUploadMatrix([d]);var e=this;this._iframe.data("loading",true).off("load").load(function(){e._evaluateResponse(f)});this._overlay.wcfDialog("close")},this))}this._overlay.wcfDialog({title:WCF.Language.get("wcf.global.button.upload")})},_evaluateResponse:function(b){var a=$.parseJSON(this._iframe.contents().find("pre").html());this._success(b,a)},_getFilename:function(){return $("#__fileUpload").val().split("\\").pop()}});WCF.Sortable={};WCF.Sortable.List=Class.extend({_additionalParameters:{},_className:"",_containerID:"",_container:null,_notification:null,_offset:0,_options:{},_proxy:null,_structure:{},init:function(a,f,g,d,e,c){this._additionalParameters=c||{};this._containerID=$.wcfEscapeID(a);this._container=$("#"+this._containerID);this._className=f;this._offset=(g)?g:0;this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._structure={};this._options=$.extend(true,{axis:"y",connectWith:"#"+this._containerID+" .sortableList",disableNesting:"sortableNoNesting",doNotClear:true,errorClass:"sortableInvalidTarget",forcePlaceholderSize:true,helper:"clone",items:"li:not(.sortableNoSorting)",opacity:0.6,placeholder:"sortablePlaceholder",tolerance:"pointer",toleranceElement:"> span"},d||{});if(e){$("#"+this._containerID+" .sortableList").sortable(this._options)}else{$("#"+this._containerID+" > .sortableList").nestedSortable(this._options)}if(this._className){var b=this._container.find(".formSubmit");if(!b.length){b=this._container.next(".formSubmit");if(!b.length){console.debug("[WCF.Sortable.Simple] Unable to find form submit for saving, aborting.");return}}b.children('button[data-type="submit"]').click($.proxy(this._submit,this))}},_submit:function(){this._structure={};this._container.find(".sortableList").each($.proxy(function(c,e){var b=$(e);var d=b.data("objectID");if(d!==undefined){b.children(this._options.items).each($.proxy(function(f,h){var g=$(h).data("objectID");if(!this._structure[d]){this._structure[d]=[]}this._structure[d].push(g)},this))}},this));var a=$.extend(true,{data:{offset:this._offset,structure:this._structure}},this._additionalParameters);this._proxy.setOption("data",{actionName:"updatePosition",className:this._className,interfaceName:"wcf\\data\\ISortableAction",parameters:a});this._proxy.sendRequest()},_success:function(b,c,a){if(this._notification===null){this._notification=new WCF.System.Notification(WCF.Language.get("wcf.global.success.edit"))}this._notification.show()}});WCF.Popover=Class.extend({_activeElementID:"",_cancelPopover:false,_data:{},_defaultDimensions:{height:150,width:450},_defaultOrientation:{x:"right",y:"top"},_delay:{show:800,hide:500},_hoverElement:false,_hoverElementID:"",_hoverPopover:false,_margin:20,_peOut:null,_peOverElement:null,_popover:null,_popoverContent:null,_popoverOffset:10,_selector:"",init:function(a){if($.browser.mobile){return}this._activeElementID="";this._cancelPopover=false;this._data={};this._defaultDimensions={height:150,width:450};this._defaultOrientation={x:"right",y:"top"};this._delay={show:800,hide:500};this._hoverElement=false;this._hoverElementID="";this._hoverPopover=false;this._margin=20;this._peOut=null;this._peOverElement=null;this._popoverOffset=10;this._selector=a;this._popover=$('<div class="popover"><span class="icon icon48 icon-spinner"></span><div class="popoverContent"></div></div>').hide().appendTo(document.body);this._popoverContent=this._popover.children(".popoverContent:eq(0)");this._popover.hover($.proxy(this._overPopover,this),$.proxy(this._out,this));this._initContainers();WCF.DOMNodeInsertedHandler.addCallback("WCF.Popover."+a,$.proxy(this._initContainers,this))},_initContainers:function(){if($.browser.mobile){return}var a=$(this._selector);if(!a.length){return}a.each($.proxy(function(c,d){var b=$(d);var e=b.wcfIdentify();if(!this._data[e]){this._data[e]={content:null,isLoading:false};b.hover($.proxy(this._overElement,this),$.proxy(this._out,this));if(b.is("a")&&b.attr("href")){b.click($.proxy(this._cancel,this))}}},this))},_cancel:function(a){this._cancelPopover=true;this._hide(true)},_overElement:function(a){if(this._cancelPopover){return}if(this._peOverElement!==null){this._peOverElement.stop()}var b=$(a.currentTarget).wcfIdentify();this._hoverElementID=b;this._peOverElement=new WCF.PeriodicalExecuter($.proxy(function(c){c.stop();if(this._hoverElementID===b){this._activeElementID=b;this._prepare()}},this),this._delay.show);this._hoverElement=true;this._hoverPopover=false},_prepare:function(){if(this._cancelPopover){return}if(this._peOut!==null){this._peOut.stop()}if(this._popover.is(":visible")){this._hide(true)}if(!this._data[this._activeElementID].loading&&this._data[this._activeElementID].content){this._popoverContent.html(this._data[this._activeElementID].content);WCF.DOMNodeInsertedHandler.execute()}else{this._data[this._activeElementID].loading=true}var a=this._popover.show().getDimensions();if(this._data[this._activeElementID].loading){a={height:Math.max(a.height,this._defaultDimensions.height),width:Math.max(a.width,this._defaultDimensions.width)}}else{a=this._fixElementDimensions(this._popover,a)}this._popover.hide();var b=this._getOrientation(a.height,a.width);this._popover.css(this._getCSS(b.x,b.y));this._popover.removeClass("bottom left right top").addClass(b.x).addClass(b.y);this._show()},_show:function(){if(this._cancelPopover){return}this._popover.stop().show().css({opacity:1}).wcfFadeIn();if(this._data[this._activeElementID].loading){this._popover.children("span").show();this._loadContent()}else{this._popover.children("span").hide();this._popoverContent.css({opacity:1})}},_loadContent:function(){},_insertContent:function(a,e,c){this._data[a]={content:e,loading:false};if(this._activeElementID===a){if(c){var d=this._popoverContent.getDimensions();this._popoverContent.css({height:"auto",width:"auto"});this._popoverContent.html(this._data[a].content);var f=this._popoverContent.getDimensions();this._popoverContent.html("").css({height:d.height+"px",width:d.width+"px"});var b=this;this._popoverContent.animate({height:f.height+"px",width:f.width+"px"},300,function(){b._popover.children("span").hide();b._popoverContent.html(b._data[a].content).css({opacity:0}).animate({opacity:1},200);WCF.DOMNodeInsertedHandler.execute()})}else{this._popover.children("span").hide();this._popoverContent.html(this._data[a].content);WCF.DOMNodeInsertedHandler.execute()}}},_hide:function(b){var a=this;this._popoverContent.stop();this._popover.stop();if(b){a._popover.css({opacity:0}).hide();a._popoverContent.empty().css({height:"auto",opacity:0,width:"auto"})}else{this._popover.wcfFadeOut(function(){a._popoverContent.empty().css({height:"auto",opacity:0,width:"auto"});a._popover.hide()})}},_overPopover:function(){if(this._peOut!==null){this._peOut.stop()}this._hoverElement=false;this._hoverPopover=true},_out:function(a){if(this._cancelPopover){return}this._hoverElementID="";this._hoverElement=false;this._hoverPopover=false;this._peOut=new WCF.PeriodicalExecuter($.proxy(function(b){b.stop();if(!this._hoverElement&&!this._hoverPopover){this._hide(false)}},this),this._delay.hide)},_getOrientation:function(i,a){var h=$("#"+this._activeElementID);var g=h.getOffsets("offset");var f=h.getDimensions();var b=$(document).getDimensions();var e=(this._defaultOrientation.x==="left")?"left":"right";var d=(this._defaultOrientation.y==="bottom")?"bottom":"top";var c=this._evaluateOrientation(e,d,g,f,b,i,a);if(c.flawed){e=(e==="left")?"right":"left";c=this._evaluateOrientation(e,d,g,f,b,i,a);if(c.flawed){e=(e==="right")?"left":"right";d=(d==="bottom")?"top":"bottom";c=this._evaluateOrientation(e,d,g,f,b,i,a);if(c.flawed){e=(e==="left")?"right":"left";c=this._evaluateOrientation(e,d,g,f,b,i,a);if(c.flawed){e=(this._defaultOrientationX==="left")?"left":"right";d=(this._defaultOrientationY==="bottom")?"bottom":"top"}}}}return{x:e,y:d}},_evaluateOrientation:function(g,f,b,h,j,i,a){var d=0,e=0;switch(g){case"left":e=b.left-a;break;case"right":e=j.width-(b.left+a);break}switch(f){case"bottom":d=j.height-(b.top+h.height+this._popoverOffset+i);break;case"top":d=b.top-(i-this._popoverOffset);break}var c=false;if(d<this._margin||e<this._margin){c=true}return{flawed:c,x:e,y:d}},_getCSS:function(d,c){var g={bottom:"auto",left:"auto",right:"auto",top:"auto"};var b=$("#"+this._activeElementID);var e=b.getOffsets("offset");var f=this._fixElementDimensions(b,b.getDimensions());var a=$(window).getDimensions();switch(d){case"left":g.right=a.width-(e.left+f.width);break;case"right":g.left=e.left;break}switch(c){case"bottom":g.top=e.top+(f.height+this._popoverOffset);break;case"top":g.bottom=a.height-(e.top-this._popoverOffset);break}return g},_fixElementDimensions:function(a,b){var c=a.parent().getDimensions();if(c.height<b.height){b.height=c.height}if(c.width<b.width){b.width=c.width}return b}});WCF.EditableItemList=Class.extend({_allowCustomInput:false,_className:"",_data:{},_form:null,_itemList:null,_objectID:0,_objectTypeID:0,_search:null,_searchInput:null,init:function(c,a){this._itemList=$(c);this._searchInput=$(a);this._data={};if(!this._itemList.length||!this._searchInput.length){console.debug("[WCF.EditableItemList] Item list and/or search input do not exist, aborting.");return}this._objectID=this._getObjectID();this._objectTypeID=this._getObjectTypeID();this._itemList.find(".jsEditableItem").click($.proxy(this._click,this));if(!this._itemList.children("ul").length){$("<ul />").appendTo(this._itemList)}this._itemList=this._itemList.children("ul");this._form=this._itemList.parents("form").submit($.proxy(this._submit,this));if(this._allowCustomInput){var b=this;this._searchInput.keydown($.proxy(this._keyDown,this)).on("paste",function(){setTimeout(function(){b._onPaste()},100)})}this._searchInput.parents(".dropdown").data("preventSubmit",true)},_keyDown:function(b){if(b===null||b.which===188||b.which===$.ui.keyCode.ENTER){if(b!==null&&b.which===$.ui.keyCode.ENTER&&this._search){if(this._search._itemIndex!==-1){return false}}var a=$.trim(this._searchInput.val());if(b&&b.which===188){a=a.substring(0,this._searchInput.getCaret())}if(a===""){return true}this.addItem({objectID:0,label:a});if(b&&b.which===188){this._searchInput.val($.trim(this._searchInput.val().substr(this._searchInput.getCaret())))}else{this._searchInput.val("")}if(b!==null){b.stopPropagation()}return false}return true},_onPaste:function(){var b=$.trim(this._searchInput.val());b=b.split(",");for(var d=0,c=b.length;d<c;d++){var a=$.trim(b[d]);if(a===""){continue}this.addItem({objectID:0,label:a})}this._searchInput.val("")},load:function(a){},_click:function(d){var b=$(d.currentTarget);var c=b.data("objectID");var a=b.data("label");if(this._search){this._search.removeExcludedSearchValue(a)}this._removeItem(c,a);b.remove();d.stopPropagation();return false},_getObjectID:function(){return 0},_getObjectTypeID:function(){return 0},addItem:function(b){if(this._data[b.objectID]){if(!(b.objectID===0&&this._allowCustomInput)){return true}}var a=$('<li class="badge">'+WCF.String.escapeHTML(b.label)+"</li>").data("objectID",b.objectID).data("label",b.label).appendTo(this._itemList);a.click($.proxy(this._click,this));if(this._search){this._search.addExcludedSearchValue(b.label)}this._addItem(b.objectID,b.label);return true},_submit:function(){this._keyDown(null)},_addItem:function(b,a){this._data[b]=a},_removeItem:function(b,a){delete this._data[b]}});WCF.Sitemap=Class.extend({_cache:[],_dialog:null,_didInit:false,_proxy:null,init:function(){$("#sitemap").click($.proxy(this._click,this));this._cache=[];this._dialog=null;this._didInit=false;this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)})},_click:function(){if(this._dialog===null){this._dialog=$('<div id="sitemapDialog" />').appendTo(document.body);this._proxy.setOption("data",{actionName:"getSitemap",className:"wcf\\data\\sitemap\\SitemapAction"});this._proxy.sendRequest()}else{this._dialog.wcfDialog("open")}},_success:function(b,c,a){if(this._didInit){this._cache.push(b.returnValues.sitemapName);this._dialog.find("#sitemap_"+b.returnValues.sitemapName).html(b.returnValues.template);this._dialog.wcfDialog("render")}else{this._cache.push(b.returnValues.sitemapName);this._dialog.html(b.returnValues.template);this._dialog.find(".sitemapNavigation").click($.proxy(this._navigate,this));this._dialog.find(".tabMenuContainer").wcfTabs("select","sitemap_"+b.returnValues.sitemapName);this._dialog.wcfDialog({title:WCF.Language.get("wcf.page.sitemap")});this._didInit=true}},_navigate:function(a){var b=$(a.currentTarget).data("sitemapName");if(WCF.inArray(b,this._cache)){this._dialog.find(".tabMenuContainer").wcfTabs("select","sitemap_"+b);this._dialog.wcfDialog("render")}else{this._proxy.setOption("data",{actionName:"getSitemap",className:"wcf\\data\\sitemap\\SitemapAction",parameters:{sitemapName:b}});this._proxy.sendRequest()}}});WCF.Language.Chooser=Class.extend({_callback:null,_dropdown:null,_input:null,init:function(l,g,f,b,k,e){var m=$("#"+l);if(m.length!=1){console.debug("[WCF.Language.Chooser] Invalid container id '"+l+"' given");return}this._input=$("#"+g);if(!this._input.length){this._input=$('<input type="hidden" name="'+g+'" value="'+f+'" />').appendTo(m)}if(k!==undefined){if(!$.isFunction(k)){console.debug("[WCF.Language.Chooser] Given callback is invalid");return}this._callback=k}this._dropdown=$('<div class="dropdown" id="'+l+'-languageChooser" />').appendTo(m);$('<div class="dropdownToggle boxFlag box24" data-toggle="'+l+'-languageChooser"></div>').appendTo(this._dropdown);var c=$('<ul class="dropdownMenu" />').appendTo(this._dropdown);for(var a in b){var i=b[a];var h=$('<li class="boxFlag"><a class="box24"><div class="framed"><img src="'+i.iconPath+'" alt="" class="iconFlag" /></div> <div><h3>'+i.languageName+"</h3></div></a></li>").appendTo(c);h.data("languageID",a).click($.proxy(this._click,this));if(a==f){var d=$(""+h.html());var j=d.children().detach();this._dropdown.children(".dropdownToggle").empty().append(j)}}if(e){$('<li class="dropdownDivider" />').appendTo(c);var h=$("<li><a>"+WCF.Language.get("wcf.global.language.noSelection")+"</a></li>").data("languageID",0).click($.proxy(this._click,this)).appendTo(c);if(f===0){this._dropdown.children(".dropdownToggle").empty().append(h.html())}}WCF.Dropdown.init()},_click:function(e){var d=$(e.currentTarget);var c=d.data("languageID");this._input.val(c);var b=$(""+d.html());var a=(c===0)?b:b.children().detach();this._dropdown.children(".dropdownToggle").empty().append(a);if(this._callback!==null){this._callback(d)}}});WCF.Style={};WCF.Style.Chooser=Class.extend({_dialog:null,_proxy:null,init:function(){$('<li class="styleChooser"><a>'+WCF.Language.get("wcf.style.changeStyle")+"</a></li>").appendTo($("#footerNavigation > ul.navigationItems")).click($.proxy(this._showDialog,this));this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)})},_showDialog:function(){if(this._dialog===null){this._dialog=$('<div id="styleChooser" />').hide().appendTo(document.body);this._loadDialog()}else{this._dialog.wcfDialog({title:WCF.Language.get("wcf.style.changeStyle")})}},_loadDialog:function(){this._proxy.setOption("data",{actionName:"getStyleChooser",className:"wcf\\data\\style\\StyleAction"});this._proxy.sendRequest()},_success:function(b,c,a){if(b.actionName==="changeStyle"){window.location.reload();return}this._dialog.html(b.returnValues.template);this._dialog.find("li").addClass("pointer").click($.proxy(this._click,this));this._showDialog()},_click:function(a){this._proxy.setOption("data",{actionName:"changeStyle",className:"wcf\\data\\style\\StyleAction",objectIDs:[$(a.currentTarget).data("styleID")]});this._proxy.sendRequest()}});WCF.UserPanel=Class.extend({_container:null,_didLoad:false,_link:null,_noItems:"",_revertOnEmpty:true,init:function(a){this._container=$("#"+a);this._didLoad=false;this._revertOnEmpty=true;if(this._container.length!=1){console.debug("[WCF.UserPanel] Unable to find container identfied by '"+a+"', aborting.");return}this._convert()},_convert:function(){this._container.addClass("dropdown");this._link=this._container.children("a").remove();var b=$('<a class="dropdownToggle">'+this._link.html()+"</a>").appendTo(this._container).click($.proxy(this._click,this));var a=$('<ul class="dropdownMenu" />').appendTo(this._container);$('<li class="jsDropdownPlaceholder"><span>'+WCF.Language.get("wcf.global.loading")+"</span></li>").appendTo(a);this._addDefaultItems(a);this._container.dblclick($.proxy(function(){window.location=this._link.attr("href");return false},this));WCF.Dropdown.initDropdown(b,false)},_addDefaultItems:function(a){},_addDivider:function(a){$('<li class="dropdownDivider" />').appendTo(a)},_click:function(){if(this._didLoad){return}new WCF.Action.Proxy({autoSend:true,data:this._getParameters(),success:$.proxy(this._success,this)});this._didLoad=true},_getParameters:function(){return{}},_success:function(c,e,b){var a=WCF.Dropdown.getDropdownMenu(this._container.wcfIdentify());a.children(".jsDropdownPlaceholder").remove();if(c.returnValues&&c.returnValues.template){$(""+c.returnValues.template).prependTo(a);var d=this._container.find(".badge");if(!d.length){d=$('<span class="badge badgeInverse" />').appendTo(this._container.children(".dropdownToggle"));d.before(" ")}d.html(c.returnValues.totalCount);this._after(a)}else{$("<li><span>"+WCF.Language.get(this._noItems)+"</span></li>").prependTo(a);this._container.find(".badge").remove()}},_after:function(a){}});$.widget("ui.wcfDialog",{_closeButton:null,_container:null,_content:null,_overlay:null,_title:null,_titlebar:null,_isOpen:false,options:{autoOpen:true,closable:true,closeButtonLabel:null,hideTitle:false,modal:true,title:"",zIndex:400,onClose:null,onShow:null},_createWidget:function(a,b){if($(b).getTagName()==="script"){console.debug("[ui.wcfDialog] Ignored script tag");this.element=false;return null}$.Widget.prototype._createWidget.apply(this,arguments)},_init:function(){if(this.options.autoOpen){this.open()}$(window).resize($.proxy(this._resize,this))},_create:function(){if(this.options.closeButtonLabel===null){this.options.closeButtonLabel=WCF.Language.get("wcf.global.button.close")}this._container=$('<div class="dialogContainer" />').hide().css({zIndex:this.options.zIndex}).appendTo(document.body);this._titlebar=$('<header class="dialogTitlebar" />').hide().appendTo(this._container);this._title=$('<span class="dialogTitle" />').hide().appendTo(this._titlebar);this._closeButton=$('<a class="dialogCloseButton jsTooltip" title="'+this.options.closeButtonLabel+'"><span /></a>').click($.proxy(this.close,this)).hide().appendTo(this._titlebar);this._content=$('<div class="dialogContent" />').appendTo(this._container);this._setOption("title",this.options.title);this._setOption("closable",this.options.closable);var a=this.element.detach();this._content.html(a);if(this.options.modal){this._overlay=$("#jsWcfDialogOverlay");if(!this._overlay.length){this._overlay=$('<div id="jsWcfDialogOverlay" class="dialogOverlay" />').css({height:"100%",zIndex:399}).hide().appendTo(document.body)}if(this.options.closable){this._overlay.click($.proxy(this.close,this));$(document).keyup($.proxy(function(b){if(b.keyCode&&b.keyCode===$.ui.keyCode.ESCAPE){this.close();b.preventDefault()}},this))}}WCF.DOMNodeInsertedHandler.execute()},_setOption:function(a,b){this.options[a]=b;if(a=="hideTitle"||a=="title"){if(!this.options.hideTitle&&this.options.title!=""){this._title.html(this.options.title).show()}else{this._title.html("")}}else{if(a=="closable"||a=="closeButtonLabel"){if(this.options.closable){this._closeButton.attr("title",this.options.closeButtonLabel).show().find("span").html(this.options.closeButtonLabel);WCF.DOMNodeInsertedHandler.execute()}else{this._closeButton.hide()}}}if((!this.options.hideTitle&&this.options.title!="")||this.options.closable){this._titlebar.show()}else{this._titlebar.hide()}return this},open:function(){if(this.element===false){return}if(this.isOpen()){return}if(this._overlay!==null){WCF.activeDialogs++;if(WCF.activeDialogs===1){this._overlay.show()}}this.render();this._isOpen=true},isOpen:function(){return this._isOpen},close:function(a){if(!this.isOpen()){return}this._isOpen=false;this._container.wcfFadeOut();if(this._overlay!==null){WCF.activeDialogs--;if(WCF.activeDialogs===0){this._overlay.hide()}}if(this.options.onClose!==null){this.options.onClose()}if(a!==undefined){a.preventDefault()}},_resize:function(){if(this.isOpen()){this.render()}},render:function(){if(!this._container.is(":visible")&&this._container.css("top")==="0px"){window.scrollTo(0,0)}this._container.show();this._content.children().show();this._content.css({height:"auto",width:"auto"});this._container.stop();this._content.stop();this._container.show().css("opacity",1);var e=0;if(this._content.find(".formSubmit").length){e=this._content.find(".formSubmit").outerHeight();this._content.addClass("dialogForm").css({marginBottom:e+"px"})}else{this._content.removeClass("dialogForm").css({marginBottom:"0px"})}var b=$(window).getDimensions();if(b.width*0.9>800){this._container.css("maxWidth","800px")}var h=this._container.getDimensions("outer");var d=this._content.getDimensions();var e=h.height-d.height;var g=b.height-e-120;this._content.css({maxHeight:g+"px"});this._determineOverflow();h=this._container.getDimensions("outer");var f=Math.round((b.width-h.width)/2);var a=Math.round((b.height-h.height)/2);var c=Math.round((b.height/100)*20);if(c<a){a=c}this._container.css({left:f+"px",top:a+"px"});this._content.css({height:"auto",width:"auto"});if(!this.isOpen()){this._container.hide();this._container.wcfFadeIn($.proxy(function(){if(this.options.onShow!==null){this.options.onShow()}},this))}},_determineOverflow:function(){var b=$(window).getDimensions();var c=this._content.css("maxHeight");this._content.css("maxHeight","none");var e=this._container.getDimensions("outer");var d="visible";if((b.height*0.8<e.height)||(b.width*0.8<e.width)){d="auto"}this._content.css("overflow",d);this._content.css("maxHeight",c);if(d==="visible"){var a=0;this._content.children().each(function(f,g){a+=$(g).outerHeight()});if(this._content.height()<a){this._content.css("overflow","auto")}}},_getContentDimensions:function(a){var b=this._content.getDimensions();if(a&&b.height>a){b.height=a}return b}});$.widget("ui.wcfSlideshow",{_buttonList:null,_count:0,_index:0,_itemList:null,_items:null,_timer:null,_width:0,options:{cycle:true,cycleInterval:5,itemGap:50,},_create:function(){this._itemList=this.element.children("ul");this._items=this._itemList.children("li");this._count=this._items.length;this._index=0;this._initSlideshow()},_initSlideshow:function(){var b=$(this._items.get(0)).outerHeight();this._items.addClass("slideshowItem");this._width=this.element.css("height",b).innerWidth();this._itemList.addClass("slideshowItemList").css("left",0);this._items.each($.proxy(function(d,e){$(e).show().css({height:b,left:((this._width+this.options.itemGap)*d),width:this._width})},this));this.element.css({height:b,width:this._width}).hover($.proxy(this._hoverIn,this),$.proxy(this._hoverOut,this));this._buttonList=$('<ul class="slideshowButtonList" />').appendTo(this.element);for(var c=0;c<this._count;c++){var a=$('<li><a><span class="icon icon16 icon-circle" /></a></li>').data("index",c).click($.proxy(this._click,this)).appendTo(this._buttonList);if(c==0){a.find(".icon").addClass("active")}}this._resetTimer();$(window).resize($.proxy(this._resize,this))},_resize:function(){this._width=this.element.css("width","auto").innerWidth();this._items.each($.proxy(function(a,b){$(b).css({left:((this._width+this.options.itemGap)*a),width:this._width})},this));this._index--;this.moveTo(null)},_hoverIn:function(){if(this._timer!==null){this._timer.stop()}},_hoverOut:function(){this._resetTimer()},_resetTimer:function(){if(!this.options.cycle){return}if(this._timer!==null){this._timer.stop()}var a=this;this._timer=new WCF.PeriodicalExecuter(function(){a.moveTo(null)},this.options.cycleInterval*1000)},_click:function(a){this.moveTo($(a.currentTarget).data("index"));this._resetTimer()},moveTo:function(a){this._index=(a===null)?this._index+1:a;if(this._index==this._count){this._index=0}$(this._buttonList.find(".icon").removeClass("active").get(this._index)).addClass("active");this._itemList.css("left",this._index*(this._width+this.options.itemGap)*-1)}});$.widget("ui.wcfTabs",$.ui.tabs,{_sanitizeSelector:function(a){return a.replace(/([:\.])/g,"\\$1")},select:function(a){if(!$.isNumeric(a)){this.panels.each(function(c,b){if($(b).wcfIdentify()===a){a=c;return false}});if(!$.isNumeric(a)){console.debug("[ui.wcfTabs] Unable to find panel identified by '"+a+"', aborting.");return}}this._setOption("active",a)},selectTab:function(a){a="#"+a;this.anchors.each(function(c,b){var d=$(b);if(d.prop("hash")===a){d.trigger("click");return false}})},getCurrentIndex:function(){return this.lis.index(this.lis.filter(".ui-tabs-selected"))},hasAnchor:function(b,a){var c=false;this.anchors.each(function(e,d){var g=$(d).attr("href");if(/#.+/.test(g)){var f=g.split("#",2);if(a){f=f[1].split("-",2)}if(f[1]===b){c=true;return false}}});return c},revertToDefault:function(){var a=this.element.data("active");if(!a||a===""){a=0}this.select(a)},_processTabs:function(){var a=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(f,e){var b,c,d=$(e).uniqueId().attr("id"),g=$(e).closest("li"),h=g.attr("aria-controls");b=e.hash;c=a.element.find(a._sanitizeSelector(b));if(c.length){a.panels=a.panels.add(c)}if(h){g.data("ui-tabs-aria-controls",h)}g.attr({"aria-controls":b.substring(1),"aria-labelledby":d});c.attr("aria-labelledby",d)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},load:function(a,b){return}});$.widget("ui.wcfPages",{SHOW_LINKS:11,SHOW_SUB_LINKS:20,options:{activePage:1,maxPage:1,nextPage:null,previousPage:null},_create:function(){if(this.options.nextPage===null){this.options.nextPage=WCF.Language.get("wcf.global.page.next")}if(this.options.previousPage===null){this.options.previousPage=WCF.Language.get("wcf.global.page.previous")}this.element.addClass("pageNavigation");this._render()},destroy:function(){$.Widget.prototype.destroy.apply(this,arguments);this.element.children().remove()},_render:function(){if(!this.options.disabled&&this.options.maxPage>1){var g=false;if(this.element.hasClass("hidden")){this.element.removeClass("hidden")}this.element.show();this.element.children().remove();var o=$("<ul />");this.element.append(o);var n=$('<li class="button skip" />');o.append(n);if(this.options.activePage>1){var d=$("<a"+((this.options.previousPage!=null)?(' title="'+this.options.previousPage+'"'):(""))+"></a>");n.append(d);this._bindSwitchPage(d,this.options.activePage-1);var l=$('<span class="icon icon16 icon-double-angle-left" />');d.append(l)}else{var l=$('<span class="icon icon16 icon-double-angle-left" />');n.append(l);n.addClass("disabled");l.addClass("disabled")}o.append(this._renderLink(1));var a=this.SHOW_LINKS-4;var e=this.options.activePage-2;if(e<0){e=0}var i=this.options.maxPage-(this.options.activePage+1);if(i<0){i=0}if(this.options.activePage>1&&this.options.activePage<this.options.maxPage){a--}var k=a/2;var c=this.options.activePage;var j=this.options.activePage;if(c<1){c=1}if(j<1){j=1}if(j>this.options.maxPage-1){j=this.options.maxPage-1}if(e>=k){c-=k}else{c-=e;j+=k-e}if(i>=k){j+=k}else{j+=i;c-=k-i}j=Math.ceil(j);c=Math.ceil(c);if(c<1){c=1}if(j>this.options.maxPage){j=this.options.maxPage}if(c>1){if(c-1<2){o.append(this._renderLink(2))}else{$('<li class="button jumpTo"><a title="'+WCF.Language.get("wcf.global.page.jumpTo")+'" class="jsTooltip">...</a></li>').appendTo(o);g=true}}for(var m=c+1;m<j;m++){o.append(this._renderLink(m))}if(j<this.options.maxPage){if(this.options.maxPage-j<2){o.append(this._renderLink(this.options.maxPage-1))}else{$('<li class="button jumpTo"><a title="'+WCF.Language.get("wcf.global.page.jumpTo")+'" class="jsTooltip">...</a></li>').appendTo(o);g=true}}o.append(this._renderLink(this.options.maxPage));var h=$('<li class="button skip" />');o.append(h);if(this.options.activePage<this.options.maxPage){var f=$("<a"+((this.options.nextPage!=null)?(' title="'+this.options.nextPage+'"'):(""))+"></a>");h.append(f);this._bindSwitchPage(f,this.options.activePage+1);var b=$('<span class="icon icon16 icon-double-angle-right" />');f.append(b)}else{var b=$('<span class="icon icon16 icon-double-angle-right" />');h.append(b);h.addClass("disabled");b.addClass("disabled")}if(g){o.data("pages",this.options.maxPage);WCF.System.PageNavigation.init("#"+o.wcfIdentify(),$.proxy(function(p){this.switchPage(p)},this))}}else{this.element.hide()}},_renderLink:function(d,a){var e=$('<li class="button"></li>');if(a!=undefined&&a){e.addClass("break")}if(d!=this.options.activePage){var b=$("<a>"+WCF.String.addThousandsSeparator(d)+"</a>");e.append(b);this._bindSwitchPage(b,d)}else{e.addClass("active");var c=$("<span>"+WCF.String.addThousandsSeparator(d)+"</span>");e.append(c)}return e},_bindSwitchPage:function(a,b){var c=this;a.click(function(){c.switchPage(b)})},switchPage:function(a){this._setOption("activePage",a)},_setOption:function(b,c){if(b=="activePage"){if(c!=this.options[b]&&c>0&&c<=this.options.maxPage){var a=this._trigger("shouldSwitch",undefined,{nextPage:c});if(a||a!==undefined){this.options[b]=c;this._render();this._trigger("switched",undefined,{activePage:c})}else{this._trigger("notSwitched",undefined,{activePage:c})}}}else{this.options[b]=c;if(b=="disabled"){if(c){this.element.children().remove()}else{this._render()}}else{if(b=="maxPage"){this._render()}}}return this},_startInput:function(b){var a=$(b.currentTarget);if(!a.is("a")){a=a.parent("a")}a.hide();var c=a.parent("li").children("input").css("display","block").val("");c.focus()},_stopInput:function(b){var c=$(b.currentTarget);c.css("display","none");var a=c.parent("li");if(a!=undefined&&a!=null){a.children("a").show()}},_handleInput:function(b){var a=($.browser.msie&&$.browser.version=="7.0");if(b.type!="keyup"||a){if(!a||((b.which==13||b.which==27)&&b.type=="keyup")){if(b.which==13){this.switchPage(parseInt($(b.currentTarget).val()))}if(b.which==13||b.which==27){this._stopInput(b);b.stopPropagation()}}}}});WCF.Category={};WCF.Category.NestedList=Class.extend({_categories:{},init:function(){var a=this;$(".jsCategory").each(function(c,d){var b=$(d).data("parentCategoryID",null).change($.proxy(a._updateSelection,a));a._categories[b.val()]=b;var e=[];b.parents("li").find(".jsChildCategory").each(function(h,g){var f=$(g).data("parentCategoryID",b.val()).change($.proxy(a._updateSelection,a));a._categories[f.val()]=f;e.push(f.val());if(f.is(":checked")){b.prop("checked","checked")}});b.data("childCategoryIDs",e)})},_updateSelection:function(b){var a=$(b.currentTarget);var f=a.data("parentCategoryID");if(a.is(":checked")){if(f!==null){this._categories[f].prop("checked","checked")}}else{if(f===null){var e=a.data("childCategoryIDs");for(var d=0,c=e.length;d<c;d++){this._categories[e[d]].prop("checked",false)}}}}});function wcfEval(expression){return eval(expression)};
>>>>>>> woltlab
